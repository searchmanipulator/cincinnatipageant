(function(){var D;var C;scheduler.config.collision_limit=1;function A(G){var I=scheduler._props?scheduler._props[scheduler._mode]:null;var F=scheduler.matrix?scheduler.matrix[scheduler._mode]:null;var H=I||F;if(I){var E=H.map_to}if(F){var E=H.y_property}if((H)&&G){D=scheduler.getEvent(G)[E]}}scheduler.attachEvent("onBeforeDrag",function(E){A(E);return true});scheduler.attachEvent("onBeforeLightbox",function(F){var E=scheduler.getEvent(F);C=[E.start_date,E.end_date];A(F);return true});scheduler.attachEvent("onEventChanged",function(F){if(!F){return true}var E=scheduler.getEvent(F);if(!B(E)){if(!C){return false}E.start_date=C[0];E.end_date=C[1];E._timed=this.is_one_day_event(E)}return true});scheduler.attachEvent("onBeforeEventChanged",function(E,F,G){return B(E)});scheduler.attachEvent("onEventSave",function(F,E){if(E.rec_type){scheduler._roll_back_dates(E);return B(E)}return B(E)});function B(O){var R=[];var I=scheduler.config.collision_limit;if(O.rec_type){var F=scheduler.getRecDates(O);for(var J=0;J<F.length;J++){var N=scheduler.getEvents(F[J].start_date,F[J].end_date);for(var K=0;K<N.length;K++){if((N[K].event_pid||N[K].id)!=O.id){R.push(N[K])}}}R.push(O)}else{R=scheduler.getEvents(O.start_date,O.end_date)}var E=scheduler._props?scheduler._props[scheduler._mode]:null;var P=scheduler.matrix?scheduler.matrix[scheduler._mode]:null;var H=E||P;if(E){var G=H.map_to}if(P){var G=H.y_property}var Q=true;if(H){var M=0;for(var L=0;L<R.length;L++){if(R[L][G]==O[G]&&R[L].id!=O.id){M++}}if(M>=I){O[G]=D;Q=false}}else{if(R.length>I){Q=false}}if(!Q){return !scheduler.callEvent("onEventCollision",[O,R])}return Q}})();