scheduler._props={};scheduler.createUnitsView=function(A,E,D,B,C,F){if(typeof A=="object"){D=A.list;E=A.property;B=A.size||0;C=A.step||1;F=A.skip_incorrect;A=A.name}scheduler._props[A]={map_to:E,options:D,step:C,position:0};if(B>scheduler._props[A].options.length){scheduler._props[A]._original_size=B;B=0}scheduler._props[A].size=B;scheduler._props[A].skip_incorrect=F||false;scheduler.date[A+"_start"]=scheduler.date.day_start;scheduler.templates[A+"_date"]=function(G){return scheduler.templates.day_date(G)};scheduler.templates[A+"_scale_date"]=function(H){var I=scheduler._props[A].options;if(!I.length){return""}var G=(scheduler._props[A].position||0)+Math.floor((scheduler._correct_shift(H.valueOf(),1)-scheduler._min_date.valueOf())/(60*60*24*1000));if(I[G].css){return"<span class='"+I[G].css+"'>"+I[G].label+"</span>"}else{return I[G].label}};scheduler.date["add_"+A]=function(G,H){return scheduler.date.add(G,H,"day")};scheduler.date["get_"+A+"_end"]=function(G){return scheduler.date.add(G,scheduler._props[A].size||scheduler._props[A].options.length,"day")};scheduler.attachEvent("onOptionsLoad",function(){var J=scheduler._props[A];var G=J.order={};var I=J.options;for(var H=0;H<I.length;H++){G[I[H].key]=H}if(J._original_size&&J.size==0){J.size=J._original_size;delete J.original_size}if(J.size>I.length){J._original_size=J.size;J.size=0}else{J.size=J._original_size||J.size}if(scheduler._date&&scheduler._mode==A){scheduler.setCurrentView(scheduler._date,scheduler._mode)}});scheduler.callEvent("onOptionsLoad",[])};scheduler.scrollUnit=function(A){var B=scheduler._props[this._mode];if(B){B.position=Math.min(Math.max(0,B.position+A),B.options.length-B.size);this.update_view()}};(function(){var I=function(M){var O=scheduler._props[scheduler._mode];if(O&&O.order&&O.skip_incorrect){var L=[];for(var N=0;N<M.length;N++){if(typeof O.order[M[N][O.map_to]]!="undefined"){L.push(M[N])}}M.splice(0,M.length);M.push.apply(M,L)}return M};var G=scheduler._pre_render_events_table;scheduler._pre_render_events_table=function(L,M){L=I(L);return G.apply(this,[L,M])};var H=scheduler._pre_render_events_line;scheduler._pre_render_events_line=function(L,M){L=I(L);return H.apply(this,[L,M])};var C=function(P,N){if(P&&typeof P.order[N[P.map_to]]=="undefined"){var M=scheduler;var L=24*60*60*1000;var O=Math.floor((N.end_date-M._min_date)/L);N[P.map_to]=P.options[Math.min(O+P.position,P.options.length-1)].key;return true}};var K=scheduler._reset_scale;var J=scheduler.is_visible_events;scheduler.is_visible_events=function(M){var L=J.apply(this,arguments);if(L){var O=scheduler._props[this._mode];if(O&&O.size){var N=O.order[M[O.map_to]];if(N<O.position||N>=O.size+O.position){return false}}}return L};scheduler._reset_scale=function(){var Q=scheduler._props[this._mode];var L=K.apply(this,arguments);if(Q){this._max_date=this.date.add(this._min_date,1,"day");var P=this._els.dhx_cal_data[0].childNodes;for(var M=0;M<P.length;M++){P[M].className=P[M].className.replace("_now","")}if(Q.size&&Q.size<Q.options.length){var N=this._els.dhx_cal_header[0];var O=document.createElement("DIV");if(Q.position){O.className="dhx_cal_prev_button";O.style.cssText="left:1px;top:2px;position:absolute;";O.innerHTML="&nbsp;";N.firstChild.appendChild(O);O.onclick=function(){scheduler.scrollUnit(Q.step*-1)}}if(Q.position+Q.size<Q.options.length){O=document.createElement("DIV");O.className="dhx_cal_next_button";O.style.cssText="left:auto; right:0px;top:2px;position:absolute;";O.innerHTML="&nbsp;";N.lastChild.appendChild(O);O.onclick=function(){scheduler.scrollUnit(Q.step)}}}}return L};var A=scheduler._get_event_sday;scheduler._get_event_sday=function(L){var M=scheduler._props[this._mode];if(M){C(M,L);return M.order[L[M.map_to]]-M.position}return A.call(this,L)};var F=scheduler.locate_holder_day;scheduler.locate_holder_day=function(M,L,N){var O=scheduler._props[this._mode];if(O&&N){C(O,N);return O.order[N[O.map_to]]*1+(L?1:0)-O.position}return F.apply(this,arguments)};var E=scheduler._append_mark_now;scheduler._append_mark_now=function(O,Q,M){if(this._props&&this._props[this._mode]){var N=new Date();var L=scheduler.date.add(this._min_date,1,"day");if(N<L&&N>this._min_date&&N.getHours()>=this.config.first_hour&&N.getHours()<this.config.last_hour){for(var P=0;P<Q.length-1;P++){Q[P].appendChild(M.cloneNode(true))}}}else{return E.apply(this,arguments)}};var B=scheduler._mouse_coords;scheduler._mouse_coords=function(){var P=scheduler._props[this._mode];var O=B.apply(this,arguments);if(P){if(!this._drag_event){this._drag_event={}}var M=this._drag_event;if(this._drag_id&&this._drag_mode){M=this.getEvent(this._drag_id);this._drag_event._dhx_changed=true}var N=Math.min(O.x+P.position,P.options.length-1);var L=P.map_to;O.section=M[L]=P.options[N].key;O.x=0}return O};var D=scheduler._time_order;scheduler._time_order=function(L){var M=scheduler._props[this._mode];if(M){L.sort(function(O,N){return M.order[O[M.map_to]]>M.order[N[M.map_to]]?1:-1})}else{D.apply(this,arguments)}};scheduler.attachEvent("onEventAdded",function(O,M){if(this._loading){return true}for(var L in scheduler._props){var N=scheduler._props[L];if(typeof M[N.map_to]=="undefined"){M[N.map_to]=N.options[0].key}}return true});scheduler.attachEvent("onEventCreated",function(O,L){var N=scheduler._props[this._mode];if(N){var M=this.getEvent(O);this._mouse_coords(L);C(N,M);this.event_updated(M)}return true})})();