scheduler.config.limit_start=new Date(-3999,0,0);scheduler.config.limit_end=new Date(3999,0,0);scheduler.config.limit_view=false;(function(){var E=null;var C={};var D={};var B=false;scheduler.blockTime=function(O,G,Q){var F=this.config.first_hour*60;var N=this.config.last_hour*60;if(G=="fullday"){G=[F,N]}var L=(typeof O=="object")?this.date.date_part(O).valueOf():O;if(Q){for(var P in Q){if(Q.hasOwnProperty(P)){D[P]=D[P]||{};if(!(Q[P] instanceof Array)){Q[P]=[Q[P]]}var M=Q[P];for(var H=0;H<M.length;H++){var K=M[H];var I=D[P];I[K]=I[K]||{};I[K][L]=G}}}}else{C[L]=G}for(var J=0;J<G.length;J+=2){if(G[J]<F){G[J]=F}if(G[J+1]>N){G[J+1]=N}}B=true};scheduler.attachEvent("onScaleAdd",function(G,R){var I=false;var O=this._mode;var J;if(this._props&&this._props[O]){var S=this._props[O];var Q=S.options;var P=(S.position||0)+Math.floor((this._correct_shift(R.valueOf(),1)-this._min_date.valueOf())/(60*60*24*1000));var T=Q[P];I="units";R=this._date;if(D[O]&&D[O][T.key]){var H=D[O][T.key];J=H[R.valueOf()]||H[R.getDay()]}}if(!J){J=(C[R.valueOf()]||C[R.getDay()])||[]}for(var N=0;N<J.length;N+=2){var F=J[N];var M=J[N+1];var L=document.createElement("DIV");L.className="dhx_time_block";var K;L.style.top=(Math.round((F*60*1000-this.config.first_hour*60*60*1000)*this.config.hour_size_px/(60*60*1000)))%(this.config.hour_size_px*24)+"px";L.style.height=(Math.round(((M-F-1)*60*1000)*this.config.hour_size_px/(60*60*1000)))%(this.config.hour_size_px*24)+"px";G.appendChild(L)}});scheduler.attachEvent("onBeforeViewChange",function(H,G,F,I){I=I||G;F=F||H;if(scheduler.config.limit_view){if(I.valueOf()>scheduler.config.limit_end.valueOf()||this.date.add(I,1,F)<=scheduler.config.limit_start.valueOf()){setTimeout(function(){scheduler.setCurrentView(scheduler._date,F)},1);return false}}return true});var A=function(O){var R=scheduler;if(!O){return true}var N=R.config;var L=(O.start_date.valueOf()>=N.limit_start.valueOf()&&O.end_date.valueOf()<=N.limit_end.valueOf());if(L&&B&&O._timed){var P=R.date.date_part(new Date(O.start_date.valueOf()));var H;if(R._props&&R._props[R._mode]){var Q=R._props[R._mode];if(D[R._mode]&&D[R._mode][O[Q.map_to]]){var G=D[R._mode][O[Q.map_to]];H=G[P.valueOf()]||G[P.getDay()]}}if(!H){var H=C[P.valueOf()]||C[P.getDay()]}var I=O.start_date.getHours()*60+O.start_date.getMinutes();var F=O.end_date.getHours()*60+O.end_date.getMinutes();if(H){for(var J=0;J<H.length;J+=2){var M=H[J];var K=H[J+1];if(M<F&&K>I){if(I<=K&&I>=M){if(K==24*60||F<K){L=false;break}if(R._drag_id&&R._drag_mode=="new-size"){O.start_date.setHours(0);O.start_date.setMinutes(K)}else{L=false;break}}if((F>=M&&F<K)||(I<M&&F>K)){if(R._drag_id&&R._drag_mode=="new-size"){O.end_date.setHours(0);O.end_date.setMinutes(M)}else{L=false;break}}}}}}if(!L){R._drag_id=null;R._drag_mode=null;R.callEvent("onLimitViolation",[O.id,O])}return L};scheduler.attachEvent("onBeforeDrag",function(F){if(!F){return true}return A(scheduler.getEvent(F))});scheduler.attachEvent("onClick",function(G,F){return A(scheduler.getEvent(G))});scheduler.attachEvent("onBeforeLightbox",function(G){var F=scheduler.getEvent(G);E=[F.start_date,F.end_date];return A(F)});scheduler.attachEvent("onEventAdded",function(G){if(!G){return true}var F=scheduler.getEvent(G);if(!A(F)){if(F.start_date<scheduler.config.limit_start){F.start_date=new Date(scheduler.config.limit_start)}if(F.start_date.valueOf()>=scheduler.config.limit_end.valueOf()){F.start_date=this.date.add(scheduler.config.limit_end,-1,"day")}if(F.end_date<scheduler.config.limit_start){F.end_date=new Date(scheduler.config.limit_start)}if(F.end_date.valueOf()>=scheduler.config.limit_end.valueOf()){F.end_date=this.date.add(scheduler.config.limit_end,-1,"day")}if(F.start_date.valueOf()>=F.end_date.valueOf()){F.end_date=this.date.add(F.start_date,(this.config.event_duration||this.config.time_step),"minute")}F._timed=this.is_one_day_event(F)}return true});scheduler.attachEvent("onEventChanged",function(G){if(!G){return true}var F=scheduler.getEvent(G);if(!A(F)){if(!E){return false}F.start_date=E[0];F.end_date=E[1];F._timed=this.is_one_day_event(F)}return true});scheduler.attachEvent("onBeforeEventChanged",function(G,F,H){return A(G)})})();