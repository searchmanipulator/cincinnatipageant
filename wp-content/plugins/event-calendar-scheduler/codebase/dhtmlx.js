dhtmlx=function(A){for(var C in A){dhtmlx[C]=A[C]}return dhtmlx};dhtmlx.extend_api=function(C,E,A){var D=window[C];if(D){window[C]=function(H){if(H&&typeof H=="object"&&!H.tagName){var F=D.apply(this,E._init?E._init(H):arguments),I;for(I in dhtmlx){if(E[I]){this[E[I]](dhtmlx[I])}}for(I in H){if(E[I]){this[E[I]](H[I])}else{I.indexOf("on")==0&&this.attachEvent(I,H[I])}}}else{F=D.apply(this,arguments)}E._patch&&E._patch(this);return F||this},window[C].prototype=D.prototype,A&&dhtmlXHeir(window[C].prototype,A)}};dhtmlxAjax={get:function(C,D){var A=new dtmlXMLLoaderObject(!0);A.async=arguments.length<3;A.waitCall=D;A.loadXML(C);return A},post:function(C,E,A){var D=new dtmlXMLLoaderObject(!0);D.async=arguments.length<4;D.waitCall=A;D.loadXML(C,!0,E);return D},getSync:function(A){return this.get(A,null,!0)},postSync:function(A,C){return this.post(A,C,null,!0)}};function dtmlXMLLoaderObject(C,E,A,D){this.xmlDoc="";this.async=typeof A!="undefined"?A:!0;this.onloadAction=C||null;this.mainObject=E||null;this.waitCall=null;this.rSeed=D||!1;return this}dtmlXMLLoaderObject.count=0;dtmlXMLLoaderObject.prototype.waitLoadFunction=function(A){var C=!0;return this.check=function(){if(A&&A.onloadAction!=null&&(!A.xmlDoc.readyState||A.xmlDoc.readyState==4)&&C){C=!1;dtmlXMLLoaderObject.count++;if(typeof A.onloadAction=="function"){A.onloadAction(A.mainObject,null,null,null,A)}if(A.waitCall){A.waitCall.call(this,A),A.waitCall=null}}}};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(C,F){if(this.xmlDoc.responseXML){var A=this.xmlDoc.responseXML.getElementsByTagName(C);A.length==0&&C.indexOf(":")!=-1&&(A=this.xmlDoc.responseXML.getElementsByTagName(C.split(":")[1]));var E=A[0]}else{E=this.xmlDoc.documentElement}if(E){return this._retry=!1,E}if(_isIE&&!this._retry){var D=this.xmlDoc.responseText,F=this.xmlDoc;this._retry=!0;this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=!1;this.xmlDoc.loadXML(D);return this.getXMLTopNode(C,F)}dhtmlxError.throwError("LoadXML","Incorrect XML",[F||this.xmlDoc,this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(A){if(_isIE){this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(A)}else{var C=new DOMParser;this.xmlDoc=C.parseFromString(A,"text/xml")}if(this.onloadAction){this.onloadAction(this.mainObject,null,null,null,this)}if(this.waitCall){this.waitCall(),this.waitCall=null}};dtmlXMLLoaderObject.prototype.loadXML=function(C,E,A,D){this.rSeed&&(C+=(C.indexOf("?")!=-1?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf());this.filePath=C;this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(this.async){this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)}this.xmlDoc.open(E?"POST":"GET",C,this.async);D?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):E&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(A);this.async||(new this.waitLoadFunction(this))()};dtmlXMLLoaderObject.prototype.destructor=function(){return this.setXSLParamValue=this.getXMLTopNode=this.xmlNodeToJSON=this.doSerialization=this.loadXMLString=this.loadXML=this.doXSLTransToString=this.doXSLTransToObject=this.doXPathOpera=this.doXPath=this.xmlDoc=this.mainObject=this.onloadAction=this.filePath=this.rSeed=this.async=this._retry=this._getAllNamedChilds=this._filterXPath=null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(C){for(var E={},A=0;A<C.attributes.length;A++){E[C.attributes[A].name]=C.attributes[A].value}E._tagvalue=C.firstChild?C.firstChild.nodeValue:"";for(A=0;A<C.childNodes.length;A++){var D=C.childNodes[A].tagName;D&&(E[D]||(E[D]=[]),E[D].push(this.xmlNodeToJSON(C.childNodes[A])))}return E};function callerFunction(A,C){return this.handler=function(D){if(!D){D=window.event}A(D,C);return !0}}function getAbsoluteLeft(A){return getOffset(A).left}function getAbsoluteTop(A){return getOffset(A).top}function getOffsetSum(C){for(var D=0,A=0;C;){D+=parseInt(C.offsetTop),A+=parseInt(C.offsetLeft),C=C.offsetParent}return{top:D,left:A}}function getOffsetRect(L){var J=L.getBoundingClientRect(),K=document.body,I=document.documentElement,H=window.pageYOffset||I.scrollTop||K.scrollTop,D=window.pageXOffset||I.scrollLeft||K.scrollLeft,E=I.clientTop||K.clientTop||0,F=I.clientLeft||K.clientLeft||0,C=J.top+H-E,A=J.left+D-F;return{top:Math.round(C),left:Math.round(A)}}function getOffset(A){return A.getBoundingClientRect?getOffsetRect(A):getOffsetSum(A)}function convertStringToBoolean(A){typeof A=="string"&&(A=A.toLowerCase());switch(A){case"1":case"true":case"yes":case"y":case 1:case !0:return !0;default:return !1}}function getUrlSymbol(A){return A.indexOf("?")!=-1?"&":"?"}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.dragStartObject=this.dragStartNode=this.dragNode=this.lastLanding=0;this.tempDOMM=this.tempDOMU=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(A){A.onmousedown=null;A.dragStarter=null;A.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(A,C){A.onmousedown=this.preCreateDragCopy;A.dragStarter=C;this.addDragLanding(A,C)};dhtmlDragAndDropObject.prototype.addDragLanding=function(A,C){A.dragLanding=C};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(A){if(!((A||window.event)&&(A||event).button==2)){if(window.dhtmlDragAndDrop.waitDrag){return window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1}window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(A);window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=(new Date).valueOf();A&&A.preventDefault&&A.preventDefault();return !1}};dhtmlDragAndDropObject.prototype.callDrag=function(C){if(!C){C=window.event}dragger=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,C);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return !1};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else{return dragger.stopDrag(C,!0)}}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var F=dragger.gldragNode;if(dragger.gldragNode.old){F=dragger.gldragNode.old}F.parentNode.removeChild(F);var A=dragger.dragNode.pWindow;F.pWindow&&F.pWindow.dhtmlDragAndDrop.lastLanding&&F.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(F.pWindow.dhtmlDragAndDrop.lastLanding);if(_isIE){var E=document.createElement("Div");E.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=E.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(!0)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);A.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=C.clientX+15+(dragger.fx?dragger.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=C.clientY+3+(dragger.fy?dragger.fy*-1:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";var D=C.srcElement?C.srcElement:C.target;dragger.checkLanding(D,C)}};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(C){if(window.name){for(var F=parent.frames[window.name].frameElement.offsetParent,A=0,E=0;F;){A+=F.offsetLeft,E+=F.offsetTop,F=F.offsetParent}if(parent.dhtmlDragAndDrop){var D=parent.dhtmlDragAndDrop.calculateFramePosition(1);A+=D.split("_")[0]*1;E+=D.split("_")[1]*1}if(C){return A+"_"+E}else{this.fx=A}this.fy=E}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(A,C){A&&A.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=A,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,C.clientX,C.clientY,C),this.lastLanding_scr=_isIE?C.srcElement:C.target):A&&A.tagName!="BODY"?this.checkLanding(A.parentNode,C):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,C.clientX,C.clientY,C),this.lastLanding=0,this._onNotFound&&this._onNotFound())};dhtmlDragAndDropObject.prototype.stopDrag=function(C,D){dragger=window.dhtmlDragAndDrop;if(!D){dragger.stopFrameRoute();var A=dragger.lastLanding;dragger.lastLanding=null;A&&A.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,A,_isIE?event.srcElement:C.target)}dragger.lastLanding=null;dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode);dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(C){C&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var E=0;E<window.frames.length;E++){try{window.frames[E]!=C&&window.frames[E].dhtmlDragAndDrop&&window.frames[E].dhtmlDragAndDrop.stopFrameRoute(window)}catch(A){}}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=C&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(D){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(C,F){if(C){window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=C.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=C.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=C.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=C.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&F&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition()}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=C&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(A){}for(var E=0;E<window.frames.length;E++){try{window.frames[E]!=C&&window.frames[E].dhtmlDragAndDrop&&window.frames[E].dhtmlDragAndDrop.initFrameRoute(window,!C||F?1:0)}catch(D){}}};_OperaRv=_KHTMLrv=_FFrv=_isChrome=_isMacOS=_isKHTML=_isOpera=_isIE=_isFF=!1;navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0);navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):navigator.userAgent.indexOf("Opera")!=-1?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):navigator.appName.indexOf("Microsoft")!=-1?(_isIE=!0,navigator.appVersion.indexOf("MSIE 8.0")!=-1&&document.compatMode!="BackCompat"&&(_isIE=8),navigator.appVersion.indexOf("MSIE 9.0")!=-1&&document.compatMode!="BackCompat"&&(_isIE=8)):(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]));dtmlXMLLoaderObject.prototype.doXPath=function(K,I,J,H){if(_isKHTML||!_isIE&&!window.XPathResult){return this.doXPathOpera(K,I)}if(_isIE){return I||(I=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),I||dhtmlxError.throwError("LoadXML","Incorrect XML",[I||this.xmlDoc,this.mainObject]),J!=null&&I.setProperty("SelectionNamespaces","xmlns:xsl='"+J+"'"),H=="single"?I.selectSingleNode(K):I.selectNodes(K)||[]}else{var F=I;I||(I=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML);I||dhtmlxError.throwError("LoadXML","Incorrect XML",[I||this.xmlDoc,this.mainObject]);I.nodeName.indexOf("document")!=-1?F=I:(F=I,I=I.ownerDocument);var C=XPathResult.ANY_TYPE;if(H=="single"){C=XPathResult.FIRST_ORDERED_NODE_TYPE}var D=[],E=I.evaluate(K,F,function(){return J},C,null);if(C==XPathResult.FIRST_ORDERED_NODE_TYPE){return E.singleNodeValue}for(var A=E.iterateNext();A;){D[D.length]=A,A=E.iterateNext()}return D}};function x(){if(!this.catches){this.catches=[]}return this}x.prototype.catchError=function(A,C){this.catches[A]=C};x.prototype.throwError=function(C,D,A){if(this.catches[C]){return this.catches[C](C,D,A)}if(this.catches.ALL){return this.catches.ALL(C,D,A)}alert("Error type: "+C+"\nDescription: "+D);return null};window.dhtmlxError=new x;dtmlXMLLoaderObject.prototype.doXPathOpera=function(C,F){var A=C.replace(/[\/]+/gi,"/").split("/"),E=null,D=1;if(!A.length){return[]}if(A[0]=="."){E=[F]}else{if(A[0]==""){E=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(A[D].replace(/\[[^\]]*\]/g,"")),D++}else{return[]}}for(;D<A.length;D++){E=this._getAllNamedChilds(E,A[D])}A[D-1].indexOf("[")!=-1&&(E=this._filterXPath(E,A[D-1]));return E};dtmlXMLLoaderObject.prototype._filterXPath=function(C,E){for(var A=[],E=E.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),D=0;D<C.length;D++){C[D].getAttribute(E)&&(A[A.length]=C[D])}return A};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(C,F){var A=[];_isKHTML&&(F=F.toUpperCase());for(var E=0;E<C.length;E++){for(var D=0;D<C[E].childNodes.length;D++){_isKHTML?C[E].childNodes[D].tagName&&C[E].childNodes[D].tagName.toUpperCase()==F&&(A[A.length]=C[E].childNodes[D]):C[E].childNodes[D].tagName==F&&(A[A.length]=C[E].childNodes[D])}}return A};function dhtmlXHeir(C,D){for(var A in D){typeof D[A]=="function"&&(C[A]=D[A])}return C}function dhtmlxEvent(C,D,A){C.addEventListener?C.addEventListener(D,A,!1):C.attachEvent&&C.attachEvent("on"+D,A)}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(C,E,A){if(!A){A=this.xslDoc}if(A.responseXML){A=A.responseXML}var D=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+C+"']",A,"http://www.w3.org/1999/XSL/Transform","single");if(D!=null){D.firstChild.nodeValue=E}};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(C,E){if(!C){C=this.xslDoc}if(C.responseXML){C=C.responseXML}if(!E){E=this.xmlDoc}if(E.responseXML){E=E.responseXML}if(_isIE){D=new ActiveXObject("Msxml2.DOMDocument.3.0");try{E.transformNodeToObject(C,D)}catch(A){D=E.transformNode(C)}}else{if(!this.XSLProcessor){this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(C)}var D=this.XSLProcessor.transformToDocument(E)}return D};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(C,D){var A=this.doXSLTransToObject(C,D);return typeof A=="string"?A:this.doSerialization(A)};dtmlXMLLoaderObject.prototype.doSerialization=function(A){if(!A){A=this.xmlDoc}if(A.responseXML){A=A.responseXML}if(_isIE){return A.xml}else{var C=new XMLSerializer;return C.serializeToString(A)}};dhtmlxEventable=function(a){a.attachEvent=function(a,b,d){a="ev_"+a.toLowerCase();this[a]||(this[a]=new this.eventCatcher(d||this));return a+":"+this[a].addEvent(b)};a.callEvent=function(a,b){a="ev_"+a.toLowerCase();return this[a]?this[a].apply(this,b):!0};a.checkEvent=function(a){return !!this["ev_"+a.toLowerCase()]};a.eventCatcher=function(a){var b=[],d=function(){for(var e=!0,d=0;d<b.length;d++){if(b[d]!=null){var g=b[d].apply(a,arguments),e=e&&g}}return e};d.addEvent=function(a){typeof a!="function"&&(a=eval(a));return a?b.push(a)-1:!1};d.removeEvent=function(a){b[a]=null};return d};a.detachEvent=function(a){if(a!=!1){var b=a.split(":");this[b[0]].removeEvent(b[1])}};a.detachAllEvents=function(){for(var a in this){a.indexOf("ev_")==0&&delete this[a]}}};(function(){var A=dhtmlx.message=function(H,C,F,E){if(!A.area){A.area=document.createElement("DIV"),A.area.style.cssText="position:absolute;right:5px;width:250px;z-index:100;",A.area.className="dhtmlx_message_area",A.area.style[A.defPosition]="5px",document.body.appendChild(A.area)}typeof H!="object"&&(H={text:H,type:C,lifetime:F,id:E});H.type=H.type||"info";H.id=H.id||A.uid();H.lifetime=H.lifetime||A.defTimeout;A.hide(H.id);var D=document.createElement("DIV");D.style.cssText="border-radius:4px; padding:4px 4px 4px 20px;background-color:#FFFFCC;font-size:12px;font-family:Tahoma;color:navy;z-index: 10000;margin:5px;border:1px solid lightgrey;";D.innerHTML=H.text;D.className=H.type;A.defPosition=="bottom"&&A.area.firstChild?A.area.insertBefore(D,A.area.firstChild):A.area.appendChild(D);A.timers[H.id]=window.setTimeout(function(){A.hide(H.id)},H.lifetime);A.pull[H.id]=D;return H.id};A.defTimeout=4000;A.defPosition="top";A.pull={};A.timers={};A.seed=(new Date).valueOf();A.uid=function(){return A.seed++};A.hideAll=function(){for(var C in A.pull){A.hide(C)}};A.hide=function(D){var C=A.pull[D];C&&C.parentNode&&(C.parentNode.removeChild(C),window.clearTimeout(A.timers[D]),delete A.pull[D])}})();var globalActiveDHTMLGridObject;String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(A){return dhtmlXHeir(A||[],dhtmlxArray._master)}dhtmlxArray._master={_dhx_find:function(A){for(var C=0;C<this.length;C++){if(A==this[C]){return C}}return -1},_dhx_insertAt:function(C,D){this[this.length]=null;for(var A=this.length-1;A>=C;A--){this[A]=this[A-1]}this[C]=D},_dhx_removeAt:function(A){this.splice(A,1)},_dhx_swapItems:function(C,D){var A=this[C];this[C]=this[D];this[D]=A}};function dhtmlXGridObject(a){if(_isIE){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(c){}}a?typeof a=="object"?(this.entBox=a,this.entBox.id="cgrid2_"+this.uid()):this.entBox=document.getElementById(a):(this.entBox=document.createElement("DIV"),this.entBox.id="cgrid2_"+this.uid());this.entBox.innerHTML="";dhtmlxEventable(this);var b=this;this._wcorr=0;this.fontWidth=7;this.row=this.cell=null;this.iconURL="";this.editor=null;this._dclE=this._f2kE=!0;this.combos=[];this.defVal=[];this.rowsAr={};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=!0;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,!0,this.no_cashe);this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?this.entBox.style.width||window.getComputedStyle(this.entBox,null).width:this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0)||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?this.entBox.style.height||window.getComputedStyle(this.entBox,null).height:this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0)||"100%";this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return !1};var d=function(a){var b=document.createElement("TABLE");b.cellSpacing=b.cellPadding=0;b.style.cssText="width:100%;table-layout:fixed;";b.className=a.substr(2);return b};this.obj=d("c_obj");this.hdr=d("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";this.hdrBox=document.createElement("DIV");this.hdrBox.style.width="100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className="xhdr";this.preloadImagesAr=[];this.sortImg=document.createElement("IMG");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=_isIE&&document.compatMode!="BackCompat"?22:20;this.imgURL=window.dhx_globalImgPath||"";this.isActive=!1;this.isEditable=!0;this.pagingOn=this.useImagesInHeader=!1;this.rowsBufferOutSize=0;dhtmlxEvent(window,"unload",function(){try{b.destructor&&b.destructor()}catch(a){}});this.setSkin=function(a){this.skin_name=a;this.entBox.className="gridbox gridbox_"+a;this.skin_h_correction=0;this.enableAlterCss("ev_"+a,"odd_"+a,this.isTreeGrid());this._fixAlterCss();switch(a){case"clear":this._topMb=document.createElement("DIV");this._topMb.className="topMumba";this._topMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinC_top_left.gif'><img style='right:20px' src='"+this.imgURL+"skinC_top_right.gif'>";this.entBox.appendChild(this._topMb);this._botMb=document.createElement("DIV");this._botMb.className="bottomMumba";this._botMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.imgURL+"skinD_bottom_right.gif'>";this.entBox.appendChild(this._botMb);this.entBox.style.position="relative";this.skin_h_correction=20;break;case"dhx_skyblue":case"dhx_web":case"glassy_blue":case"dhx_black":case"dhx_blue":case"modern":case"light":this._srdh=20;this.forceDivInHeader=!0;break;case"xp":this.forceDivInHeader=!0;this._srdh=_isIE&&document.compatMode!="BackCompat"?26:22;break;case"mt":this._srdh=_isIE&&document.compatMode!="BackCompat"?26:22;break;case"gray":if(_isIE&&document.compatMode!="BackCompat"){this._srdh=22}}if(_isIE&&this.hdr){var b=this.hdr.parentNode;b.removeChild(this.hdr);b.appendChild(this.hdr)}this.setSizes()};_isIE&&this.preventIECaching(!0);if(window.dhtmlDragAndDropObject){this.dragger=new dhtmlDragAndDropObject}this._doOnScroll=function(a,b){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(a,b)};this.doOnScroll=function(a,c){this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr){this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft}if(!c&&this._srnd){this._dLoadTimer&&window.clearTimeout(this._dLoadTimer),this._dLoadTimer=window.setTimeout(function(){b._update_srnd_view&&b._update_srnd_view()},100)}};this.attachToObject=function(a){a.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(a){if(this.isTreeGrid()&&!this._h2){this._h2=new dhtmlxHierarchy;if(this._fake&&!this._realfake){this._fake._h2=this._h2}this._tgc={imgURL:null}}if(this._hstyles){this.editStop();this.fldSorted=this.r_fldSorted=this.resized=this.lastClicked=null;this.cellWidthPX=[];this.cellWidthPC=[];this.hdr.rows.length>0&&this.clearAll(!0);for(var c=this.hdr.insertRow(0),d=0;d<this.hdrLabels.length;d++){c.appendChild(document.createElement("TH")),c.childNodes[d]._cellIndex=d,c.childNodes[d].style.height="0px"}_isIE&&_isIE<8?c.style.position="absolute":c.style.height="auto";c=this.hdr.insertRow(_isKHTML?2:1);c._childIndexes=[];for(var f=0,d=0;d<this.hdrLabels.length;d++){c._childIndexes[d]=d-f,this.hdrLabels[d]==this.splitSign&&d!=0?(_isKHTML&&c.insertCell(d-f),c.cells[d-f-1].colSpan=(c.cells[d-f-1].colSpan||1)+1,c.childNodes[d-f-1]._cellIndex++,f++,c._childIndexes[d]=d-f):(c.insertCell(d-f),c.childNodes[d-f]._cellIndex=d,c.childNodes[d-f]._cellIndexS=d,this.setColumnLabel(d,this.hdrLabels[d]))}if(f==0){c._childIndexes=null}this._cCount=this.hdrLabels.length;_isIE&&window.setTimeout(function(){b.setSizes&&b.setSizes()},1);this.obj.firstChild||this.obj.appendChild(document.createElement("TBODY"));var i=this.obj.firstChild;if(!i.firstChild){i.appendChild(document.createElement("TR"));i=i.firstChild;_isIE&&_isIE<8?i.style.position="absolute":i.style.height="auto";for(d=0;d<this.hdrLabels.length;d++){i.appendChild(document.createElement("TH")),i.childNodes[d].style.height="0px"}}this._c_order=null;this.multiLine!=!0&&(this.obj.className+=" row20px");this.sortImg.style.position="absolute";this.sortImg.style.display="none";this.sortImg.src=this.imgURL+"sort_desc.gif";this.sortImg.defLeft=0;this.noHeader?this.hdrBox.style.display="none":this.noHeader=!1;this._ivizcol&&this.setColHidden();this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();a&&this.parseXML();this.obj.scrollTop=0;this.dragAndDropOff&&this.dragger.addDragLanding(this.entBox,this);this._initDrF&&this._initD();this._init_point&&this._init_point()}};this.setColumnSizes=function(a){for(var b=0,c=[],d=0,i=0;i<this._cCount;i++){if(this.initCellWidth[i]=="*"&&!this._hrrar[i]){this._awdth=!1,c.push(i)}else{if(this.cellWidthType=="%"){typeof this.cellWidthPC[i]=="undefined"&&(this.cellWidthPC[i]=this.initCellWidth[i]);var j=a*this.cellWidthPC[i]/100||0;d>0.5&&(j++,d--);var k=this.cellWidthPX[i]=Math.floor(j),d=d+j-k}else{typeof this.cellWidthPX[i]=="undefined"&&(this.cellWidthPX[i]=this.initCellWidth[i])}this._hrrar[i]||(b+=this.cellWidthPX[i]*1)}}if(c.length){var l=Math.floor((a-b)/c.length);l<0&&(l=1);for(i=0;i<c.length;i++){var m=Math.max(this._drsclmW?this._drsclmW[c[i]]||0:0,l);this.cellWidthPX[c[i]]=m;b+=m}if(a>b){var o=c[c.length-1];this.cellWidthPX[o]+=a-b;b=a}this._setAutoResize()}this.obj.style.width=b+"px";this.hdr.style.width=b+"px";if(this.ftr){this.ftr.style.width=b+"px"}this.chngCellWidth();return b};this.setSizes=function(){if(this.hdr.rows[0]){var a=this.quirks=_isIE&&document.compatMode=="BackCompat",c=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(this.globalBox){var d=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&&!this._realfake){var f=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x;this.entBox.style.width=Math.max(0,this.globalBox.clientWidth+(a?d*2:0)-this._fake.entBox.clientWidth)+"px";f!=this.globalBox.clientWidth&&this._fake._correctSplit(this._fake.entBox.clientWidth)}if(this._delta_y&&!this._realfake){this.globalBox.style.height=this._delta_y,this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden",this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(a?d*2:0)+"px"}}else{if(this._delta_x){this.entBox.parentNode&&this.entBox.parentNode.tagName=="TD"?(this.entBox.style.width="1px",this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-c*2+"px"):this.entBox.style.width=this._delta_x}if(this._delta_y){this.entBox.style.height=this._delta_y}}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth)){this._sizeTime=window.setTimeout(function(){b.setSizes&&b.setSizes()},250)}else{var i=(this.entBox.cmp||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==0&&!a?2:0,j=(this.entBox.cmp||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&&!a?2:0,k=this.parentGrid?!1:this.objBox.scrollHeight>this.objBox.offsetHeight,l=_isFF?18:18,m=this.entBox.clientWidth-(this.skin_h_correction||0)*(a?0:1)-i,o=this.entBox.clientWidth-(this.skin_h_correction||0)-i,n=this.entBox.clientHeight-j,p=this.setColumnSizes(o-(k?l:0)-(this._correction_x||0)),r=this.parentGrid?!1:this.objBox.scrollWidth>this.objBox.offsetWidth||this.objBox.style.overflowX=="scroll",t=this.hdr.clientHeight,s=this.ftr?this.ftr.clientHeight:0,u=m,q=n-t-s;this._awdth&&this._awdth[0]&&this._awdth[1]==99999&&(r=0);if(this._ahgr&&(q=this._ahgrMA?this.entBox.parentNode.clientHeight-t-s:this.obj.offsetHeight+(r?l:0)+(this._correction_y||0),this._ahgrM&&(q=this._ahgrF?Math.min(this._ahgrM,q+t+s)-t-s:Math.min(this._ahgrM,q)),k&&q>=this.obj.scrollHeight+(r?l:0))){k=!1,this.setColumnSizes(o-(this._correction_x||0))}if(this._awdth&&this._awdth[0]){if(this.cellWidthType=="%"){this.cellWidthType="px"}this._fake&&(p+=this._fake.entBox.clientWidth);u=Math.min(Math.max(p+(k?l:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);this._fake&&(u-=this._fake.entBox.clientWidth)}q=Math.max(0,q);this._ff_size_delta=this._ff_size_delta==0.1?0.2:0.1;if(!_isFF){this._ff_size_delta=0}this.entBox.style.width=Math.max(0,u+(a?2:0)*c+this._ff_size_delta)+"px";this.entBox.style.height=q+(a?2:0)*c+t+s+"px";this.objBox.style.height=q+(a&&!k?2:0)*c+"px";this.hdrBox.style.height=t+"px";q!=n&&this.doOnScroll(0,!this._srnd);var v=this["setSizes_"+this.skin_name];v&&v.call(this);this.setSortImgPos();t!=this.hdr.clientHeight&&this._ahgr&&this.setSizes();this.callEvent("onSetSizes",[])}}};this.setSizes_clear=function(){var a=this.hdr.offsetHeight,b=this.entBox.offsetWidth,c=a+this.objBox.offsetHeight;this._topMb.style.top=(a||0)+"px";this._topMb.style.width=b+20+"px";this._botMb.style.top=c-3+"px";this._botMb.style.width=b+20+"px"};this.chngCellWidth=function(){if(_isOpera&&this.ftr){this.ftr.width=this.objBox.scrollWidth+"px"}for(var a=this._cCount,b=0;b<a;b++){if(this.hdr.rows[0].cells[b].style.width=this.cellWidthPX[b]+"px",this.obj.rows[0].childNodes[b].style.width=this.cellWidthPX[b]+"px",this.ftr){this.ftr.rows[0].cells[b].style.width=this.cellWidthPX[b]+"px"}}};this.setDelimiter=function(a){this.delim=a};this.setInitWidthsP=function(a,b){this.cellWidthType="%";this.initCellWidth=a.split(this.delim.replace(/px/gi,""));b||this._setAutoResize()};this._setAutoResize=function(){if(!this._realfake){var a=window,b=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(b._resize_timer);if(b._setAutoResize){b._resize_timer=window.setTimeout(function(){b.setSizes&&b.setSizes();b._fake&&b._fake._correctSplit()},100)}})}};this.setInitWidths=function(a){this.cellWidthType="px";this.initCellWidth=a.split(this.delim);if(_isFF){for(var b=0;b<this.initCellWidth.length;b++){this.initCellWidth[b]!="*"&&(this.initCellWidth[b]=parseInt(this.initCellWidth[b]))}}};this.enableMultiline=function(a){this.multiLine=convertStringToBoolean(a)};this.enableMultiselect=function(a){this.selMultiRows=convertStringToBoolean(a)};this.setImagesPath=this.setImagePath=function(a){this.imgURL=a};this.setIconsPath=this.setIconPath=function(a){this.iconURL=a};this.changeCursorState=function(a){var b=a.target||a.srcElement;b.tagName!="TD"&&(b=this.getFirstParentOfType(b,"TD"));if(b){if(b.tagName=="TD"&&this._drsclmn&&!this._drsclmn[b._cellIndex]){return b.style.cursor="default"}var c=(a.layerX||0)+(!_isIE&&a.target.tagName=="DIV"?b.offsetLeft:0);b.style.cursor=b.offsetWidth-(a.offsetX||(parseInt(this.getPosition(b,this.hdrBox))-c)*-1)<(_isOpera?20:10)?"E-resize":"default";if(_isOpera){this.hdrBox.scrollLeft=this.objBox.scrollLeft}}};this.startColResize=function(a){this.resized&&this.stopColResize();this.resized=null;var c=a.target||a.srcElement;c.tagName!="TD"&&(c=this.getFirstParentOfType(c,"TD"));var d=a.clientX,f=this.hdr.offsetWidth,i=parseInt(c.offsetWidth);if(c.tagName=="TD"&&c.style.cursor!="default"&&(!this._drsclmn||this._drsclmn[c._cellIndex])){b._old_d_mm=document.body.onmousemove,b._old_d_mu=document.body.onmouseup,document.body.onmousemove=function(a){b&&b.doColResize(a||window.event,c,i,d,f)},document.body.onmouseup=function(){b&&b.stopColResize()}}};this.stopColResize=function(){document.body.onmousemove=b._old_d_mm||"";document.body.onmouseup=b._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(a,b,c,d,i){b.style.cursor="E-resize";this.resized=b;var j=c+(a.clientX-d),k=i+(a.clientX-d);if(this.callEvent("onResize",[b._cellIndex,j,this])){if(_isIE){this.objBox.scrollLeft=this.hdrBox.scrollLeft}if(b.colSpan>1){for(var l=[],m=0;m<b.colSpan;m++){l[m]=Math.round(j*this.hdr.rows[0].childNodes[b._cellIndexS+m].offsetWidth/b.offsetWidth)}for(m=0;m<b.colSpan;m++){this._setColumnSizeR(b._cellIndexS+m*1,l[m])}}else{this._setColumnSizeR(b._cellIndex,j)}this.doOnScroll(0,1);this.setSizes();this._fake&&this._awdth&&this._fake._correctSplit()}};this._setColumnSizeR=function(a,b){if(b>(this._drsclmW&&!this._notresize?this._drsclmW[a]||10:10)){this.obj.rows[0].childNodes[a].style.width=b+"px";this.hdr.rows[0].childNodes[a].style.width=b+"px";if(this.ftr){this.ftr.rows[0].childNodes[a].style.width=b+"px"}if(this.cellWidthType=="px"){this.cellWidthPX[a]=b}else{var c=parseInt(this.entBox.offsetWidth);this.objBox.scrollHeight>this.objBox.offsetHeight&&(c-=17);var d=Math.round(b/c*100);this.cellWidthPC[a]=d}this.sortImg.style.display!="none"&&this.setSortImgPos()}};this.setSortImgState=function(a,b,c,d){c=(c||"asc").toLowerCase();if(convertStringToBoolean(a)){this.sortImg.src=c=="asc"?this.imgURL+"sort_asc.gif":this.imgURL+"sort_desc.gif";this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[b];var i=this.hdr.rows[d||1];if(i){for(var j=0;j<i.childNodes.length;j++){if(i.childNodes[j]._cellIndexS==b){return this.r_fldSorted=i.childNodes[j],this.setSortImgPos()}}return this.setSortImgState(a,b,c,(d||1)+1)}}else{this.sortImg.style.display="none",this.fldSorted=null}};this.setSortImgPos=function(a,b,c,d){if(!this._hrrar||!this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:a]){if(d||(d=a?this.hdr.rows[c||0].cells[a]:this.r_fldSorted),d!=null){var i=this.getPosition(d,this.hdrBox),j=d.offsetWidth;this.sortImg.style.left=Number(i[0]+j-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(i[1]+5)+"px";if(!this.useImagesInHeader&&!b){this.sortImg.style.display="inline"}this.sortImg.style.left=this.sortImg.defLeft+"px"}}};this.setActive=function(a){arguments.length==0&&(a=!0);a==!0?(globalActiveDHTMLGridObject&&globalActiveDHTMLGridObject!=this&&(globalActiveDHTMLGridObject.editStop(),globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])),globalActiveDHTMLGridObject=this,this.isActive=!0):(this.isActive=!1,this.callEvent("onBlur",[this]))};this._doClick=function(a){var b=0,c=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(c){var d=!0;if(this.markedCells){var i=0;if(a.shiftKey||a.metaKey){i=1}a.ctrlKey&&(i=2);this.doMark(c,i);return !0}if(this.selMultiRows!=!1&&(a.shiftKey&&this.row!=null&&this.selectedRows.length&&(b=1),a.ctrlKey||a.metaKey)){b=2}this.doClick(c,d,b)}};this._doContClick=function(a){var b=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(!b||typeof b.parentNode.idd=="undefined"){return !0}if(a.button==2||_isMacOS&&a.ctrlKey){if(!this.callEvent("onRightClick",[b.parentNode.idd,b._cellIndex,a])){var c=function(a){(a||event).cancelBubble=!0;return !1};(a.srcElement||a.target).oncontextmenu=c;return c(a)}if(this._ctmndx){if(!this.callEvent("onBeforeContextMenu",[b.parentNode.idd,b._cellIndex,this])){return !0}if(_isIE){a.srcElement.oncontextmenu=function(){event.cancelBubble=!0;return !1}}if(this._ctmndx.showContextMenu){var d=window.document.documentElement,i=window.document.body,j=[d.scrollLeft||i.scrollLeft,d.scrollTop||i.scrollTop];if(_isIE){var k=a.clientX+j[0],l=a.clientY+j[1]}else{k=a.pageX,l=a.pageY}this._ctmndx.showContextMenu(k-1,l-1);this.contextID=this._ctmndx.contextMenuZoneId=b.parentNode.idd+"_"+b._cellIndex;this._ctmndx._skip_hide=!0}else{b.contextMenuId=b.parentNode.idd+"_"+b._cellIndex,b.contextMenu=this._ctmndx,b.a=this._ctmndx._contextStart,b.a(b,a),b.a=null}a.cancelBubble=!0;return !1}}else{this._ctmndx&&(this._ctmndx.hideContextMenu?this._ctmndx.hideContextMenu():this._ctmndx._contextEnd())}return !0};this.doClick=function(a,c,d,f){this.selMultiRows||(d=0);var i=this.row?this.row.idd:0;this.setActive(!0);d||(d=0);if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"")}if(a.tagName=="TD"){if(this.checkEvent("onSelectStateChanged")){var j=this.getSelectedId()}var k=this.row;if(d==1){var l=this.rowsCol._dhx_find(a.parentNode),m=this.rowsCol._dhx_find(this.lastClicked);if(l>m){var o=m,n=l}else{o=l,n=m}for(var p=0;p<this.rowsCol.length;p++){if(p>=o&&p<=n){if(this.rowsCol[p]&&!this.rowsCol[p]._sRow){this.rowsCol[p].className.indexOf("rowselected")==-1&&this.callEvent("onBeforeSelect",[this.rowsCol[p].idd,i])&&(this.rowsCol[p].className+=" rowselected",this.selectedRows[this.selectedRows.length]=this.rowsCol[p])}else{return this.clearSelection(),this.doClick(a,c,0,f)}}}}else{if(d==2&&a.parentNode.className.indexOf("rowselected")!=-1){a.parentNode.className=a.parentNode.className.replace(/rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(a.parentNode));var r=!0}}this.editStop();if(typeof a.parentNode.idd=="undefined"){return !0}if(!r&&!a.parentNode._sRow){if(this.callEvent("onBeforeSelect",[a.parentNode.idd,i])){if(this.getSelectedRowId()!=a.parentNode.idd){d==0&&this.clearSelection();this.cell=a;k==a.parentNode&&this._chRRS&&(c=!1);this.row=a.parentNode;this.row.className+=" rowselected";if(this.cell&&_isIE&&_isIE==8){var t=this.cell.nextSibling,s=this.cell.parentNode;s.removeChild(this.cell);s.insertBefore(this.cell,t)}if(this.selectedRows._dhx_find(this.row)==-1){this.selectedRows[this.selectedRows.length]=this.row}}else{this.cell=a}}else{c=!1}}if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1){this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected"}if(d!=1&&!this.row){return }this.lastClicked=a.parentNode;var u=this.row.idd,q=this.cell;c&&typeof u!="undefined"&&q&&!r?b.onRowSelectTime=setTimeout(function(){b.callEvent&&b.callEvent("onRowSelect",[u,q._cellIndex])},100):this.callEvent("onRowSelectRSOnly",[u]);if(this.checkEvent("onSelectStateChanged")){var v=this.getSelectedId();j!=v&&this.callEvent("onSelectStateChanged",[v,j])}}this.isActive=!0;f!==!1&&this.cell&&this.cell.parentNode.idd&&this.moveToVisible(this.cell)};this.selectAll=function(){this.clearSelection();var a=this.rowsBuffer;if(this.pagingOn){a=this.rowsCol}for(var b=0;b<a.length;b++){this.render_row(b).className+=" rowselected"}this.selectedRows=dhtmlxArray([].concat(a));if(this.selectedRows.length){this.row=this.selectedRows[0],this.cell=this.row.cells[0]}this._fake&&!this._realfake&&this._fake.selectAll()};this.selectCell=function(a,b,c,d,i,j){c||(c=!1);typeof a!="object"&&(a=this.render_row(a));if(!a||a==-1){return null}var k=a._childIndexes?a.childNodes[a._childIndexes[b]]:a.childNodes[b];k||(k=a.childNodes[0]);d?this.doClick(k,c,3,j):this.doClick(k,c,0,j);i&&this.editCell()};this.moveToVisible=function(a,b){if(this.pagingOn){var c=Math.floor(this.getRowIndex(a.parentNode.idd)/this.rowsBufferOutSize)+1;c!=this.currentPage&&this.changePage(c)}try{if(a.offsetHeight){var d=a.offsetLeft+a.offsetWidth+20,i=0;d>this.objBox.offsetWidth+this.objBox.scrollLeft?a.offsetLeft>this.objBox.scrollLeft&&(i=a.offsetLeft-5):a.offsetLeft<this.objBox.scrollLeft&&(d-=a.offsetWidth*2/3,d<this.objBox.scrollLeft&&(i=a.offsetLeft-5));if(i&&!b){this.objBox.scrollLeft=i}}if(a.offsetHeight){d=a.offsetTop}else{var j=this._realfake?this._fake.rowsAr[a.parentNode.idd]:a.parentNode,d=this.rowsBuffer._dhx_find(j)*this._srdh}var k=d+a.offsetHeight+38;if(k>this.objBox.offsetHeight+this.objBox.scrollTop){var l=k-this.objBox.offsetHeight}else{d<this.objBox.scrollTop&&(l=d-5)}if(l){this.objBox.scrollTop=l}}catch(m){}};this.editCell=function(){if(!(this.editor&&this.cell==this.editor.cell)){this.editStop();if(this.isEditable!=!0||!this.cell){return !1}var a=this.cell;if(a.parentNode._locked){return !1}this.editor=this.cells4(a);if(this.editor!=null){if(this.editor.isDisabled()){return this.editor=null,!1}this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=!1&&this.editor.edit?(this._Opera_stop=(new Date).valueOf(),a.className+=" editable",this.editor.edit(),this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])):this.editor=null}}};this.editStop=function(a){if(_isOpera&&this._Opera_stop){if(this._Opera_stop*1+50>(new Date).valueOf()){return }this._Opera_stop=null}if(this.editor&&this.editor!=null){if(this.editor.cell.className=this.editor.cell.className.replace("editable",""),a){var b=this.editor.val;this.editor.detach();this.editor.setValue(b);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,b])}else{if(this.editor.detach()){this.cell.wasChanged=!0}var c=this.editor;this.editor=null;var d=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,c.getValue(),c.val]);if(typeof d=="string"||typeof d=="number"){c[c.setImage?"setLabel":"setValue"](d)}else{if(!d){c[c.setImage?"setLabel":"setValue"](c.val)}}this._ahgr&&this.multiLine&&this.setSizes()}}};this._nextRowCell=function(a,b,c){a=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(a),b);return !a?null:a.childNodes[a._childIndexes?a._childIndexes[c]:c]};this._getNextCell=function(a,b,c){var a=a||this.cell,d=a.parentNode;this._tabOrder?(c=this._tabOrder[a._cellIndex],typeof c!="undefined"&&(a=c<0?this._nextRowCell(d,b,Math.abs(c)-1):d.childNodes[c])):(c=a._cellIndex+b,c>=0&&c<this._cCount?(d._childIndexes&&(c=d._childIndexes[a._cellIndex]+b),a=d.childNodes[c]):a=this._nextRowCell(d,b,b==1?0:this._cCount-1));return !a?(b==1&&this.tabEnd&&(this.tabEnd.focus(),this.tabEnd.focus(),this.setActive(!1)),b==-1&&this.tabStart&&(this.tabStart.focus(),this.tabStart.focus(),this.setActive(!1)),null):a.style.display!="none"&&(!this.smartTabOrder||!this.cells(a.parentNode.idd,a._cellIndex).isDisabled())?a:this._getNextCell(a,b)};this._nextRow=function(a,b){var c=this.render_row(a+b);return !c||c==-1?null:c&&c.style.display=="none"?this._nextRow(a+b,b):c};this.scrollPage=function(a){if(this.rowsBuffer.length){var b=this._realfake?this._fake:this,c=Math.floor((b._r_select||this.getRowIndex(this.row.idd)||0)+a*this.objBox.offsetHeight/(this._srdh||20));c<0&&(c=0);c>=this.rowsBuffer.length&&(c=this.rowsBuffer.length-1);if(this._srnd&&!this.rowsBuffer[c]){this.objBox.scrollTop+=Math.floor(a*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20);if(this._fake){this._fake.objBox.scrollTop=this.objBox.scrollTop}b._r_select=c}else{this.selectCell(c,this.cell._cellIndex,!0,!1,!1,this.multiLine||this._srnd);if(!this.multiLine&&!this._srnd&&!this._realfake&&(this.objBox.scrollTop=this.getRowById(this.getRowId(c)).offsetTop,this._fake)){this._fake.objBox.scrollTop=this.objBox.scrollTop}b._r_select=null}}};this.doKey=function(a){if(!a){return !0}if((a.target||a.srcElement).value!==window.undefined){var b=a.target||a.srcElement;if(!b.parentNode||b.parentNode.className.indexOf("editable")==-1){return !0}}if(globalActiveDHTMLGridObject&&this!=globalActiveDHTMLGridObject){return globalActiveDHTMLGridObject.doKey(a)}if(this.isActive==!1){return !0}if(this._htkebl){return !0}if(!this.callEvent("onKeyPress",[a.keyCode,a.ctrlKey,a.shiftKey,a])){return !1}var c="k"+a.keyCode+"_"+(a.ctrlKey?1:0)+"_"+(a.shiftKey?1:0);if(this.cell){if(this._key_events[c]){if(!1===this._key_events[c].call(this)){return !0}a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return !1}this._key_events.k_other&&this._key_events.k_other.call(this,a)}return !0};this.selectRow=function(a,b,c,d){typeof a!="object"&&(a=this.render_row(a));this.selectCell(a,0,b,c,!1,d)};this.wasDblClicked=function(a){var b=this.getFirstParentOfType(_isIE?a.srcElement:a.target,"TD");if(b){var c=b.parentNode.idd;return this.callEvent("onRowDblClicked",[c,b._cellIndex])}};this._onHeaderClick=function(a,b){var c=this.grid,b=b||c.getFirstParentOfType(_isIE?event.srcElement:a.target,"TD");if(this.grid.resized==null){if(!this.grid.callEvent("onHeaderClick",[b._cellIndexS,a||window.event])){return !1}c.sortField(b._cellIndexS,!1,b)}this.grid.resized=null};this.deleteSelectedRows=function(){var a=this.selectedRows.length;if(a!=0){var b=this.selectedRows;this.selectedRows=dhtmlxArray();for(var c=a-1;c>=0;c--){var d=b[c];if(this.deleteRow(d.idd,d)){if(d==this.row){var i=c}}else{this.selectedRows[this.selectedRows.length]=d}}if(i){try{i+1>this.rowsCol.length&&i--,this.selectCell(i,0,!0)}catch(j){this.cell=this.row=null}}}};this.getSelectedRowId=function(){for(var a=[],b={},c=0;c<this.selectedRows.length;c++){var d=this.selectedRows[c].idd;b[d]||(a[a.length]=d,b[d]=!0)}return a.length==0?null:a.join(this.delim)};this.getSelectedCellIndex=function(){return this.cell!=null?this.cell._cellIndex:-1};this.getColWidth=function(a){return parseInt(this.cellWidthPX[a])};this.setColWidth=function(a,b){this._hrrar[a]||(this.cellWidthType=="px"?this.cellWidthPX[a]=parseInt(b):this.cellWidthPC[a]=parseInt(b),this.setSizes())};this.getRowIndex=function(a){for(var b=0;b<this.rowsBuffer.length;b++){if(this.rowsBuffer[b]&&this.rowsBuffer[b].idd==a){return b}}return -1};this.getRowId=function(a){return this.rowsBuffer[a]?this.rowsBuffer[a].idd:this.undefined};this.setRowId=function(a,b){this.changeRowId(this.getRowId(a),b)};this.changeRowId=function(a,b){if(a!=b){var c=this.rowsAr[a];c.idd=b;this.UserData[a]&&(this.UserData[b]=this.UserData[a],this.UserData[a]=null);if(this._h2&&this._h2.get[a]){this._h2.get[b]=this._h2.get[a],this._h2.get[b].id=b,delete this._h2.get[a]}this.rowsAr[a]=null;this.rowsAr[b]=c;for(var d=0;d<c.childNodes.length;d++){if(c.childNodes[d]._code){c.childNodes[d]._code=this._compileSCL(c.childNodes[d]._val,c.childNodes[d])}}if(this._mat_links&&this._mat_links[a]){var i=this._mat_links[a];delete this._mat_links[a];for(var j in i){for(d=0;d<i[j].length;d++){this._compileSCL(i[j][d].original,i[j][d])}}}this.callEvent("onRowIdChange",[a,b])}};this.setColumnIds=function(a){this.columnIds=a.split(this.delim)};this.setColumnId=function(a,b){this.columnIds[a]=b};this.getColIndexById=function(a){for(var b=0;b<this.columnIds.length;b++){if(this.columnIds[b]==a){return b}}};this.getColumnId=function(a){return this.columnIds[a]};this.getColLabel=this.getColumnLabel=function(a,b,c){for(var d=(c||this.hdr).rows[(b||0)+1],i=0;i<d.cells.length;i++){if(d.cells[i]._cellIndexS==a){return _isIE?d.cells[i].innerText:d.cells[i].textContent}}return""};this.getFooterLabel=function(a,b){return this.getColumnLabel(a,b,this.ftr)};this.setRowTextBold=function(a){var b=this.getRowById(a);if(b){b.style.fontWeight="bold"}};this.setRowTextStyle=function(a,b){var c=this.getRowById(a);if(c){for(var d=0;d<c.childNodes.length;d++){var i=c.childNodes[d]._attrs.style||"";this._hrrar&&this._hrrar[d]&&(i="display:none;");c.childNodes[d].style.cssText=i+"width:"+c.childNodes[d].style.width+";"+b}}};this.setRowColor=function(a,b){for(var c=this.getRowById(a),d=0;d<c.childNodes.length;d++){c.childNodes[d].bgColor=b}};this.setCellTextStyle=function(a,b,c){var d=this.getRowById(a);if(d){var i=d.childNodes[d._childIndexes?d._childIndexes[b]:b];if(i){var j="";this._hrrar&&this._hrrar[b]&&(j="display:none;");i.style.cssText=j+"width:"+i.style.width+";"+c}}};this.setRowTextNormal=function(a){var b=this.getRowById(a);if(b){b.style.fontWeight="normal"}};this.doesRowExist=function(a){return this.getRowById(a)!=null?!0:!1};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(a){var b=this.getRowById(a);if(this.isTreeGrid()){return this.moveRowUDTG(a,-1)}var c=this.rowsCol._dhx_find(b);if(b.previousSibling&&c!=0){b.parentNode.insertBefore(b,b.previousSibling);this.rowsCol._dhx_swapItems(c,c-1);this.setSizes();var d=this.rowsBuffer._dhx_find(b);this.rowsBuffer._dhx_swapItems(d,d-1);this._cssEven&&this._fixAlterCss(c-1)}};this.moveRowDown=function(a){var b=this.getRowById(a);if(this.isTreeGrid()){return this.moveRowUDTG(a,1)}var c=this.rowsCol._dhx_find(b);if(b.nextSibling){this.rowsCol._dhx_swapItems(c,c+1);b.nextSibling.nextSibling?b.parentNode.insertBefore(b,b.nextSibling.nextSibling):b.parentNode.appendChild(b);this.setSizes();var d=this.rowsBuffer._dhx_find(b);this.rowsBuffer._dhx_swapItems(d,d+1);this._cssEven&&this._fixAlterCss(c)}};this.getCombo=function(a){this.combos[a]||(this.combos[a]=new dhtmlXGridComboObject);return this.combos[a]};this.setUserData=function(a,b,c){a||(a="gridglobaluserdata");this.UserData[a]||(this.UserData[a]=new Hashtable);this.UserData[a].put(b,c)};this.getUserData=function(a,b){a||(a="gridglobaluserdata");this.getRowById(a);var c=this.UserData[a];return c?c.get(b):""};this.setEditable=function(a){this.isEditable=convertStringToBoolean(a)};this.selectRowById=function(a,b,c,d){d||(d=!1);this.selectCell(this.getRowById(a),0,d,b,!1,c)};this.clearSelection=function(){this.editStop();for(var a=0;a<this.selectedRows.length;a++){var b=this.rowsAr[this.selectedRows[a].idd];if(b){b.className=b.className.replace(/rowselected/g,"")}}this.selectedRows=dhtmlxArray();this.row=null;if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,""),this.cell=null}this.callEvent("onSelectionCleared",[])};this.copyRowContent=function(a,b){var c=this.getRowById(a);if(this.isTreeGrid()){this._copyTreeGridRowContent(c,a,b)}else{for(var d=0;d<c.cells.length;d++){this.cells(b,d).setValue(this.cells(a,d).getValue())}}if(!_isIE){this.getRowById(a).cells[0].height=c.cells[0].offsetHeight}};this.setFooterLabel=function(a,b,c){return this.setColumnLabel(a,b,c,this.ftr)};this.setColumnLabel=function(a,b,c,d){var i=(d||this.hdr).rows[c||1],j=i._childIndexes?i._childIndexes[a]:a;if(i.cells[j]){if(this.useImagesInHeader){i.cells[j].style.textAlign="left";i.cells[j].innerHTML="<img src='"+this.imgURL+""+b+"' onerror='this.src = \""+this.imgURL+"imageloaderror.gif\"'>";var k=new Image;k.src=this.imgURL+""+b.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=k;var l=new Image;l.src=this.imgURL+""+b.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=l}else{var m="<div class='hdrcell'>";if(b.indexOf("img:[")!=-1){var o=b.replace(/.*\[([^>]+)\].*/,"$1"),b=b.substr(b.indexOf("]")+1,b.length);m+="<img width='18px' height='18px' align='absmiddle' src='"+o+"' hspace='2'>"}m+=b;m+="</div>";i.cells[j].innerHTML=m;if(this._hstyles[j]){i.cells[j].style.cssText=this._hstyles[j]}}if((b||"").indexOf("#")!=-1){var n=b.match(/(^|{)#([^}]+)(}|$)/);if(n){var p="_in_header_"+n[2];if(this[p]){this[p](this.forceDivInHeader?i.cells[j].firstChild:i.cells[j],j,b.split(n[0]))}}}}};this.setColLabel=function(a,b,c,d){return this.setColumnLabel(a,b,(c||0)+1,d)};this.clearAll=function(a){if(this.obj.rows[0]){if(this._h2&&(this._h2=new dhtmlxHierarchy,this._fake)){this._realfake?this._h2=this._fake._h2:this._fake._h2=this._h2}this.limit=this._limitC=0;this.editStop(!0);this._dLoadTimer&&window.clearTimeout(this._dLoadTimer);if(this._dload){this.objBox.scrollTop=0,this.limit=this._limitC||0,this._initDrF=!0}for(var b=this.rowsCol.length,b=this.obj.rows.length,c=b-1;c>0;c--){var d=this.obj.rows[c];d.parentNode.removeChild(d)}if(a){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(c=this.hdr.rows.length-1;c>=0;c--){d=this.hdr.rows[c],d.parentNode.removeChild(d)}if(this.ftr){this.ftr.parentNode.removeChild(this.ftr),this.ftr=null}this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[];this._ivizcol=null}this.cell=this.row=null;this.rowsCol=dhtmlxArray();this.rowsAr={};this._RaSeCol=[];this.rowsBuffer=dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd){this.xmlFileUrl=""}this.pagingOn&&this.changePage(1);this._contextCallTimer&&window.clearTimeout(this._contextCallTimer);this._sst&&this.enableStableSorting(!0);this._fillers=this.undefined;this.setSortImgState(!1);this.setSizes();this.callEvent("onClearAll",[])}};this.sortField=function(a,b,c){if(this.getRowsNum()==0){return !1}var d=this.hdr.rows[0].cells[a];if(d&&d.tagName=="TH"&&this.fldSort.length-1>=d._cellIndex&&this.fldSort[d._cellIndex]!="na"){var i=this.getSortingState(),j=i[0]==a&&i[1]=="asc"?"des":"asc";if(this.callEvent("onBeforeSorting",[a,this.fldSort[a],j])){this.sortImg.src=this.imgURL+"sort_"+(j=="asc"?"asc":"desc")+".gif";if(this.useImagesInHeader){var k=this.hdr.rows[1].cells[d._cellIndex].firstChild;if(this.fldSorted!=null){var l=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;l.src=l.src.replace(/(\.asc\.)|(\.des\.)/,".")}k.src=k.src.replace(/(\.[a-z]+)$/,"."+j+"$1")}this.sortRows(d._cellIndex,this.fldSort[d._cellIndex],j);this.fldSorted=d;this.r_fldSorted=c;var m=this.hdr.rows[1],m=c.parentNode,o=m._childIndexes?m._childIndexes[d._cellIndex]:d._cellIndex;this.setSortImgPos(!1,!1,!1,c)}}};this.setCustomSorting=function(a,b){if(!this._customSorts){this._customSorts=[]}this._customSorts[b]=typeof a=="string"?eval(a):a;this.fldSort[b]="cus"};this.enableHeaderImages=function(a){this.useImagesInHeader=a};this.setHeader=function(a,b,c){for(var d=typeof a!="object"?this._eSplit(a):[].concat(a),i=[],j=new dhtmlxArray(0),k=[],l=[],m=[],o=0;o<d.length;o++){i[i.length]=Math.round(100/d.length),j[j.length]="ed",k[k.length]="left",l[l.length]="middle",m[m.length]="na"}this.splitSign=b||"#cspan";this.hdrLabels=d;this.cellWidth=i;this.initCellWidth.length||this.setInitWidthsP(i.join(this.delim),!0);this.cellType=j;this.cellAlign=k;this.cellVAlign=l;this.fldSort=m;this._hstyles=c||[]};this._eSplit=function(a){if(![].push){return a.split(this.delim)}var b="r"+(new Date).valueOf(),c=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(a||"").replace(RegExp(c,"g"),b).replace(RegExp("\\\\"+b,"g"),this.delim).split(b)};this.getColType=function(a){return this.cellType[a]};this.getColTypeById=function(a){return this.cellType[this.getColIndexById(a)]};this.setColTypes=function(a){this.cellType=dhtmlxArray(a.split(this.delim));this._strangeParams=[];for(var b=0;b<this.cellType.length;b++){if(this.cellType[b].indexOf("[")!=-1){var c=this.cellType[b].split(/[\[\]]+/g);this.cellType[b]=c[0];this.defVal[b]=c[1];c[1].indexOf("=")==0&&(this.cellType[b]="math",this._strangeParams[b]=c[0])}window["eXcell_"+this.cellType[b]]||dhtmlxError.throwError("Configuration","Incorrect cell type: "+this.cellType[b],[this,this.cellType[b]])}};this.setColSorting=function(a){this.fldSort=a.split(this.delim);for(var b=0;b<this.fldSort.length;b++){if(this.fldSort[b].length>4&&typeof window[this.fldSort[b]]=="function"){if(!this._customSorts){this._customSorts=[]}this._customSorts[b]=window[this.fldSort[b]];this.fldSort[b]="cus"}}};this.setColAlign=function(a){this.cellAlign=a.split(this.delim);for(var b=0;b<this.cellAlign.length;b++){this.cellAlign[b]=this.cellAlign[b]._dhx_trim()}};this.setColVAlign=function(a){this.cellVAlign=a.split(this.delim)};this.setNoHeader=function(a){this.noHeader=convertStringToBoolean(a)};this.showRow=function(a){this.getRowById(a);this._h2&&this.openItem(this._h2.get[a].parent.id);for(var b=this.getRowById(a).childNodes[0];b&&b.style.display=="none";){b=b.nextSibling}b&&this.moveToVisible(b,!0)};this.setStyle=function(a,b,c,d){this.ssModifier=[a,b,c,c,d];for(var i=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"],j=0;!_isIE;){try{var k=document.styleSheets[j].cssRules.length}catch(l){j++;continue}break}for(var m=0;m<i.length;m++){this.ssModifier[m]&&(_isIE?document.styleSheets[0].addRule(i[m],this.ssModifier[m]):document.styleSheets[j].insertRule(i[m]+(" { "+this.ssModifier[m]+" }"),document.styleSheets[j].cssRules.length))}};this.setColumnColor=function(a){this.columnColor=a.split(this.delim)};this.enableAlterCss=function(a,b,c,d){(a||b)&&this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();this._fake&&this._fake._fixAlterCss()});this._cssSP=c;this._cssSU=d;this._cssEven=a;this._cssUnEven=b};this._fixAlterCss=function(a){if(this._h2&&(this._cssSP||this._cssSU)){return this._fixAlterCssTGR(a)}if(this._cssEven||this._cssUnEven){for(var b=a=a||0,c=a;c<this.rowsCol.length;c++){if(this.rowsCol[c]&&this.rowsCol[c].style.display!="none"){this.rowsCol[c]._cntr?b=1:(this.rowsCol[c].className=this.rowsCol[c].className.indexOf("rowselected")!=-1?b%2==1?this._cssUnEven+" rowselected "+(this.rowsCol[c]._css||""):this._cssEven+" rowselected "+(this.rowsCol[c]._css||""):b%2==1?this._cssUnEven+" "+(this.rowsCol[c]._css||""):this._cssEven+" "+(this.rowsCol[c]._css||""),b++)}}}};this.clearChangedState=function(){for(var a=0;a<this.rowsCol.length;a++){for(var b=this.rowsCol[a],c=b.childNodes.length,d=0;d<c;d++){b.childNodes[d].wasChanged=!1}}};this.getChangedRows=function(a){var b=[];this.forEachRow(function(c){var d=this.rowsAr[c];if(d.tagName=="TR"){var i=d.childNodes.length;if(a&&d._added){b[b.length]=d.idd}else{for(var j=0;j<i;j++){if(d.childNodes[j].wasChanged){b[b.length]=d.idd;break}}}}});return b.join(this.delim)};this._sAll=this._sUDa=!1;this.setSerializationLevel=function(a,b,c,d,i,j){this._sUDa=a;this._sAll=b;this._sConfig=c;this._chAttr=d;this._onlChAttr=i;this._asCDATA=j};this.setSerializableColumns=function(a){if(a){this._srClmn=(a||"").split(",");for(var b=0;b<this._srClmn.length;b++){this._srClmn[b]=convertStringToBoolean(this._srClmn[b])}}else{this._srClmn=null}};this._serialise=function(){this.editStop();var a=[],b="</"+this.xml.s_row+">";if(this.isTreeGrid()){this._h2.forEachChildF(0,function(b){var c=this._serializeRow(this.render_row_tree(-1,b.id));a.push(c);return c?!0:!1},this,function(){a.push(b)})}else{for(var c=0;c<this.rowsBuffer.length;c++){if(this.rowsBuffer[c]){var d=this._serializeRow(this.render_row(c));a.push(d);d&&a.push(b)}}}return[a.join("")]};this._serializeRow=function(a,b){var c=[],d=this.xml.row_attrs,i=this.xml.cell_attrs;c.push("<"+this.xml.s_row);c.push(" id='"+a.idd+"'");this._sAll&&this.selectedRows._dhx_find(a)!=-1&&c.push(" selected='1'");this._h2&&this._h2.get[a.idd].state=="minus"&&c.push(" open='1'");if(d.length){for(b=0;b<d.length;b++){c.push(" "+d[b]+"='"+a._attrs[d[b]]+"'")}}c.push(">");if(this._sUDa&&this.UserData[a.idd]){keysAr=this.UserData[a.idd].getKeys();for(var j=0;j<keysAr.length;j++){c.push("<userdata name='"+keysAr[j]+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[a.idd].get(keysAr[j])+(this._asCDATA?"]]>":"")+"</userdata>")}}for(var k=!1,l=0;l<this._cCount;l++){if(!this._srClmn||this._srClmn[l]){var m=this.cells3(a,l);c.push("<cell");if(i.length){for(b=0;b<i.length;b++){c.push(" "+i[b]+"='"+m.cell._attrs[i[b]]+"'")}}zxVal=m[this._agetm]();this._asCDATA&&(zxVal="<![CDATA["+zxVal+"]]>");this._ecspn&&m.cell.colSpan&&m.cell.colSpan>1&&c.push(' colspan="'+m.cell.colSpan+'" ');this._chAttr?m.wasChanged()&&(c.push(' changed="1"'),k=!0):this._onlChAttr&&m.wasChanged()&&(k=!0);this._sAll&&this.cellType[l]=="tree"?c.push((this._h2?" image='"+this._h2.get[a.idd].image+"'":"")+">"+zxVal+"</cell>"):c.push(">"+zxVal+"</cell>");if(this._ecspn&&m.cell.colSpan){for(var o=0;o<m.cell.colSpan-1;o++){c.push("<cell/>"),l++}}}}return this._onlChAttr&&!k&&!a._added?"":c.join("")};this._serialiseConfig=function(){for(var a="<head>",b=0;b<this.hdr.rows[0].cells.length;b++){if(!this._srClmn||this._srClmn[b]){var c=this.fldSort[b];c=="cus"&&(c=this._customSorts[b].toString(),c=c.replace(/function[\ ]*/,"").replace(/\([^\f]*/,""));a+="<column width='"+this.getColWidth(b)+"' align='"+this.cellAlign[b]+"' type='"+this.cellType[b]+"' sort='"+(c||"na")+"' color='"+this.columnColor[b]+"'"+(this.columnIds[b]?" id='"+this.columnIds[b]+"'":"")+">";a+=this._asCDATA?"<![CDATA["+this.getHeaderCol(b)+"]]>":this.getHeaderCol(b);var d=this.getCombo(b);if(d){for(var i=0;i<d.keys.length;i++){a+="<option value='"+d.keys[i]+"'>"+d.values[i]+"</option>"}}a+="</column>"}}return a+="</head>"};this.serialize=function(){var a='<?xml version="1.0"?><rows>';this._agetm=this._mathSerialization?"getMathValue":"getValue";if(this._sUDa&&this.UserData.gridglobaluserdata){for(var b=this.UserData.gridglobaluserdata.getKeys(),c=0;c<b.length;c++){a+="<userdata name='"+b[c]+"'>"+this.UserData.gridglobaluserdata.get(b[c])+"</userdata>"}}this._sConfig&&(a+=this._serialiseConfig());a+=this._serialise();a+="</rows>";return a};this.getPosition=function(a,b){if(!b&&!_isChrome){var c=getOffset(a);return[c.left,c.top]}for(var b=b||document.body,d=a,i=0,j=0;d&&d!=b;){i+=d.offsetLeft-d.scrollLeft,j+=d.offsetTop-d.scrollTop,d=d.offsetParent}b==document.body&&(_isIE?(j+=document.body.offsetTop||document.documentElement.offsetTop,i+=document.body.offsetLeft||document.documentElement.offsetLeft):_isFF||(i+=document.body.offsetLeft,j+=document.body.offsetTop));return[i,j]};this.getFirstParentOfType=function(a,b){for(;a&&a.tagName!=b&&a.tagName!="BODY";){a=a.parentNode}return a};this.objBox.onscroll=function(){this.grid._doOnScroll()};if(!_isOpera||_OperaRv>8.5){this.hdr.onmousemove=function(a){this.grid.changeCursorState(a||window.event)},this.hdr.onmousedown=function(a){return this.grid.startColResize(a||window.event)}}this.obj.onmousemove=this._drawTooltip;this.objBox.onclick=function(a){(a||event).cancelBubble=!0};this.obj.onclick=function(a){this.grid._doClick(a||window.event);this.grid._sclE&&this.grid.editCell(a||window.event);(a||event).cancelBubble=!0};_isMacOS?this.entBox.oncontextmenu=function(a){a.cancelBubble=!0;a.returnValue=!1;return this.grid._doContClick(a||window.event)}:(this.entBox.onmousedown=function(a){return this.grid._doContClick(a||window.event)},this.entBox.oncontextmenu=function(a){if(this.grid._ctmndx){(a||event).cancelBubble=!0}return !this.grid._ctmndx});this.obj.ondblclick=function(a){if(!this.grid.wasDblClicked(a||window.event)){return !1}if(this.grid._dclE){var b=this.grid.getFirstParentOfType(_isIE?event.srcElement:a.target,"TR");b==this.grid.row&&this.grid.editCell(a||window.event)}(a||event).cancelBubble=!0;if(_isOpera){return !1}};this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){b._onHeaderClick.apply({grid:b},[null,b.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;if(!document.body._dhtmlxgrid_onkeydown){dhtmlxEvent(document,_isOpera?"keypress":"keydown",function(a){if(globalActiveDHTMLGridObject){return globalActiveDHTMLGridObject.doKey(a||window.event)}}),document.body._dhtmlxgrid_onkeydown=!0}dhtmlxEvent(document.body,"click",function(){b.editStop&&b.editStop();b.isActive&&b.setActive(!1)});this.entBox.onbeforeactivate=function(){this._still_active=null;this.grid.setActive();event.cancelBubble=!0};this.entBox.onbeforedeactivate=function(){this.grid._still_active?this.grid._still_active=null:this.grid.isActive=!1;event.cancelBubble=!0};if(this.entBox.style.height.toString().indexOf("%")!=-1){this._delta_y=this.entBox.style.height}if(this.entBox.style.width.toString().indexOf("%")!=-1){this._delta_x=this.entBox.style.width}(this._delta_x||this._delta_y)&&this._setAutoResize();this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;dhtmlx.image_path&&this.setImagePath(dhtmlx.image_path);dhtmlx.skin&&this.setSkin(dhtmlx.skin);return this}dhtmlXGridObject.prototype={getRowAttribute:function(A,C){return this.getRowById(A)._attrs[C]},setRowAttribute:function(C,D,A){this.getRowById(C)._attrs[D]=A},isTreeGrid:function(){return this.cellType._dhx_find("tree")!=-1},setRowHidden:function(C,H){var A=convertStringToBoolean(H),F=this.getRowById(C);if(F){F.expand===""&&this.collapseKids(F);if(H&&F.style.display!="none"){F.style.display="none";var E=this.selectedRows._dhx_find(F);if(E!=-1){F.className=F.className.replace("rowselected","");for(var D=0;D<F.childNodes.length;D++){F.childNodes[D].className=F.childNodes[D].className.replace(/cellselected/g,"")}this.selectedRows._dhx_removeAt(E)}this.callEvent("onGridReconstructed",[])}if(!H&&F.style.display=="none"){F.style.display="",this.callEvent("onGridReconstructed",[])}this.callEvent("onRowHide",[C,H]);this.setSizes()}},setColumnHidden:function(C,D){if(!this.hdr.rows.length){if(!this._ivizcol){this._ivizcol=[]}return this._ivizcol[C]=D}if(this.fldSorted&&this.fldSorted.cellIndex==C&&D){this.sortImg.style.display="none"}var A=convertStringToBoolean(D);if(A){if(this._hrrar){if(this._hrrar[C]){return }}else{this._hrrar=[]}this._hrrar[C]="display:none;";this._hideShowColumn(C,"none")}else{if(!this._hrrar||!this._hrrar[C]){return }this._hrrar[C]="";this._hideShowColumn(C,"")}if(this.fldSorted&&this.fldSorted.cellIndex==C&&!D){this.sortImg.style.display="inline"}this.setSortImgPos();this.callEvent("onColumnHidden",[C,D])},isColumnHidden:function(A){return this._hrrar&&this._hrrar[A]?!0:!1},setColumnsVisibility:function(A){if(A){this._ivizcol=A.split(this.delim)}if(this.hdr.rows.length&&this._ivizcol){for(var C=0;C<this._ivizcol.length;C++){this.setColumnHidden(C,this._ivizcol[C])}}},_fixHiddenRowsAll:function(K,I,J,H,F){for(var F=F||"_cellIndex",C=K.rows.length,D=0;D<C;D++){var E=K.rows[D].childNodes;if(E.length!=this._cCount){for(var A=0;A<E.length;A++){if(E[A][F]==I){E[A].style[J]=H;break}}}else{E[I].style[J]=H}}},_hideShowColumn:function(C,F){var A=C;this.hdr.rows[1]._childIndexes&&this.hdr.rows[1]._childIndexes[C]!=C&&(A=this.hdr.rows[1]._childIndexes[C]);if(F=="none"){this.hdr.rows[0].cells[C]._oldWidth=this.hdr.rows[0].cells[C].style.width||this.initCellWidth[C]+"px";this.hdr.rows[0].cells[C]._oldWidthP=this.cellWidthPC[C];this.obj.rows[0].cells[C].style.width="0px";var E={rows:[this.obj.rows[0]]};this.forEachRow(function(H){this.rowsAr[H].tagName=="TR"&&E.rows.push(this.rowsAr[H])});this._fixHiddenRowsAll(E,C,"display","none");this.isTreeGrid()&&this._fixHiddenRowsAllTG(C,"none");(_isOpera&&_OperaRv<9||_isKHTML||_isFF)&&this._fixHiddenRowsAll(this.hdr,C,"display","none","_cellIndexS");this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],C,"display","none");this._fixHiddenRowsAll(this.hdr,C,"whiteSpace","nowrap","_cellIndexS");if(!this.cellWidthPX.length&&!this.cellWidthPC.length){this.cellWidthPX=[].concat(this.initCellWidth)}this.cellWidthPX[C]&&(this.cellWidthPX[C]=0);this.cellWidthPC[C]&&(this.cellWidthPC[C]=0)}else{if(this.hdr.rows[0].cells[C]._oldWidth){var D=this.hdr.rows[0].cells[C];(_isOpera||_isKHTML||_isFF)&&this._fixHiddenRowsAll(this.hdr,C,"display","","_cellIndexS");this.ftr&&this._fixHiddenRowsAll(this.ftr.childNodes[0],C,"display","");E={rows:[this.obj.rows[0]]};this.forEachRow(function(H){this.rowsAr[H].tagName=="TR"&&E.rows.push(this.rowsAr[H])});this._fixHiddenRowsAll(E,C,"display","");this.isTreeGrid()&&this._fixHiddenRowsAllTG(C,"");this._fixHiddenRowsAll(this.hdr,C,"whiteSpace","normal","_cellIndexS");if(D._oldWidthP){this.cellWidthPC[C]=D._oldWidthP}D._oldWidth&&(this.cellWidthPX[C]=parseInt(D._oldWidth))}}this.setSizes();if(!_isIE&&!_isFF){this.obj.border=1,this.obj.border=0}},enableColSpan:function(A){this._ecspn=convertStringToBoolean(A)},enableRowsHover:function(A,C){this._unsetRowHover(!1,!0);this._hvrCss=C;if(convertStringToBoolean(A)){if(!this._elmnh){this.obj._honmousemove=this.obj.onmousemove,this.obj.onmousemove=this._setRowHover,_isIE?this.obj.onmouseleave=this._unsetRowHover:this.obj.onmouseout=this._unsetRowHover,this._elmnh=!0}}else{if(this._elmnh){this.obj.onmousemove=this.obj._honmousemove,_isIE?this.obj.onmouseleave=null:this.obj.onmouseout=null,this._elmnh=!1}}},enableEditEvents:function(C,D,A){this._sclE=convertStringToBoolean(C);this._dclE=convertStringToBoolean(D);this._f2kE=convertStringToBoolean(A)},enableLightMouseNavigation:function(A){if(convertStringToBoolean(A)){if(!this._elmn){this.entBox._onclick=this.entBox.onclick,this.entBox.onclick=function(){return !0},this.obj._onclick=this.obj.onclick,this.obj.onclick=function(D){var C=this.grid.getFirstParentOfType(D?D.target:event.srcElement,"TD");if(C){this.grid.editStop(),this.grid.doClick(C),this.grid.editCell(),(D||event).cancelBubble=!0}},this.obj._onmousemove=this.obj.onmousemove,this.obj.onmousemove=this._autoMoveSelect,this._elmn=!0}}else{if(this._elmn){this.entBox.onclick=this.entBox._onclick,this.obj.onclick=this.obj._onclick,this.obj.onmousemove=this.obj._onmousemove,this._elmn=!1}}},_unsetRowHover:function(C,D){that=D?this:this.grid;if(that._lahRw&&that._lahRw!=D){for(var A=0;A<that._lahRw.childNodes.length;A++){that._lahRw.childNodes[A].className=that._lahRw.childNodes[A].className.replace(that._hvrCss,"")}that._lahRw=null}},_setRowHover:function(C){var D=this.grid.getFirstParentOfType(C?C.target:event.srcElement,"TD");if(D&&D.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,D);D=D.parentNode;if(!D.idd||D.idd=="__filler__"){return }for(var A=0;A<D.childNodes.length;A++){D.childNodes[A].className+=" "+this.grid._hvrCss}this.grid._lahRw=D}this._honmousemove(C)},_autoMoveSelect:function(A){if(!this.grid.editor){var C=this.grid.getFirstParentOfType(A?A.target:event.srcElement,"TD");C.parentNode.idd&&this.grid.doClick(C,!0,0)}this._onmousemove(A)},enableDistributedParsing:function(C,D,A){convertStringToBoolean(C)?(this._ads_count=D||10,this._ads_time=A||250):this._ads_count=0},destructor:function(){this.editStop(!0);if(this._sizeTime){this._sizeTime=window.clearTimeout(this._sizeTime)}this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs){for(var C=0;C<this.formInputs.length;C++){this.parentForm.removeChild(this.formInputs[C])}}var D;this.xmlLoader=this.xmlLoader.destructor();for(C=0;C<this.rowsCol.length;C++){if(this.rowsCol[C]){this.rowsCol[C].grid=null}}for(C in this.rowsAr){this.rowsAr[C]&&(this.rowsAr[C]=null)}this.rowsCol=new dhtmlxArray;this.rowsAr={};this.entBox.innerHTML="";var A=function(){};this.setSizes=this._update_srnd_view=this.callEvent=this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=A;this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null;if(this._fake){this.globalBox.innerHTML="",this._fake.setSizes=this._fake._update_srnd_view=this._fake.callEvent=A,this.globalBox.onclick=this.globalBox.onmousedown=this.globalBox.onbeforeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onbeforedeactivate=this.globalBox.onselectstart=A}for(D in this){if(this[D]&&this[D].m_obj){this[D].m_obj=null}this[D]=null}this==globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject=null);return null},getSortingState:function(){var A=[];if(this.fldSorted){A[0]=this.fldSorted._cellIndex,A[1]=this.sortImg.src.indexOf("sort_desc.gif")!=-1?"des":"asc"}return A},enableAutoHeight:function(C,D,A){this._ahgr=convertStringToBoolean(C);this._ahgrF=convertStringToBoolean(A);this._ahgrM=D||null;if(arguments.length==1){this.objBox.style.overflowY=C?"hidden":"auto"}if(D=="auto"){this._ahgrM=null,this._ahgrMA=!0,this._setAutoResize()}},enableStableSorting:function(A){this._sst=convertStringToBoolean(A);this.rowsCol.stablesort=function(D){for(var C=this.length-1,H=0;H<this.length-1;H++){for(var F=0;F<C;F++){if(D(this[F],this[F+1])>0){var E=this[F];this[F]=this[F+1];this[F+1]=E}}C--}}},enableKeyboardSupport:function(A){this._htkebl=!convertStringToBoolean(A)},enableContextMenu:function(A){this._ctmndx=A},setScrollbarWidthCorrection:function(){},enableTooltips:function(A){this._enbTts=A.split(",");for(var C=0;C<this._enbTts.length;C++){this._enbTts[C]=convertStringToBoolean(this._enbTts[C])}},enableResizing:function(A){this._drsclmn=A.split(",");for(var C=0;C<this._drsclmn.length;C++){this._drsclmn[C]=convertStringToBoolean(this._drsclmn[C])}},setColumnMinWidth:function(A,C){if(arguments.length==2){if(!this._drsclmW){this._drsclmW=[]}this._drsclmW[C]=A}else{this._drsclmW=A.split(",")}},enableCellIds:function(A){this._enbCid=convertStringToBoolean(A)},lockRow:function(C,D){var A=this.getRowById(C);if(A){A._locked=convertStringToBoolean(D),this.cell&&this.cell.parentNode.idd==C&&this.editStop()}},_getRowArray:function(C){for(var E=[],A=0;A<C.childNodes.length;A++){var D=this.cells3(C,A);E[A]=D.getValue()}return E},setDateFormat:function(A,C){this._dtmask=A;this._dtmask_inc=C},setNumberFormat:function(K,I,J,H){var F=K.replace(/[^0\,\.]*/g,""),C=F.indexOf(".");C>-1&&(C=F.length-C-1);var D=F.indexOf(",");D>-1&&(D=F.length-C-2-D);if(typeof J!="string"){J=this.i18n.decimal_separator}if(typeof H!="string"){H=this.i18n.group_separator}var E=K.split(F)[0],A=K.split(F)[1];this._maskArr[I]=[C,D,E,A,J,H]},_aplNFb:function(C,E){var A=this._maskArr[E];if(!A){return C}var D=parseFloat(C.toString().replace(/[^0-9]*/g,""));C.toString().substr(0,1)=="-"&&(D*=-1);A[0]>0&&(D/=Math.pow(10,A[0]));return D},_aplNF:function(C,F){var A=this._maskArr[F];if(!A){return C}var E=(parseFloat(C)<0?"-":"")+A[2],C=Math.abs(Math.round(parseFloat(C)*Math.pow(10,A[0]>0?A[0]:0))).toString(),C=(C.length<A[0]?Math.pow(10,A[0]+1-C.length).toString().substr(1,A[0]+1)+C.toString():C).split("").reverse();C[A[0]]=(C[A[0]]||"0")+A[4];if(A[1]>0){for(var D=(A[0]>0?0:1)+A[0]+A[1];D<C.length;D+=A[1]){C[D]+=A[5]}}return E+C.reverse().join("")+A[3]},_launchCommands:function(C){for(var E=0;E<C.length;E++){for(var A=[],D=0;D<C[E].childNodes.length;D++){if(C[E].childNodes[D].nodeType==1){A[A.length]=C[E].childNodes[D].firstChild.data}}this[C[E].getAttribute("command")].apply(this,A)}},_parseHead:function(V){var T=this.xmlLoader.doXPath("./head",V);if(T.length){var U=this.xmlLoader.doXPath("./column",T[0]),S=this.xmlLoader.doXPath("./settings",T[0]),Q="setInitWidths",N=!1;if(S[0]){for(var O=0;O<S[0].childNodes.length;O++){switch(S[0].childNodes[O].tagName){case"colwidth":S[0].childNodes[O].firstChild&&S[0].childNodes[O].firstChild.data=="%"&&(Q="setInitWidthsP");break;case"splitat":N=S[0].childNodes[O].firstChild?S[0].childNodes[O].firstChild.data:!1}}}this._launchCommands(this.xmlLoader.doXPath("./beforeInit/call",T[0]));if(U.length>0){this.hdr.rows.length>0&&this.clearAll(!0);for(var P=[[],[],[],[],[],[],[],[],[]],M=",width,type,align,sort,color,format,hidden,id".split(","),L=["",Q,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"],K=0;K<U.length;K++){for(var J=1;J<M.length;J++){P[J].push(U[K].getAttribute(M[J]))}P[0].push((U[K].firstChild?U[K].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(P[0]);for(K=0;K<L.length;K++){if(L[K]){this[L[K]](P[K].join(this.delim))}}for(K=0;K<U.length;K++){if(this.cellType[K].indexOf("co")==0||this.cellType[K]=="clist"){var I=this.xmlLoader.doXPath("./option",U[K]);if(I.length){var F=[];if(this.cellType[K]=="clist"){for(J=0;J<I.length;J++){F[F.length]=I[J].firstChild?I[J].firstChild.data:""}this.registerCList(K,F)}else{for(var H=this.getCombo(K),J=0;J<I.length;J++){H.put(I[J].getAttribute("value"),I[J].firstChild?I[J].firstChild.data:"")}}}}else{P[6][K]&&(this.cellType[K].toLowerCase().indexOf("calendar")!=-1||this.fldSort[K]=="date"?this.setDateFormat(P[6][K]):this.setNumberFormat(P[6][K],K))}}this.init();var E=P[7].join(this.delim);this.setColHidden&&E.replace(/,/g,"")!=""&&this.setColHidden(E);N&&this.splitAt&&this.splitAt(N)}this._launchCommands(this.xmlLoader.doXPath("./afterInit/call",T[0]))}var D=this.xmlLoader.doXPath("//rows/userdata",V);if(D.length>0){this.UserData.gridglobaluserdata||(this.UserData.gridglobaluserdata=new Hashtable);for(J=0;J<D.length;J++){for(var A="",C=0;C<D[J].childNodes.length;C++){A+=D[J].childNodes[C].nodeValue}this.UserData.gridglobaluserdata.put(D[J].getAttribute("name"),A)}}},getCheckedRows:function(A){var C=[];this.forEachRowA(function(D){this.cells(D,A).getValue()!=0&&C.push(D)},!0);return C.join(",")},checkAll:function(){for(var A=arguments.length?arguments[0]:1,C=0;C<this.getColumnsNum();C++){this.getColType(C)=="ch"&&this.setCheckedRows(C,A)}},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(A,C){this.forEachRowA(function(D){this.cells(D,A).isCheckbox()&&this.cells(D,A).setValue(C)})},_drawTooltip:function(C){var F=this.grid.getFirstParentOfType(C?C.target:event.srcElement,"TD");if(!F||this.grid.editor&&this.grid.editor.cell==F){return !0}var A=F.parentNode;if(A.idd&&A.idd!="__filler__"){var E=C?C.target:event.srcElement;if(A.idd==window.unknown){return !0}if(!this.grid.callEvent("onMouseOver",[A.idd,F._cellIndex,C||window.event])){return !0}if(this.grid._enbTts&&!this.grid._enbTts[F._cellIndex]){if(E.title){E.title=""}return !0}if(!(F._cellIndex>=this.grid._cCount)){var D=this.grid.cells3(A,F._cellIndex);if(D&&D.cell&&D.cell._attrs){if(E._title){D.cell.title=""}if(!D.cell._attrs.title){E._title=!0}if(D){E.title=D.cell._attrs.title||(D.getTitle?D.getTitle():(D.getValue()||"").toString().replace(/<[^>]*>/gi,""))}return !0}}}},enableCellWidthCorrection:function(A){if(_isFF){this._wcorr=parseInt(A)}},getAllRowIds:function(C){for(var D=[],A=0;A<this.rowsBuffer.length;A++){this.rowsBuffer[A]&&D.push(this.rowsBuffer[A].idd)}return D.join(C||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(M,K,L){if(this._ecspn){var J=this.getRowById(M);if(J._childIndexes&&J.childNodes[J._childIndexes[K]]){var I=J._childIndexes[K],E=J.childNodes[I],F=E.colSpan;E.colSpan=1;if(F&&F!=1){for(var H=1;H<F;H++){var D=document.createElement("TD");E.nextSibling?J.insertBefore(D,E.nextSibling):J.appendChild(D);J._childIndexes[K+H]=I+H;D._cellIndex=K+H;D.style.textAlign=this.cellAlign[H];D.style.verticalAlign=this.cellVAlign[H];E=D;this.cells3(J,K+H).setValue("")}}for(var C=K*1+1*F;C<J._childIndexes.length;C++){J._childIndexes[C]+=(F-1)*1}}if(L&&L>1){if(J._childIndexes){I=J._childIndexes[K]}else{I=K;J._childIndexes=[];for(C=0;C<J.childNodes.length;C++){J._childIndexes[C]=C}}J.childNodes[I].colSpan=L;for(C=1;C<L;C++){J._childIndexes[J.childNodes[I+1]._cellIndex]=I,J.removeChild(J.childNodes[I+1])}for(var A=J.childNodes[J._childIndexes[K]]._cellIndex,C=A*1+1*L;C<J._childIndexes.length;C++){J._childIndexes[C]-=L-1}}}},preventIECaching:function(A){this.no_cashe=convertStringToBoolean(A);this.xmlLoader.rSeed=this.no_cashe},enableColumnAutoSize:function(A){this._eCAS=convertStringToBoolean(A)},_onHeaderDblClick:function(C){var D=this.grid,A=D.getFirstParentOfType(_isIE?event.srcElement:C.target,"TD");if(!D._eCAS){return !1}D.adjustColumnSize(A._cellIndexS)},adjustColumnSize:function(C,J){if(!this._hrrar||!this._hrrar[C]){this._notresize=!0;var A=0;this._setColumnSizeR(C,20);for(var I=1;I<this.hdr.rows.length;I++){var H=this.hdr.rows[I];if((H=H.childNodes[H._childIndexes?H._childIndexes[C]:C])&&(!H.colSpan||H.colSpan<2)&&H._cellIndex==C){H.childNodes[0]&&H.childNodes[0].className=="hdrcell"&&(H=H.childNodes[0]),A=Math.max(A,_isFF||_isOpera?H.textContent.length*this.fontWidth:H.scrollWidth)}}for(var D=this.obj.rows.length,E=1;E<D;E++){var F=this.obj.rows[E];this.rowsAr[F.idd]&&!(F._childIndexes&&F._childIndexes[C]!=C)&&F.childNodes[C]&&(F=_isFF||_isOpera||J?F.childNodes[C].textContent.length*this.fontWidth:F.childNodes[C].scrollWidth,F>A&&(A=F))}A+=20+(J||0);this._setColumnSizeR(C,A);this._notresize=!1;this.setSizes()}},detachHeader:function(C,D){var D=D||this.hdr,A=D.rows[C+1];A&&A.parentNode.removeChild(A);this.setSizes()},detachFooter:function(A){this.detachHeader(A,this.ftr)},attachHeader:function(C,E,A){typeof C=="string"&&(C=this._eSplit(C));typeof E=="string"&&(E=E.split(this.delim));A=A||"_aHead";if(this.hdr.rows.length){if(C){this._createHRow([C,E],this[A=="_aHead"?"hdr":"ftr"])}else{if(this[A]){for(var D=0;D<this[A].length;D++){this.attachHeader.apply(this,this[A][D])}}}}else{this[A]||(this[A]=[]),this[A][this[A].length]=[C,E,A]}},_createHRow:function(Q,O){if(!O){if(this.entBox.style.position!="absolute"){this.entBox.style.position="relative"}var P=document.createElement("DIV");P.className="ftr";this.entBox.appendChild(P);var N=document.createElement("TABLE");N.cellPadding=N.cellSpacing=0;if(!_isIE){N.width="100%",N.style.paddingRight="20px"}N.style.marginRight="20px";N.style.tableLayout="fixed";P.appendChild(N);N.appendChild(document.createElement("TBODY"));this.ftr=O=N;for(var M=N.insertRow(0),J=this.hdrLabels.length<=1?Q[0].length:this.hdrLabels.length,K=0;K<J;K++){M.appendChild(document.createElement("TH")),M.childNodes[K]._cellIndex=K}_isIE&&_isIE<8?M.style.position="absolute":M.style.height="auto"}var L=Q[1],P=document.createElement("TR");O.rows[0].parentNode.appendChild(P);for(K=0;K<Q[0].length;K++){if(Q[0][K]=="#cspan"){var I=P.cells[P.cells.length-1];I.colSpan=(I.colSpan||1)+1}else{if(Q[0][K]=="#rspan"&&O.rows.length>1){for(var H=O.rows.length-2,F=!1,I=null;!F;){for(var I=O.rows[H],E=0;E<I.cells.length;E++){if(I.cells[E]._cellIndex==K){F=E+1;break}}H--}I=I.cells[F-1];I.rowSpan=(I.rowSpan||1)+1}else{var D=document.createElement("TD");D._cellIndex=D._cellIndexS=K;if(this._hrrar&&this._hrrar[K]&&!_isIE){D.style.display="none"}if(typeof Q[0][K]=="object"){D.appendChild(Q[0][K])}else{if(D.innerHTML=this.forceDivInHeader?"<div class='hdrcell'>"+(Q[0][K]||"&nbsp;")+"</div>":Q[0][K]||"&nbsp;",(Q[0][K]||"").indexOf("#")!=-1){if(N=Q[0][K].match(/(^|{)#([^}]+)(}|$)/)){var A="_in_header_"+N[2];if(this[A]){this[A](this.forceDivInHeader?D.firstChild:D,K,Q[0][K].split(N[0]))}}}}if(L){D.style.cssText=L[K]}P.appendChild(D)}}}var C=O;if(_isKHTML){O._kTimer&&window.clearTimeout(O._kTimer),O._kTimer=window.setTimeout(function(){O.rows[1].style.display="none";window.setTimeout(function(){O.rows[1].style.display=""},1)},500)}},attachFooter:function(A,C){this.attachHeader(A,C,"_aFoot")},setCellExcellType:function(C,D,A){this.changeCellType(this.getRowById(C),D,A)},changeCellType:function(C,F,A){var A=A||this.cellType[F],E=this.cells3(C,F),D=E.getValue();E.cell._cellType=A;E=this.cells3(C,F);E.setValue(D)},setRowExcellType:function(C,E){for(var A=this.rowsAr[C],D=0;D<A.childNodes.length;D++){this.changeCellType(A,D,E)}},setColumnExcellType:function(C,D){for(var A=0;A<this.rowsBuffer.length;A++){this.rowsBuffer[A]&&this.rowsBuffer[A].tagName=="TR"&&this.changeCellType(this.rowsBuffer[A],C,D)}this.cellType[C]=="math"?this._strangeParams[A]=D:this.cellType[C]=D},forEachRow:function(A){for(var C in this.rowsAr){this.rowsAr[C]&&this.rowsAr[C].idd&&A.apply(this,[this.rowsAr[C].idd])}},forEachRowA:function(A){for(var C=0;C<this.rowsBuffer.length;C++){this.rowsBuffer[C]&&A.call(this,this.render_row(C).idd)}},forEachCell:function(C,E){var A=this.getRowById(C);if(A){for(var D=0;D<this._cCount;D++){E(this.cells3(A,D),D)}}},enableAutoWidth:function(C,D,A){this._awdth=[convertStringToBoolean(C),parseInt(D||99999),parseInt(A||0)];if(arguments.length==1){this.objBox.style.overflowX=C?"hidden":"auto"}},updateFromXML:function(C,E,A,D){typeof E=="undefined"&&(E=!0);this._refresh_mode=[!0,E,A];this.load(C,D)},_refreshFromXML:function(L){this._f_rowsBuffer&&this.filterBy(0,"");reset=!1;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(N){var M=this.grid._h2.get[this.cell.parentNode.idd];M&&this.cell.parentNode.valTag?this.setLabel(N):this.setValueX(N)}}var J=this.cellType._dhx_find("tree");L.getXMLTopNode("rows");var K=L.doXPath("//rows")[0].getAttribute("parent")||0,I={};this._refresh_mode[2]&&(J!=-1?this._h2.forEachChild(K,function(M){I[M.id]=!0},this):this.forEachRow(function(M){I[M]=!0}));for(var H=L.doXPath("//row"),D=0;D<H.length;D++){var E=H[D],F=E.getAttribute("id");I[F]=!1;K=E.parentNode.getAttribute("id")||K;if(this.rowsAr[F]&&this.rowsAr[F].tagName!="TR"){this._h2?this._h2.get[F].buff.data=E:this.rowsBuffer[this.getRowIndex(F)].data=E,this.rowsAr[F]=E}else{if(this.rowsAr[F]){this._process_xml_row(this.rowsAr[F],E,-1),this._postRowProcessing(this.rowsAr[F],!0)}else{if(this._refresh_mode[1]){var C={idd:F,data:E,_parser:this._process_xml_row,_locator:this._get_xml_data},A=this.rowsBuffer.length;this._refresh_mode[1]=="top"?(this.rowsBuffer.unshift(C),A=0):this.rowsBuffer.push(C);if(this._h2){reset=!0,this._h2.add(F,E.parentNode.getAttribute("id")||E.parentNode.getAttribute("parent")).buff=this.rowsBuffer[this.rowsBuffer.length-1]}this.rowsAr[F]=E;E=this.render_row(A);this._insertRowAt(E,A?-1:0)}}}}if(this._refresh_mode[2]){for(F in I){I[F]&&this.rowsAr[F]&&this.deleteRow(F)}}this._refresh_mode=null;if(window.eXcell_tree){eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX}reset&&this._renderSort();if(this._f_rowsBuffer){this._f_rowsBuffer=null,this.filterByAll()}},getCustomCombo:function(C,D){var A=this.cells(C,D).cell;if(!A._combo){A._combo=new dhtmlXGridComboObject}return A._combo},setTabOrder:function(C){var E=C.split(this.delim);this._tabOrder=[];for(var A=this._cCount||C.length,D=0;D<A;D++){E[D]={c:parseInt(E[D]),ind:D}}E.sort(function(H,F){return H.c>F.c?1:-1});for(D=0;D<A;D++){this._tabOrder[E[D].ind]=!E[D+1]||typeof E[D].c=="undefined"?(E[0].ind+1)*-1:E[D+1].ind}},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var A=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[A+1],this.cell._cellIndex,!0)},k13_0_1:function(){var A=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[A-1],this.cell._cellIndex,!0)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[this.row?this.row.idd:null,this.cell?this.cell._cellIndex:null]);this._still_active=!0},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[!0])){return !0}var A=this._getNextCell(null,1);if(A){this.selectCell(A.parentNode,A._cellIndex,this.row!=A.parentNode,!1,!0),this._still_active=!0}},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[!1])){return !1}var A=this._getNextCell(null,-1);if(A){this.selectCell(A.parentNode,A._cellIndex,this.row!=A.parentNode,!1,!0),this._still_active=!0}},k113_0_0:function(){this._f2kE&&this.editCell()},k32_0_0:function(){var A=this.cells4(this.cell);if(!A.changeState||A.changeState()===!1){return !1}},k27_0_0:function(){this.editStop(!0)},k33_0_0:function(){this.pagingOn?this.changePage(this.currentPage-1):this.scrollPage(-1)},k34_0_0:function(){this.pagingOn?this.changePage(this.currentPage+1):this.scrollPage(1)},k37_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.collapseKids(this.row)}else{return !1}},k39_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.expandKids(this.row)}else{return !1}},k40_0_0:function(){var A=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftNext()}else{if(!this.row.idd){return }var C=Math.max(A._r_select||0,this.getRowIndex(this.row.idd))+1;if(this.rowsBuffer[C]){A._r_select=null,this.selectCell(C,this.cell._cellIndex,!0),A.pagingOn&&A.showRow(A.getRowId(C))}else{if(!this.callEvent("onLastRow",[])){return !1}this._key_events.k34_0_0.apply(this,[]);this.pagingOn&&this.rowsCol[C]&&this.selectCell(C,0,!0)}}this._still_active=!0},k38_0_0:function(){var C=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftPrev()}else{if(!this.row.idd){return }var D=this.getRowIndex(this.row.idd)+1;if(D!=-1&&(!this.pagingOn||D!=1)){var A=this._nextRow(D-1,-1);this.selectCell(A,this.cell._cellIndex,!0);C.pagingOn&&A&&C.showRow(A.idd)}else{this._key_events.k33_0_0.apply(this,[])}}this._still_active=!0}},_build_master_row:function(){for(var C=document.createElement("DIV"),D=["<table><tr>"],A=0;A<this._cCount;A++){D.push("<td></td>")}D.push("</tr></table>");C.innerHTML=D.join("");this._master_row=C.firstChild.rows[0]},_prepareRow:function(C){this._master_row||this._build_master_row();for(var D=this._master_row.cloneNode(!0),A=0;A<D.childNodes.length;A++){D.childNodes[A]._cellIndex=A;if(this._enbCid){D.childNodes[A].id="c_"+C+"_"+A}this.dragAndDropOff&&this.dragger.addDraggableItem(D.childNodes[A],this)}D.idd=C;D.grid=this;return D},_process_jsarray_row:function(C,D){C._attrs={};for(var A=0;A<C.childNodes.length;A++){C.childNodes[A]._attrs={}}this._fillRow(C,this._c_order?this._swapColumns(D):D);return C},_get_jsarray_data:function(A,C){return A[C]},_process_json_row:function(C,D){C._attrs={};for(var A=0;A<C.childNodes.length;A++){C.childNodes[A]._attrs={}}this._fillRow(C,this._c_order?this._swapColumns(D.data):D.data);return C},_get_json_data:function(A,C){return A.data[C]},_process_csv_row:function(C,D){C._attrs={};for(var A=0;A<C.childNodes.length;A++){C.childNodes[A]._attrs={}}this._fillRow(C,this._c_order?this._swapColumns(D.split(this.csv.cell)):D.split(this.csv.cell));return C},_get_csv_data:function(A,C){return A.split(this.csv.cell)[C]},_process_store_row:function(C,F){for(var A=[],E=0;E<this.columnIds.length;E++){A[E]=F[this.columnIds[E]]}for(var D=0;D<C.childNodes.length;D++){C.childNodes[D]._attrs={}}C._attrs=F;this._fillRow(C,this._c_order?this._swapColumns(A):A)},_process_xml_row:function(M,K){var L=this.xmlLoader.doXPath(this.xml.cell,K),J=[];M._attrs=this._xml_attrs(K);if(this._ud_enabled){for(var I=this.xmlLoader.doXPath("./userdata",K),E=I.length-1;E>=0;E--){for(var F="",H=0;H<I[E].childNodes.length;H++){F+=I[E].childNodes[H].nodeValue}this.setUserData(M.idd,I[E].getAttribute("name"),F)}}for(H=0;H<L.length;H++){var D=L[this._c_order?this._c_order[H]:H];if(D){var C=M._childIndexes?M._childIndexes[H]:H,A=D.getAttribute("type");if(M.childNodes[C]){if(A){M.childNodes[C]._cellType=A}M.childNodes[C]._attrs=this._xml_attrs(D)}D.getAttribute("xmlcontent")||(D=D.firstChild?D.firstChild.data:"");J.push(D)}}for(;H<M.childNodes.length;H++){M.childNodes[H]._attrs={}}M.parentNode&&M.parentNode.tagName=="row"&&(M._attrs.parent=M.parentNode.getAttribute("idd"));this._fillRow(M,J);return M},_get_xml_data:function(A,C){for(A=A.firstChild;;){if(!A){return""}A.tagName=="cell"&&C--;if(C<0){break}A=A.nextSibling}return A.firstChild?A.firstChild.data:""},_fillRow:function(C,H){this.editor&&this.editStop();for(var A=0;A<C.childNodes.length;A++){if(A<H.length||this.defVal[A]){var F=C.childNodes[A]._cellIndex,E=H[F],D=this.cells4(C.childNodes[A]);if(this.defVal[F]&&(E==""||typeof E=="undefined")){E=this.defVal[F]}D&&D.setValue(E)}else{C.childNodes[A].innerHTML="&nbsp;",C.childNodes[A]._clearCell=!0}}return C},_postRowProcessing:function(C,J){if(C._attrs["class"]){C._css=C.className=C._attrs["class"]}if(C._attrs.locked){C._locked=!0}if(C._attrs.bgColor){C.bgColor=C._attrs.bgColor}for(var A=0,I=0;I<C.childNodes.length;I++){var H=C.childNodes[I],D=H._cellIndex,E=H._attrs.style||C._attrs.style;E&&(H.style.cssText+=";"+E);if(H._attrs["class"]){H.className=H._attrs["class"]}if(E=H._attrs.align||this.cellAlign[D]){H.align=E}H.vAlign=H._attrs.valign||this.cellVAlign[D];var F=H._attrs.bgColor||this.columnColor[D];if(F){H.bgColor=F}H._attrs.colspan&&!J&&(this.setColspan(C.idd,I+A,H._attrs.colspan),A+=H._attrs.colspan-1);if(this._hrrar&&this._hrrar[D]&&!J){H.style.display="none"}}this.callEvent("onRowCreated",[C.idd,C,null])},load:function(C,D,A){this.callEvent("onXLS",[this]);arguments.length==2&&typeof D!="function"&&(A=D,D=null);A=A||"xml";if(!this.xmlFileUrl){this.xmlFileUrl=C}this._data_type=A;this.xmlLoader.onloadAction=function(E,J,F,H,I){E.callEvent&&(I=E["_process_"+A](I),E._contextCallTimer||E.callEvent("onXLE",[E,0,0,I]),D&&(D(),D=null))};this.xmlLoader.loadXML(C)},loadXMLString:function(C,D){var A=new dtmlXMLLoaderObject(function(){});A.loadXMLString(C);this.parse(A,D,"xml")},loadXML:function(A,C){this.load(A,C,"xml")},parse:function(C,D,A){arguments.length==2&&typeof D!="function"&&(A=D,D=null);this._data_type=A=A||"xml";C=this["_process_"+A](C);this._contextCallTimer||this.callEvent("onXLE",[this,0,0,C]);D&&D()},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(C){var D={};if(C.attributes.length){for(var A=0;A<C.attributes.length;A++){D[C.attributes[A].name]=C.attributes[A].value}}return D},_process_xml:function(L){if(!L.doXPath){var J=new dtmlXMLLoaderObject(function(){});typeof L=="string"?J.loadXMLString(L):(J.xmlDoc=L.responseXML?L:{},J.xmlDoc.responseXML=L);L=J}if(this._refresh_mode){return this._refreshFromXML(L)}this._parsing=!0;var K=L.getXMLTopNode(this.xml.top);if(K.tagName.toLowerCase()==this.xml.top){this._parseHead(K);var I=L.doXPath(this.xml.row,K),H=parseInt(L.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),D=parseInt(L.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0),E=!1;D&&(this.rowsBuffer[D-1]||(this.rowsBuffer.length&&(E=!0),this.rowsBuffer[D-1]=null),D<this.rowsBuffer.length&&(this.rowsBuffer.splice(D,this.rowsBuffer.length-D),E=!0));if(this.isTreeGrid()){return this._process_tree_xml(L)}for(var F=0;F<I.length;F++){if(!this.rowsBuffer[F+H]){var C=I[F].getAttribute("id")||F+H+1;this.rowsBuffer[F+H]={idd:C,data:I[F],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[C]=I[F]}}if(E&&this._srnd){var A=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=A}else{this.render_dataset()}this._parsing=!1;return L.xmlDoc.responseXML?L.xmlDoc.responseXML:L.xmlDoc}},_process_jsarray:function(a){this._parsing=!0;if(a&&a.xmlDoc){eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp}for(var c=0;c<a.length;c++){var b=c+1;this.rowsBuffer.push({idd:b,data:a[c],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[b]=a[c]}this.render_dataset();this._parsing=!1},_process_csv:function(C){this._parsing=!0;if(C.xmlDoc){C=C.xmlDoc.responseText}C=C.replace(/\r/g,"");C=C.split(this.csv.row);if(this._csvHdr){this.clearAll();var F=C.splice(0,1)[0].split(this.csv.cell);this._csvAID||F.splice(0,1);this.setHeader(F.join(this.delim));this.init()}for(var A=0;A<C.length;A++){if(C[A]||A!=C.length-1){if(this._csvAID){var E=A+1;this.rowsBuffer.push({idd:E,data:C[A],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var D=C[A].split(this.csv.cell),E=D.splice(0,1)[0];this.rowsBuffer.push({idd:E,data:D,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[E]=C[A]}}this.render_dataset();this._parsing=!1},_process_json:function(a){this._parsing=!0;if(a&&a.xmlDoc){eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp}for(var c=0;c<a.rows.length;c++){var b=a.rows[c].id;this.rowsBuffer.push({idd:b,data:a.rows[c],_parser:this._process_json_row,_locator:this._get_json_data});this.rowsAr[b]=a[c]}this.render_dataset();this._parsing=!1},render_dataset:function(C,F){if(this._srnd){if(this._fillers){return this._update_srnd_view()}F=Math.min(this._get_view_size()+(this._srnd_pr||0),this.rowsBuffer.length)}this.pagingOn?(C=Math.max(C||0,(this.currentPage-1)*this.rowsBufferOutSize),F=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)):(C=C||0,F=F||this.rowsBuffer.length);for(var A=C;A<F;A++){var E=this.render_row(A);if(E==-1){if(this.xmlFileUrl&&this.callEvent("onDynXLS",[A,this._dpref?this._dpref:F-A])){this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+A+"&count="+(this._dpref?this._dpref:F-A),this._data_type)}F=A;break}if(!E.parentNode||!E.parentNode.tagName){if(this._insertRowAt(E,A),E._attrs.selected||E._attrs.select){this.selectRow(E,E._attrs.call?!0:!1,!0),E._attrs.selected=E._attrs.select=null}}if(this._ads_count&&A-C==this._ads_count){var D=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){D._contextCallTimer=null;D.render_dataset(A,F);if(!D._contextCallTimer){D._context_parsing?D.callEvent("onXLE",[]):D._fixAlterCss(),D.callEvent("onDistributedEnd",[]),D._context_parsing=!1}},this._ads_time)}}if(this._srnd&&!this._fillers){this._fillers=[this._add_filler(F,this.rowsBuffer.length-F)]}this.setSizes()},render_row:function(C){if(!this.rowsBuffer[C]){return -1}if(this.rowsBuffer[C]._parser){var D=this.rowsBuffer[C];if(this.rowsAr[D.idd]&&this.rowsAr[D.idd].tagName=="TR"){return this.rowsBuffer[C]=this.rowsAr[D.idd]}var A=this._prepareRow(D.idd);this.rowsBuffer[C]=A;this.rowsAr[D.idd]=A;D._parser.call(this,A,D.data);this._postRowProcessing(A);return A}return this.rowsBuffer[C]},_get_cell_value:function(C,D,A){return C._locator?(this._c_order&&(D=this._c_order[D]),C._locator.call(this,C.data,D)):this.cells3(C,D)[A?A:"getValue"]()},sortRows:function(C,I,A){A=(A||"asc").toLowerCase();I=I||this.fldSort[C];C=C||0;if(this.isTreeGrid()){this.sortTreeRows(C,I,A)}else{var H={},F=this.cellType[C],D="getValue";F=="link"&&(D="getContent");if(F=="dhxCalendar"||F=="dhxCalendarA"){D="getDate"}for(var E=0;E<this.rowsBuffer.length;E++){H[this.rowsBuffer[E].idd]=this._get_cell_value(this.rowsBuffer[E],C,D)}this._sortRows(C,I,A,H)}this.callEvent("onAfterSorting",[C,I,A])},_sortCore:function(C,I,A,H,F){var D="sort";if(this._sst){F.stablesort=this.rowsCol.stablesort,D="stablesort"}I.length>4&&(I=window[I]);if(I=="cus"){var E=this._customSorts[C];F[D](function(J,K){return E(H[J.idd],H[K.idd],A,J.idd,K.idd)})}else{if(typeof I=="function"){F[D](function(J,K){return I(H[J.idd],H[K.idd],A,J.idd,K.idd)})}else{if(I=="str"){F[D](function(J,K){return A=="asc"?H[J.idd]>H[K.idd]?1:-1:H[J.idd]<H[K.idd]?1:-1})}else{if(I=="int"){F[D](function(J,M){var L=parseFloat(H[J.idd]),L=isNaN(L)?-99999999999999:L,K=parseFloat(H[M.idd]),K=isNaN(K)?-99999999999999:K;return A=="asc"?L-K:K-L})}else{if(I=="date"){F[D](function(J,M){var L=Date.parse(H[J.idd])||Date.parse("01/01/1900"),K=Date.parse(H[M.idd])||Date.parse("01/01/1900");return A=="asc"?L-K:K-L})}}}}}},_sortRows:function(C,E,A,D){this._sortCore(C,E,A,D,this.rowsBuffer);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(C){if(this.obj.rows[0]){this.callEvent("onResetView",[]);var E=this.obj.rows[0].parentNode,A=E.removeChild(E.childNodes[0],!0);if(_isKHTML){for(var D=E.parentNode.childNodes.length-1;D>=0;D--){E.parentNode.childNodes[D].tagName=="TR"&&E.parentNode.removeChild(E.parentNode.childNodes[D],!0)}}else{if(_isIE){for(D=E.childNodes.length-1;D>=0;D--){E.childNodes[D].removeNode(!0)}}else{E.innerHTML=""}}E.appendChild(A);this.rowsCol=dhtmlxArray();this._sst&&this.enableStableSorting(!0);this._fillers=this.undefined;C||this.render_dataset()}},deleteRow:function(C,H){H||(H=this.getRowById(C));if(H){this.editStop();if(!this._realfake&&this.callEvent("onBeforeRowDeleted",[C])==!1){return !1}var A=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake){A=this._h2.get[C].parent.id,this._removeTrGrRow(H)}else{H.parentNode&&H.parentNode.removeChild(H);var F=this.rowsCol._dhx_find(H);F!=-1&&this.rowsCol._dhx_removeAt(F);for(var E=0;E<this.rowsBuffer.length;E++){if(this.rowsBuffer[E]&&this.rowsBuffer[E].idd==C){this.rowsBuffer._dhx_removeAt(E);F=E;break}}}this.rowsAr[C]=null;for(E=0;E<this.selectedRows.length;E++){this.selectedRows[E].idd==C&&this.selectedRows._dhx_removeAt(E)}if(this._srnd){for(E=0;E<this._fillers.length;E++){var D=this._fillers[E];D&&(D[0]>=F?D[0]-=1:D[1]>=F&&(D[1]-=1))}this._update_srnd_view()}this.pagingOn&&this.changePage();this._realfake||this.callEvent("onAfterRowDeleted",[C,A]);this.callEvent("onGridReconstructed",[]);this._ahgr&&this.setSizes();return !0}},_addRow:function(C,J,A){if(A==-1||typeof A=="undefined"){A=this.rowsBuffer.length}typeof J=="string"&&(J=J.split(this.delim));var I=this._prepareRow(C);I._attrs={};for(var H=0;H<I.childNodes.length;H++){I.childNodes[H]._attrs={}}this.rowsAr[I.idd]=I;if(this._h2){this._h2.get[I.idd].buff=I}this._fillRow(I,J);this._postRowProcessing(I);if(this._skipInsert){return this._skipInsert=!1,this.rowsAr[I.idd]=I}if(this.pagingOn){return this.rowsBuffer._dhx_insertAt(A,I),this.rowsAr[I.idd]=I}if(this._fillers){this.rowsCol._dhx_insertAt(A,null);this.rowsBuffer._dhx_insertAt(A,I);this._fake&&this._fake.rowsCol._dhx_insertAt(A,null);this.rowsAr[I.idd]=I;for(var D=!1,E=0;E<this._fillers.length;E++){var F=this._fillers[E];if(F&&F[0]<=A&&F[0]+F[1]>=A){F[1]+=1,F[2].firstChild.style.height=parseInt(F[2].firstChild.style.height)+this._srdh+"px",D=!0,this._fake&&this._fake._fillers[E][1]++}F&&F[0]>A&&(F[0]+=1,this._fake&&this._fake._fillers[E][0]++)}D||this._fillers.push(this._add_filler(A,1,A==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:this.rowsCol[1]}:this.rowsCol[A-1],!0));return I}this.rowsBuffer._dhx_insertAt(A,I);return this._insertRowAt(I,A)},addRow:function(C,E,A){var D=this._addRow(C,E,A);this.dragContext||this.callEvent("onRowAdded",[C]);this.pagingOn&&this.changePage(this.currentPage);this._srnd&&this._update_srnd_view();D._added=!0;this._ahgr&&this.setSizes();this.callEvent("onGridReconstructed",[]);return D},_insertRowAt:function(C,D,A){this.rowsAr[C.idd]=C;if(this._skipInsert){return this._skipInsert=!1,C}if(D<0||!D&&parseInt(D)!==0){D=this.rowsCol.length}else{if(D>this.rowsCol.length){D=this.rowsCol.length}}this._cssEven&&(C.className+=(this._cssSP?this.getLevel(C.idd):D)%2==1?" "+this._cssUnEven+(this._cssSU?" "+this._cssUnEven+"_"+this.getLevel(C.idd):""):" "+this._cssEven+(this._cssSU?" "+this._cssEven+"_"+this.getLevel(C.idd):""));A||(D==this.obj.rows.length-1||!this.rowsCol[D]?_isKHTML?this.obj.appendChild(C):this.obj.firstChild.appendChild(C):this.rowsCol[D].parentNode.insertBefore(C,this.rowsCol[D]));this.rowsCol._dhx_insertAt(D,C);this.callEvent("onRowInserted",[C,D]);return C},getRowById:function(C){var D=this.rowsAr[C];if(D){if(D.tagName!="TR"){for(var A=0;A<this.rowsBuffer.length;A++){if(this.rowsBuffer[A]&&this.rowsBuffer[A].idd==C){return this.render_row(A)}}if(this._h2){return this.render_row(null,D.idd)}}return D}return null},cellById:function(A,C){return this.cells(A,C)},cells:function(C,E){if(arguments.length==0){return this.cells4(this.cell)}else{var A=this.getRowById(C)}var D=A._childIndexes?A.childNodes[A._childIndexes[E]]:A.childNodes[E];return this.cells4(D)},cellByIndex:function(A,C){return this.cells2(A,C)},cells2:function(C,E){var A=this.render_row(C),D=A._childIndexes?A.childNodes[A._childIndexes[E]]:A.childNodes[E];return this.cells4(D)},cells3:function(C,D){var A=C._childIndexes?C.childNodes[C._childIndexes[D]]:C.childNodes[D];return this.cells4(A)},cells4:function(A){var C=window["eXcell_"+(A._cellType||this.cellType[A._cellIndex])];if(C){return new C(A)}},cells5:function(C,D){D=D||C._cellType||this.cellType[C._cellIndex];if(!this._ecache[D]){var A=window["eXcell_"+D]?window["eXcell_"+D]:eXcell_ro;this._ecache[D]=new A(C)}this._ecache[D].cell=C;return this._ecache[D]},dma:function(A){if(!this._ecache){this._ecache={}}if(A&&!this._dma){this._dma=this.cells4,this.cells4=this.cells5}else{if(!A&&this._dma){this.cells4=this._dma,this._dma=null}}},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(A){this.smartTabOrder=arguments.length>0?convertStringToBoolean(A):!0},setExternalTabOrder:function(C,D){var A=this;this.tabStart=typeof C=="object"?C:document.getElementById(C);this.tabStart.onkeydown=function(E){var F=E||window.event;if(F.keyCode==9){return F.cancelBubble=!0,A.selectCell(0,0,0,0,1),A.smartTabOrder&&A.cells2(0,0).isDisabled()&&A._key_events.k9_0_0.call(A),this.blur(),!1}};if(_isOpera){this.tabStart.onkeypress=this.tabStart.onkeydown}this.tabEnd=typeof D=="object"?D:document.getElementById(D);this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(E){var F=E||window.event;if(F.keyCode==9&&F.shiftKey){return F.cancelBubble=!0,A.selectCell(A.getRowsNum()-1,A.getColumnCount()-1,0,0,1),A.smartTabOrder&&A.cells2(A.getRowsNum()-1,A.getColumnCount()-1).isDisabled()&&A._key_events.k9_0_1.call(A),this.blur(),!1}};if(_isOpera){this.tabEnd.onkeypress=this.tabEnd.onkeydown}},uid:function(){if(!this._ui_seed){this._ui_seed=(new Date).valueOf()}return this._ui_seed++},clearAndLoad:function(){var A=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=A;this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var A=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,A,Math.min(A+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}};(function(){function C(J,I){this[J]=I}function H(J,I){this[J].call(this,I)}function A(J,I){this[J].call(this,I.join(this.delim))}function F(J,I){for(var M=0;M<I.length;M++){if(typeof I[M]=="object"){var L=this.getCombo(M),K;for(K in I[M]){L.put(K,I[M][K])}}}}function E(Q,P){function O(T,S,U){M[S]||(M[S]=[]);if(typeof U=="object"){U.toString=function(){return this.text}}M[S][T]=U}for(var N=1,M=[],L=0;L<P.length;L++){if(typeof P[L]=="object"&&P[L].length){for(var K=0;K<P[L].length;K++){O(L,K,P[L][K])}}else{O(L,0,P[L])}}for(L=0;L<M.length;L++){for(K=0;K<M[0].length;K++){var I=M[L][K];M[L][K]=(I||"").toString()||"&nbsp;";if(I&&I.colspan){for(var J=1;J<I.colspan;J++){O(K+J,L,"#cspan")}}if(I&&I.rowspan){for(J=1;J<I.rowspan;J++){O(K,L+J,"#rspan")}}}}this.setHeader(M[0]);for(L=1;L<M.length;L++){this.attachHeader(M[L])}}var D=[{name:"label",def:"&nbsp;",operation:"setHeader",type:E},{name:"id",def:"",operation:"columnIds",type:C},{name:"width",def:"*",operation:"setInitWidths",type:A},{name:"align",def:"left",operation:"cellAlign",type:C},{name:"valign",def:"middle",operation:"cellVAlign",type:C},{name:"sort",def:"na",operation:"fldSort",type:C},{name:"type",def:"ro",operation:"setColTypes",type:A},{name:"options",def:"",operation:"",type:F}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(I){return[I.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(J){for(var I=0;I<D.length;I++){for(var M=[],L=0;L<J.length;L++){M[L]=J[L][D[I].name]||D[I].def}var K=D[I].type||H;K.call(this,D[I].operation,M,J)}this.init()},rows:function(){},headers:function(J){for(var I=0;I<J.length;I++){this.attachHeader(J[I])}}})})();dhtmlXGridObject.prototype._dp_init=function(A){A.attachEvent("insertCallback",function(D,C){this.obj._h2?this.obj.addRow(C,E,null,parent):this.obj.addRow(C,[],0);var E=this.obj.getRowById(C);E&&(this.obj._process_xml_row(E,D.firstChild),this.obj._postRowProcessing(E))});A.attachEvent("updateCallback",function(D,C){var E=this.obj.getRowById(C);E&&(this.obj._process_xml_row(E,D.firstChild),this.obj._postRowProcessing(E))});A.attachEvent("deleteCallback",function(D,C){this.obj.setUserData(C,this.action_param,"true_deleted");this.obj.deleteRow(C)});A._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(F,C,E){if(A._columns&&!A._columns[E]){return !0}var D=this.cells(C,E);F==1?D.isCheckbox()&&A.setUpdated(C,!0):F==2&&D.wasChanged()&&A.setUpdated(C,!0);return !0});this.attachEvent("onRowPaste",function(C){A.setUpdated(C,!0)});this.attachEvent("onRowIdChange",function(E,C){var D=A.findRow(E);D<A.updatedRows.length&&(A.updatedRows[D]=C)});this.attachEvent("onSelectStateChanged",function(){A.updateMode=="row"&&A.sendData();return !0});this.attachEvent("onEnter",function(){A.updateMode=="row"&&A.sendData();return !0});this.attachEvent("onBeforeRowDeleted",function(D){if(!this.rowsAr[D]){return !0}if(this.dragContext&&A.dnd){return window.setTimeout(function(){A.setUpdated(D,!0)},1),!0}var C=A.getState(D);this._h2&&this._h2.forEachChild(D,function(E){A.setUpdated(E.id,!1);A.markRow(E.id,!0,"deleted")},this);if(C=="inserted"){return A.set_invalid(D,!1),A.setUpdated(D,!1),!0}if(C=="deleted"){return !1}if(C=="true_deleted"){return A.setUpdated(D,!1),!0}A.setUpdated(D,!0,"deleted");return !1});this.attachEvent("onBindUpdate",function(C){A.setUpdated(C,!0)});this.attachEvent("onRowAdded",function(C){if(this.dragContext&&A.dnd){return !0}A.setUpdated(C,!0,"inserted");return !0});A._getRowData=function(D){var C=[];C.gr_id=D;this.obj.isTreeGrid()&&(C.gr_pid=this.obj.getParentId(D));for(var K=this.obj.getRowById(D),J=0;J<this.obj._cCount;J++){var F=this.obj._c_order?this.obj._c_order[J]:J,H=this.obj.cells(K.idd,J);if(!this._changed||H.wasChanged()){this._endnm?C[this.obj.getColumnId(J)]=H.getValue():C["c"+F]=H.getValue()}}var I=this.obj.UserData[D];if(I){for(var E=0;E<I.keys.length;E++){I.keys[E].indexOf("__")!=0&&(C[I.keys[E]]=I.values[E])}}if(I=this.obj.UserData.gridglobaluserdata){for(E=0;E<I.keys.length;E++){C[I.keys[E]]=I.values[E]}}return C};A._clearUpdateFlag=function(D){var C=this.obj.getRowById(D);if(C){for(var E=0;E<this.obj._cCount;E++){this.obj.cells(D,E).cell.wasChanged=!1}}};A.checkBeforeUpdate=function(D){for(var C=!0,H=[],F=0;F<this.obj._cCount;F++){if(this.mandatoryFields[F]){var E=this.mandatoryFields[F].call(this.obj,this.obj.cells(D,F).getValue(),D,F);typeof E=="string"?(this.messages.push(E),C=!1):(C&=E,H[F]=!E)}}C||(this.set_invalid(D,"invalid",H),this.setUpdated(D,!1));return C}};function dhtmlXGridCellObject(A){this.destructor=function(){return this.base=this.grid=this.cell=this.cell.obj=null};this.cell=A;this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell.innerHTML._dhx_trim()};this.getMathValue=function(){return this.cell.original?this.cell.original:this.getValue()};this.getFont=function(){arOut=Array(3);if(this.cell.style.fontFamily){arOut[0]=this.cell.style.fontFamily}if(this.cell.style.fontWeight=="bold"||this.cell.parentNode.style.fontWeight=="bold"){arOut[1]="bold"}if(this.cell.style.fontStyle=="italic"||this.cell.parentNode.style.fontWeight=="italic"){arOut[1]+="italic"}arOut[2]=this.cell.style.fontSize?this.cell.style.fontSize:"";return arOut.join("-")};this.getTextColor=function(){return this.cell.style.color?this.cell.style.color:"#000000"};this.getBgColor=function(){return this.cell.bgColor?this.cell.bgColor:"#FFFFFF"};this.getHorAlign=function(){return this.cell.style.textAlign?this.cell.style.textAlign:this.cell.style.textAlign?this.cell.style.textAlign:"left"};this.getWidth=function(){return this.cell.scrollWidth};this.setFont=function(C){fntAr=C.split("-");this.cell.style.fontFamily=fntAr[0];this.cell.style.fontSize=fntAr[fntAr.length-1];if(fntAr.length==3){if(/bold/.test(fntAr[1])){this.cell.style.fontWeight="bold"}if(/italic/.test(fntAr[1])){this.cell.style.fontStyle="italic"}if(/underline/.test(fntAr[1])){this.cell.style.textDecoration="underline"}}};this.setTextColor=function(C){this.cell.style.color=C};this.setBgColor=function(C){C==""&&(C=null);this.cell.bgColor=C};this.setHorAlign=function(C){this.cell.style.textAlign=C.length==1?C=="c"?"center":C=="l"?"left":"right":C};this.wasChanged=function(){return this.cell.wasChanged?!0:!1};this.isCheckbox=function(){var C=this.cell.firstChild;return C&&C.tagName=="INPUT"?(type=C.type,type=="radio"||type=="checkbox"?!0:!1):!1};this.isChecked=function(){if(this.isCheckbox()){return this.cell.firstChild.checked}};this.isDisabled=function(){return this.cell._disabled};this.setChecked=function(C){if(this.isCheckbox()){C!="true"&&C!=1&&(C=!1),this.cell.firstChild.checked=C}};this.setDisabled=function(C){C!="true"&&C!=1&&(C=!1);if(this.isCheckbox()){this.cell.firstChild.disabled=C,this.disabledF&&this.disabledF(C)}this.cell._disabled=C}}dhtmlXGridCellObject.prototype={getAttribute:function(A){return this.cell._attrs[A]},setAttribute:function(A,C){this.cell._attrs[A]=C},getInput:function(){if(this.obj&&(this.obj.tagName=="INPUT"||this.obj.tagName=="TEXTAREA")){return this.obj}var A=(this.obj||this.cell).getElementsByTagName("TEXTAREA");A.length||(A=(this.obj||this.cell).getElementsByTagName("INPUT"));return A[0]}};dhtmlXGridCellObject.prototype.setValue=function(A){typeof A!="number"&&(!A||A.toString()._dhx_trim()=="")?(A="&nbsp;",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCValue(A)};dhtmlXGridCellObject.prototype.getTitle=function(){return _isIE?this.cell.innerText:this.cell.textContent};dhtmlXGridCellObject.prototype.setCValue=function(A,C){this.cell.innerHTML=A;this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,arguments.length>1?C:A])};dhtmlXGridCellObject.prototype.setCTxtValue=function(A){this.cell.innerHTML="";this.cell.appendChild(document.createTextNode(A));this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,A])};dhtmlXGridCellObject.prototype.setLabel=function(A){this.cell.innerHTML=A};dhtmlXGridCellObject.prototype.getMath=function(){return this._val?this.val:this.getValue()};function eXcell(){this.val=this.obj=null;this.changeState=function(){return !1};this.edit=function(){this.val=this.getValue()};this.detach=function(){return !1};this.getPosition=function(C){for(var E=C,A=0,D=0;E.tagName!="BODY";){A+=E.offsetLeft,D+=E.offsetTop,E=E.offsetParent}return[A,D]}}eXcell.prototype=new dhtmlXGridCellObject;function eXcell_ed(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid}this.edit=function(){this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.setAttribute("autocomplete","off");this.obj.style.height=this.cell.offsetHeight-(_isIE?4:4)+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(C){(C||event).cancelBubble=!0};this.obj.onmousedown=function(C){(C||event).cancelBubble=!0};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);if(_isFF&&!window._KHTMLrv&&(this.obj.style.overflow="visible",this.grid.multiLine&&this.obj.offsetHeight>=18&&this.obj.offsetHeight<40)){this.obj.style.height="36px",this.obj.style.overflow="scroll"}this.obj.onselectstart=function(C){C||(C=event);return C.cancelBubble=!0};_isIE&&this.obj.focus();this.obj.focus()};this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_ed.prototype=new eXcell;function eXcell_edtxt(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid}this.getValue=function(){return this.cell.firstChild&&this.cell.atag&&this.cell.firstChild.tagName==this.cell.atag?this.cell.firstChild.value:this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(C){!C||C.toString()._dhx_trim()==""?(C=" ",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCTxtValue(C)}}eXcell_edtxt.prototype=new eXcell_ed;function eXcell_edn(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid}this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell._clearCell?"":this.cell._orig_value||this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)};this.detach=function(){var C=this.obj.value;this.setValue(C);return this.val!=this.getValue()}}eXcell_edn.prototype=new eXcell_ed;eXcell_edn.prototype.setValue=function(A){if(!A||A.toString()._dhx_trim()==""){return this.cell._clearCell=!0,this.setCValue("&nbsp;",0)}else{this.cell._clearCell=!1,this.cell._orig_value=A}this.setCValue(this.grid._aplNF(A,this.cell._cellIndex),A)};function eXcell_ch(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid}this.disabledF=function(C){this.cell.innerHTML=C==!0||C==1?this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis."):this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")};this.changeState=function(C){C===!0&&!this.grid.isActive&&(window.globalActiveDHTMLGridObject!=null&&window.globalActiveDHTMLGridObject!=this.grid&&window.globalActiveDHTMLGridObject.isActive&&window.globalActiveDHTMLGridObject.setActive(!1),this.grid.setActive(!0));if(this.grid.isEditable&&!this.cell.parentNode._locked&&!this.isDisabled()){this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])?(this.val=this.getValue(),this.val=="1"?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"])):this.editor=null}};this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"};this.isCheckbox=function(){return !0};this.isChecked=function(){return this.getValue()=="1"?!0:!1};this.setChecked=function(C){this.setValue(C.toString())};this.detach=function(){return this.val!=this.getValue()};this.edit=null}eXcell_ch.prototype=new eXcell;eXcell_ch.prototype.setValue=function(A){this.cell.style.verticalAlign="middle";if(A&&(A=A.toString()._dhx_trim(),A=="false"||A=="0")){A=""}A?(A="1",this.cell.chstate="1"):(A="0",this.cell.chstate="0");var C=this;this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+A+".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)};function eXcell_ra(A){this.base=eXcell_ch;this.base(A);this.grid=A.parentNode.grid;this.disabledF=function(C){this.cell.innerHTML=C==!0||C==1?this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis."):this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")};this.changeState=function(C){if(!(C===!1&&this.getValue()==1)&&this.grid.isEditable&&!this.cell.parentNode._locked){this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])!=!1?(this.val=this.getValue(),this.val=="1"?this.setValue("0"):this.setValue("1"),this.cell.wasChanged=!0,this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]),this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"]),this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,this.val!="1"])):this.editor=null}};this.edit=null}eXcell_ra.prototype=new eXcell_ch;eXcell_ra.prototype.setValue=function(A){this.cell.style.verticalAlign="middle";if(A&&(A=A.toString()._dhx_trim(),A=="false"||A=="0")){A=""}if(A){if(!this.grid._RaSeCol){this.grid._RaSeCol=[]}if(this.grid._RaSeCol[this.cell._cellIndex]){var C=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);C.setValue("0");this.grid.rowsAr[C.cell.parentNode.idd]&&this.grid.callEvent("onEditCell",[1,C.cell.parentNode.idd,C.cell._cellIndex])}this.grid._RaSeCol[this.cell._cellIndex]=this.cell;A="1";this.cell.chstate="1"}else{A="0",this.cell.chstate="0"}this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+A+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)};function eXcell_txt(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_textarea";this.obj.onclick=function(F){(F||event).cancelBubble=!0};var D=this.grid.getPosition(this.cell);this.obj.value=this.val;this.obj.style.display="";this.obj.style.textAlign=this.cell.style.textAlign;if(_isFF){var C=document.createElement("DIV");C.appendChild(this.obj);C.style.overflow="auto";C.className="dhx_textarea";this.obj.style.margin="0px 0px 0px 0px";this.obj.style.border="0px";this.obj=C}document.body.appendChild(this.obj);if(_isOpera){this.obj.onkeypress=function(F){if(F.keyCode==9){return !1}}}this.obj.onkeydown=function(H){var F=H||event;if(F.keyCode==9){return globalActiveDHTMLGridObject.entBox.focus(),globalActiveDHTMLGridObject.doKey({keyCode:F.keyCode,shiftKey:F.shiftKey,srcElement:"0"}),!1}};this.obj.style.left=D[0]+"px";this.obj.style.top=D[1]+this.cell.offsetHeight+"px";var E=this.cell.offsetWidth<200?200:this.cell.offsetWidth;this.obj.style.width=E+(_isFF?18:16)+"px";if(_isFF){this.obj.firstChild.style.width=parseInt(this.obj.style.width)+"px",this.obj.firstChild.style.height=this.obj.offsetHeight-3+"px"}if(_isIE){this.obj.select(),this.obj.value=this.obj.value}_isFF?this.obj.firstChild.focus():this.obj.focus()};this.detach=function(){var C="",C=_isFF?this.obj.firstChild.value:this.obj.value;this.cell._clearCell=C==""?!0:!1;this.setValue(C);document.body.removeChild(this.obj);this.obj=null;return this.val!=this.getValue()};this.getValue=function(){return this.obj?_isFF?this.obj.firstChild.value:this.obj.value:this.cell._clearCell?"":this.grid.multiLine?this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim():this.cell._brval||this.cell.innerHTML}}eXcell_txt.prototype=new eXcell;function eXcell_txttxt(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid}this.getValue=function(){return this.cell.firstChild&&this.cell.firstChild.tagName=="TEXTAREA"?this.cell.firstChild.value:this.cell._clearCell?"":!this.grid.multiLine&&this.cell._brval?this.cell._brval:_isIE?this.cell.innerText:this.cell.textContent};this.setValue=function(C){this.cell._brval=C;!C||C.toString()._dhx_trim()==""?(C=" ",this.cell._clearCell=!0):this.cell._clearCell=!1;this.setCTxtValue(C)}}eXcell_txttxt.prototype=new eXcell_txt;eXcell_txt.prototype.setValue=function(A){!A||A.toString()._dhx_trim()==""?(A="&nbsp;",this.cell._clearCell=!0):this.cell._clearCell=!1;this.cell._brval=A;this.grid.multiLine?this.setCValue(A.replace(/\n/g,"<br/>"),A):this.setCValue(A,A)};function eXcell_co(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid,this.combo=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),this.editable=!0}this.shiftNext=function(){var C=this.list.options[this.list.selectedIndex+1];if(C){C.selected=!0}this.obj.value=this.list.options[this.list.selectedIndex].text;return !0};this.shiftPrev=function(){if(this.list.selectedIndex!=0){var C=this.list.options[this.list.selectedIndex-1];if(C){C.selected=!0}this.obj.value=this.list.options[this.list.selectedIndex].text}return !0};this.edit=function(){this.val=this.getValue();this.text=this.getText()._dhx_trim();var D=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=this.cell.offsetHeight-4+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(K){(K||event).cancelBubble=!0};this.obj.onmousedown=function(K){(K||event).cancelBubble=!0};this.obj.value=this.text;this.obj.onselectstart=function(K){K||(K=event);return K.cancelBubble=!0};var C=this;this.obj.onkeyup=function(K){var O=(K||event).keyCode;if(!(O==38||O==40||O==9)){for(var N=this.readonly?String.fromCharCode(O):this.value,M=C.list.options,L=0;L<M.length;L++){if(M[L].text.indexOf(N)==0){return M[L].selected=!0}}}};this.list=document.createElement("SELECT");this.list.className="dhx_combo_select";this.list.style.width=this.cell.offsetWidth+"px";this.list.style.left=D[0]+"px";this.list.style.top=D[1]+this.cell.offsetHeight+"px";this.list.onclick=function(K){var M=K||window.event,L=M.target||M.srcElement;if(L.tagName=="OPTION"){L=L.parentNode}C.editable=!1;C.grid.editStop();M.cancelBubble=!0};for(var J=this.combo.getKeys(),I=!1,E=0,F=0;F<J.length;F++){var H=this.combo.get(J[F]);this.list.options[this.list.options.length]=new Option(H,J[F]);J[F]==this.val&&(E=this.list.options.length-1,I=!0)}I==!1&&(this.list.options[this.list.options.length]=new Option(this.text,this.val===null?"":this.val),E=this.list.options.length-1);document.body.appendChild(this.list);this.list.size="6";this.cstate=1;this.editable?this.cell.innerHTML="":(this.obj.style.width="1px",this.obj.style.height="1px");this.cell.appendChild(this.obj);this.list.options[E].selected=!0;if(!_isFF||this.editable){this.obj.focus(),this.obj.focus()}if(!this.editable){this.obj.style.visibility="hidden",this.list.focus(),this.list.onkeydown=function(K){K=K||window.event;C.grid.setActive(!0);if(K.keyCode<30){return C.grid.doKey({target:C.cell,keyCode:K.keyCode,shiftKey:K.shiftKey,ctrlKey:K.ctrlKey})}}}};this.getValue=function(){return this.cell.combo_value==window.undefined?"":this.cell.combo_value};this.detach=function(){if(this.val!=this.getValue()){this.cell.wasChanged=!0}if(this.list.parentNode!=null){if(this.editable){var D=this.list.options[this.list.selectedIndex];if(D&&D.text==this.obj.value){this.setValue(this.list.value)}else{var C=this.cell._combo||this.grid.getCombo(this.cell._cellIndex),E=C.values._dhx_find(this.obj.value);E!=-1?this.setValue(C.keys[E]):this.setCValue(this.cell.combo_value=this.obj.value)}}else{this.setValue(this.list.value)}}this.list.parentNode&&this.list.parentNode.removeChild(this.list);this.obj.parentNode&&this.obj.parentNode.removeChild(this.obj);return this.val!=this.getValue()}}eXcell_co.prototype=new eXcell;eXcell_co.prototype.getText=function(){return this.cell.innerHTML};eXcell_co.prototype.setValue=function(C){if(typeof C=="object"){var E=this.grid.xmlLoader.doXPath("./option",C);if(E.length){this.cell._combo=new dhtmlXGridComboObject}for(var A=0;A<E.length;A++){this.cell._combo.put(E[A].getAttribute("value"),E[A].firstChild?E[A].firstChild.data:"")}C=C.firstChild.data}if((C||"").toString()._dhx_trim()==""){C=null}this.cell.combo_value=C;if(C!==null){var D=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(C);this.setCValue(D===null?C:D,C)}else{this.setCValue("&nbsp;",C)}};function eXcell_coro(A){this.base=eXcell_co;this.base(A);this.editable=!1}eXcell_coro.prototype=new eXcell_co;function eXcell_cotxt(A){this.base=eXcell_co;this.base(A)}eXcell_cotxt.prototype=new eXcell_co;eXcell_cotxt.prototype.getText=function(){return _isIE?this.cell.innerText:this.cell.textContent};eXcell_cotxt.prototype.setValue=function(C){if(typeof C=="object"){var D=this.grid.xmlLoader.doXPath("./option",C);if(D.length){this.cell._combo=new dhtmlXGridComboObject}for(var A=0;A<D.length;A++){this.cell._combo.put(D[A].getAttribute("value"),D[A].firstChild?D[A].firstChild.data:"")}C=C.firstChild.data}if((C||"").toString()._dhx_trim()==""){C=null}C!==null?this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(C)||C,C):this.setCTxtValue(" ",C);this.cell.combo_value=C};function eXcell_corotxt(A){this.base=eXcell_co;this.base(A);this.editable=!1}eXcell_corotxt.prototype=new eXcell_cotxt;function eXcell_cp(A){try{this.cell=A,this.grid=this.cell.parentNode.grid}catch(C){}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("SPAN");this.obj.style.border="1px solid black";this.obj.style.position="absolute";var D=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj);document.body.appendChild(this.obj);this.obj.style.left=D[0]+"px";this.obj.style.zIndex=1;this.obj.style.top=D[1]+this.cell.offsetHeight+"px"};this.toolDNum=function(D){D.length==1&&(D="0"+D);return D};this.colorPanel=function(N,M){var L=document.createElement("TABLE");M.appendChild(L);L.cellSpacing=0;L.editor_obj=this;L.style.cursor="default";L.onclick=function(P){var O=P||window.event,S=O.target||O.srcElement,Q=S.parentNode.parentNode.parentNode.editor_obj;Q.setValue(S._bg);Q.grid.editStop()};for(var I=256/N,J=0;J<=256/I;J++){for(var K=L.insertRow(J),H=0;H<=256/I;H++){for(var F=0;F<=256/I;F++){R=new Number(I*J)-(J==0?0:1);G=new Number(I*H)-(H==0?0:1);B=new Number(I*F)-(F==0?0:1);var E=this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+""+this.toolDNum(B.toString(16)),D=K.insertCell(H);D.width="10px";D.innerHTML="&nbsp;";D.title=E.toUpperCase();D.style.backgroundColor="#"+E;D._bg="#"+E;if(this.val!=null&&"#"+E.toUpperCase()==this.val.toUpperCase()){D.style.border="2px solid white"}}}}};this.getValue=function(){return this.cell.firstChild._bg||""};this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))};this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,2),16))};this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))};this.detach=function(){this.obj.offsetParent!=null&&document.body.removeChild(this.obj);return this.val!=this.getValue()}}eXcell_cp.prototype=new eXcell;eXcell_cp.prototype.setValue=function(A){this.setCValue("<div style='width:100%;height:"+(this.grid.multiLine?this.cell.offsetHeight-2:16)+";background-color:"+(A||"")+";border:0px;'>&nbsp;</div>",A);this.cell.firstChild._bg=A};function eXcell_img(A){try{this.cell=A,this.grid=this.cell.parentNode.grid}catch(C){}this.getValue=function(){if(this.cell.firstChild.tagName=="IMG"){return this.cell.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"")}else{if(this.cell.firstChild.tagName=="A"){var D=this.cell.firstChild.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");D+="^"+this.cell.lnk;this.cell.trg&&(D+="^"+this.cell.trg);return D}}};this.isDisabled=function(){return !0}}eXcell_img.prototype=new eXcell;eXcell_img.prototype.getTitle=function(){return this.cell._brval};eXcell_img.prototype.setValue=function(C){var D=C;if(C.indexOf("^")!=-1){var A=C.split("^"),C=A[0],D=this.cell._attrs.title||A[1];if(A.length>2&&(this.cell.lnk=A[2],A[3])){this.cell.trg=A[3]}this.cell.titFl="1"}this.setCValue("<img src='"+this.grid.iconURL+(C||"")._dhx_trim()+"' border='0'>",C);if(this.cell.lnk){this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>"}this.cell._brval=D};function eXcell_price(A){this.base=eXcell_ed;this.base(A);this.getValue=function(){return this.cell.childNodes.length>1?this.cell.childNodes[1].innerHTML.toString()._dhx_trim():"0"}}eXcell_price.prototype=new eXcell_ed;eXcell_price.prototype.setValue=function(A){isNaN(parseFloat(A))&&(A=this.val||0);var C="green";A<0&&(C="red");this.setCValue("<span>$</span><span style='padding-right:2px;color:"+C+";'>"+A+"</span>",A)};function eXcell_dyn(A){this.base=eXcell_ed;this.base(A);this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}eXcell_dyn.prototype=new eXcell_ed;eXcell_dyn.prototype.setValue=function(C){if(!C||isNaN(Number(C))){C!==""&&(C=0)}if(C>0){var D="green",A="dyn_up.gif"}else{C==0?(D="black",A="dyn_.gif"):(D="red",A="dyn_down.gif")}this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='"+this.grid.imgURL+""+A+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:"+D+";'>"+C+"</span></div>",C)};function eXcell_ro(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid}this.edit=function(){};this.isDisabled=function(){return !0};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}eXcell_ro.prototype=new eXcell;function eXcell_ron(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return !0};this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)}}eXcell_ron.prototype=new eXcell;eXcell_ron.prototype.setValue=function(A){if(A!==0&&(!A||A.toString()._dhx_trim()=="")){return this.setCValue("&nbsp;"),this.cell._clearCell=!0}this.cell._clearCell=!1;this.setCValue(A?this.grid._aplNF(A,this.cell._cellIndex):"0")};function eXcell_rotxt(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return !0};this.setValue=function(C){C?this.cell._clearCell=!1:(C=" ",this.cell._clearCell=!0);this.setCTxtValue(C)};this.getValue=function(){return this.cell._clearCell?"":_isIE?this.cell.innerText:this.cell.textContent}}eXcell_rotxt.prototype=new eXcell;function dhtmlXGridComboObject(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray;this.put=function(C,D){for(var A=0;A<this.keys.length;A++){if(this.keys[A]==C){return this.values[A]=D,!0}}this.values[this.values.length]=D;this.keys[this.keys.length]=C};this.get=function(A){for(var C=0;C<this.keys.length;C++){if(this.keys[C]==A){return this.values[C]}}return null};this.clear=function(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray};this.remove=function(A){for(var C=0;C<this.keys.length;C++){if(this.keys[C]==A){return this.keys._dhx_removeAt(C),this.values._dhx_removeAt(C),!0}}};this.size=function(){for(var A=0,C=0;C<this.keys.length;C++){this.keys[C]!=null&&A++}return A};this.getKeys=function(){for(var A=[],C=0;C<this.keys.length;C++){this.keys[C]!=null&&(A[A.length]=this.keys[C])}return A};this.save=function(){this._save=[];for(var A=0;A<this.keys.length;A++){this._save[A]=[this.keys[A],this.values[A]]}};this.restore=function(){if(this._save){this.keys[A]=[];this.values[A]=[];for(var A=0;A<this._save.length;A++){this.keys[A]=this._save[A][0],this.values[A]=this._save[A][1]}}};return this}function Hashtable(){this.keys=new dhtmlxArray;this.values=new dhtmlxArray;return this}Hashtable.prototype=new dhtmlXGridComboObject;dhtmlXGridObject.prototype._process_json_row=function(C,F){C._attrs=F;for(var A=0;A<C.childNodes.length;A++){C.childNodes[A]._attrs={}}if(F.userdata){for(var E in F.userdata){this.setUserData(C.idd,E,F.userdata[E])}}for(var D=0;D<F.data.length;D++){if(typeof F.data[D]=="object"&&F.data[D]!=null){C.childNodes[D]._attrs=F.data[D];if(F.data[D].type){C.childNodes[D]._cellType=F.data[D].type}F.data[D]=F.data[D].value}}this._fillRow(C,this._c_order?this._swapColumns(F.data):F.data);return C};dhtmlXGridObject.prototype.updateFromJSON=function(C,E,A,D){typeof E=="undefined"&&(E=!0);this._refresh_mode=[!0,E,A];this.load(C,D,"json")};dhtmlXGridObject.prototype._refreshFromJSON=function(L){this._f_rowsBuffer&&this.filterBy(0,"");reset=!1;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue,eXcell_tree.prototype.setValue=function(N){var M=this.grid._h2.get[this.cell.parentNode.idd];M&&this.cell.parentNode.valTag?this.setLabel(N):this.setValueX(N)}}var J=this.cellType._dhx_find("tree"),K=L.parent||0,I={};this._refresh_mode[2]&&(J!=-1?this._h2.forEachChild(K,function(M){I[M.id]=!0},this):this.forEachRow(function(M){I[M]=!0}));for(var H=L.rows,D=0;D<H.length;D++){var E=H[D],F=E.id;I[F]=!1;if(this.rowsAr[F]&&this.rowsAr[F].tagName!="TR"){this._h2?this._h2.get[F].buff.data=E:this.rowsBuffer[this.getRowIndex(F)].data=E,this.rowsAr[F]=E}else{if(this.rowsAr[F]){this._process_json_row(this.rowsAr[F],E,-1),this._postRowProcessing(this.rowsAr[F],!0)}else{if(this._refresh_mode[1]){var C={idd:F,data:E,_parser:this._process_json_row,_locator:this._get_json_data},A=this.rowsBuffer.length;this._refresh_mode[1]=="top"?(this.rowsBuffer.unshift(C),A=0):this.rowsBuffer.push(C);if(this._h2){reset=!0,this._h2.add(F,K).buff=this.rowsBuffer[this.rowsBuffer.length-1]}this.rowsAr[F]=E;E=this.render_row(A);this._insertRowAt(E,A?-1:0)}}}}if(this._refresh_mode[2]){for(F in I){I[F]&&this.rowsAr[F]&&this.deleteRow(F)}}this._refresh_mode=null;if(window.eXcell_tree){eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX}reset&&this._renderSort();if(this._f_rowsBuffer){this._f_rowsBuffer=null,this.filterByAll()}};dhtmlXGridObject.prototype._process_json=function(a){this._parsing=!0;try{if(a&&a.xmlDoc){eval("dhtmlx.temp="+a.xmlDoc.responseText+";"),a=dhtmlx.temp}else{if(typeof a=="string"){eval("dhtmlx.temp="+a+";"),a=dhtmlx.temp}}}catch(c){dhtmlxError.throwError("LoadXML","Incorrect JSON",[a.xmlDoc||a,this]),a={rows:[]}}if(this._refresh_mode){return this._refreshFromJSON(a)}var b=parseInt(a.pos||0),d=parseInt(a.total_count||0),e=!1;d&&(this.rowsBuffer[d-1]||(this.rowsBuffer.length&&(e=!0),this.rowsBuffer[d-1]=null),d<this.rowsBuffer.length&&(this.rowsBuffer.splice(d,this.rowsBuffer.length-d),e=!0));for(var h in a){h!="rows"&&this.setUserData("",h,a[h])}if(this.isTreeGrid()){return this._process_tree_json(a)}for(var g=0;g<a.rows.length;g++){if(!this.rowsBuffer[g+b]){var f=a.rows[g].id;this.rowsBuffer[g+b]={idd:f,data:a.rows[g],_parser:this._process_json_row,_locator:this._get_json_data};this.rowsAr[f]=a.rows[g]}}if(e&&this._srnd){var i=this.objBox.scrollTop;this._reset_view();this.objBox.scrollTop=i}else{this.render_dataset()}this._parsing=!1};dhtmlXGridObject.prototype._get_json_data=function(A,C){return typeof A.data[C]=="object"?A.data[C].value:A.data[C]};dhtmlXGridObject.prototype._process_tree_json=function(C,I,A){this._parsing=!0;var H=!1;if(!I){this.render_row=this.render_row_tree;H=!0;I=C;A=I.parent||0;A=="0"&&(A=0);if(!this._h2){this._h2=new dhtmlxHierarchy}if(this._fake){this._fake._h2=this._h2}}if(I.rows){for(var F=0;F<I.rows.length;F++){var D=I.rows[F].id,E=this._h2.add(D,A);E.buff={idd:D,data:I.rows[F],_parser:this._process_json_row,_locator:this._get_json_data};if(I.rows[F].open){E.state="minus"}this.rowsAr[D]=E.buff;this._process_tree_json(I.rows[F],I.rows[F],D)}}if(H){A!=0&&this._h2.change(A,"state","minus"),this._updateTGRState(this._h2.get[A]),this._h2_to_buff(),A!=0&&(this._srnd||this.pagingOn)?this._renderSort():this.render_dataset(),this._slowParse===!1&&this.forEachRow(function(J){this.render_row_tree(0,J)}),this._parsing=!1}};dhtmlXGridObject.prototype._process_xmlA=function(C){if(!C.doXPath){var J=new dtmlXMLLoaderObject(function(){});typeof C=="string"?J.loadXMLString(C):(J.xmlDoc=C.responseXML?C:{},J.xmlDoc.responseXML=C);C=J}this._parsing=!0;var A=C.getXMLTopNode(this.xml.top);this._parseHead(A);var I=C.doXPath(this.xml.row,A),H=parseInt(C.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),D=parseInt(C.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);D&&!this.rowsBuffer[D-1]&&(this.rowsBuffer[D-1]=null);if(this.isTreeGrid()){return this._get_xml_data=this._get_xml_dataA,this._process_xml_row=this._process_xml_rowA,this._process_tree_xml(C)}for(var E=0;E<I.length;E++){if(!this.rowsBuffer[E+H]){var F=I[E].getAttribute("id")||this.uid();this.rowsBuffer[E+H]={idd:F,data:I[E],_parser:this._process_xml_rowA,_locator:this._get_xml_dataA};this.rowsAr[F]=I[E]}}this.render_dataset();this._parsing=!1;return C.xmlDoc.responseXML?C.xmlDoc.responseXML:C.xmlDoc};dhtmlXGridObject.prototype._process_xmlB=function(C){if(!C.doXPath){var J=new dtmlXMLLoaderObject(function(){});typeof C=="string"?J.loadXMLString(C):(J.xmlDoc=C.responseXML?C:{},J.xmlDoc.responseXML=C);C=J}this._parsing=!0;var A=C.getXMLTopNode(this.xml.top);this._parseHead(A);var I=C.doXPath(this.xml.row,A),H=parseInt(C.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0),D=parseInt(C.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);D&&!this.rowsBuffer[D-1]&&(this.rowsBuffer[D-1]=null);if(this.isTreeGrid()){return this._get_xml_data=this._get_xml_dataB,this._process_xml_row=this._process_xml_rowB,this._process_tree_xml(C)}for(var E=0;E<I.length;E++){if(!this.rowsBuffer[E+H]){var F=I[E].getAttribute("id")||this.uid();this.rowsBuffer[E+H]={idd:F,data:I[E],_parser:this._process_xml_rowB,_locator:this._get_xml_dataB};this.rowsAr[F]=I[E]}}this.render_dataset();this._parsing=!1;return C.xmlDoc.responseXML?C.xmlDoc.responseXML:C.xmlDoc};dhtmlXGridObject.prototype._process_xml_rowA=function(C,H){var A=[];C._attrs=this._xml_attrs(H);for(var F=0;F<this.columnIds.length;F++){var E=this.columnIds[F],D=C._attrs[E]||"";if(C.childNodes[F]){C.childNodes[F]._attrs={}}A.push(D)}this._fillRow(C,this._c_order?this._swapColumns(A):A);return C};dhtmlXGridObject.prototype._get_xml_dataA=function(A,C){return A.getAttribute(this.getColumnId(C))};dhtmlXGridObject.prototype._process_xml_rowB=function(K,I){var J=[];K._attrs=this._xml_attrs(I);if(this._ud_enabled){for(var H=this.xmlLoader.doXPath("./userdata",I),F=H.length-1;F>=0;F--){this.setUserData(H[F].getAttribute("name"),H[F].firstChild?H[F].firstChild.data:"")}}for(var C=0;C<I.childNodes.length;C++){var D=I.childNodes[C];if(D.tagName){var E=this.getColIndexById(D.tagName);if(!isNaN(E)){var A=D.getAttribute("type");if(A){K.childNodes[E]._cellType=A}K.childNodes[E]._attrs=this._xml_attrs(D);D.getAttribute("xmlcontent")||(D=D.firstChild?D.firstChild.data:"");J[E]=D}}}for(F=0;F<K.childNodes.length;F++){if(!K.childNodes[F]._attrs){K.childNodes[F]._attrs={}}}this._fillRow(K,this._c_order?this._swapColumns(J):J);return K};dhtmlXGridObject.prototype._get_xml_dataB=function(C,D){for(var A=this.getColumnId(D),C=C.firstChild;;){if(!C){break}if(C.tagName==A){return C.firstChild?C.firstChild.data:""}C=C.nextSibling}return""};dhtmlXGridObject.prototype.enableHeaderMenu=function(A){typeof A=="string"&&(A=A.split(","));this._hm_config=A;var C=this;this.attachEvent("onInit",function(){this.hdr.oncontextmenu=function(D){return C._doHContClick(D||window.event)};this.startColResizeA=this.startColResize;this.startColResize=function(D){return D.button==2||_isMacOS&&D.ctrlKey?this._doHContClick(D):this.startColResizeA(D)};this._chm_ooc=this.obj.onclick;this._chm_hoc=this.hdr.onclick;this.hdr.onclick=function(D){if(D&&(D.button==2||_isMacOS&&D.ctrlKey)){return !1}C._showHContext(!1);return C._chm_hoc.apply(this,arguments)};this.obj.onclick=function(){C._showHContext(!1);return C._chm_ooc.apply(this,arguments)}});dhtmlxEvent(document.body,"click",function(){C._hContext&&C._showHContext(!1)});this.hdr.rows.length&&this.callEvent("onInit",[]);this.enableHeaderMenu=function(){}};dhtmlXGridObject.prototype._doHContClick=function(C){function D(F){if(F.pageX||F.pageY){return{x:F.pageX,y:F.pageY}}var E=_isIE&&document.compatMode!="BackCompat"?document.documentElement:document.body;return{x:F.clientX+E.scrollLeft-E.clientLeft,y:F.clientY+E.scrollTop-E.clientTop}}this._createHContext();var A=D(C);this._showHContext(!0,A.x,A.y);C[_isIE?"srcElement":"target"].oncontextmenu=function(E){(E||event).cancelBubble=!0;return !1};C.cancelBubble=!0;C.preventDefault&&C.preventDefault();return !1};dhtmlXGridObject.prototype._createHContext=function(){if(this._hContext){return this._hContext}var C=document.createElement("DIV");C.oncontextmenu=function(K){(K||event).cancelBubble=!0;return !1};C.onclick=function(K){return(K||event).cancelBubble=!0};C.className="dhx_header_cmenu";C.style.width=C.style.height="5px";C.style.display="none";var J=[],A=0;if(this._fake){A=this._fake._cCount}for(var I=A;A<this.hdr.rows[1].cells.length;A++){var H=this.hdr.rows[1].cells[A];if(!this._hm_config||this._hm_config[A]&&this._hm_config[A]!="false"){var D=H.firstChild&&H.firstChild.tagName=="DIV"?H.firstChild.innerHTML:H.innerHTML,D=D.replace(/<[^>]*>/gi,"");J.push("<div class='dhx_header_cmenu_item'><input type='checkbox' column='"+I+"' len='"+(H.colSpan||1)+"' checked='true' />"+D+"</div>")}I+=H.colSpan||1}C.innerHTML=J.join("");for(var E=this,F=function(){var L=this.getAttribute("column");if(!this.checked&&!E._checkLast(L)){return this.checked=!0}if(E._realfake){E=E._fake}for(var K=0;K<this.getAttribute("len");K++){E.setColumnHidden(L*1+K*1,!this.checked)}this.checked&&E.getColWidth(L)==0&&E.adjustColumnSize(L)},A=0;A<C.childNodes.length;A++){C.childNodes[A].firstChild.onclick=F}document.body.insertBefore(C,document.body.firstChild);this._hContext=C;C.style.position="absolute";C.style.zIndex=999;C.style.width="auto";C.style.height="auto";C.style.display="block"};dhtmlXGridObject.prototype._checkLast=function(A){for(var C=0;C<this._cCount;C++){if((!this._hrrar||!this._hrrar[C])&&C!=A){return !0}}return !1};dhtmlXGridObject.prototype._updateHContext=function(){for(var C=0;C<this._hContext.childNodes.length;C++){var D=this._hContext.childNodes[C].firstChild,A=D.getAttribute("column");if(this.isColumnHidden(A)||this.getColWidth(A)==0){D.checked=!1}}};dhtmlXGridObject.prototype._showHContext=function(C,D,A){if(C&&this.enableColumnMove){this._hContext.parentNode.removeChild(this._hContext),this._hContext=null}this._createHContext();this._hContext.style.display=C?"block":"none";if(C){this._updateHContext(!0),this._hContext.style.left=D+"px",this._hContext.style.top=A+"px"}};function eXcell_math(A){if(A){this.cell=A,this.grid=this.cell.parentNode.grid}this.edit=function(){this.grid.editor=new eXcell_ed(this.cell);this.grid.editor.fix_self=!0;this.grid.editor.getValue=this.cell.original?function(){return this.cell.original}:this.getValue;this.grid.editor.setValue=this.setValue;this.grid.editor.edit()};this.isDisabled=function(){return !this.grid._mathEdit};this.setValue=function(C){C=this.grid._compileSCL(C,this.cell,this.fix_self);this.grid._strangeParams[this.cell._cellIndex]?this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).setValue(C):(this.setCValue(C),this.cell._clearCell=!1)};this.getValue=function(){return this.grid._strangeParams[this.cell._cellIndex]?this.grid.cells5(this.cell,this.grid._strangeParams[this.cell._cellIndex]).getValue():this.cell.innerHTML}}eXcell_math.prototype=new eXcell;dhtmlXGridObject.prototype._init_point_bm=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){this._mat_links={};this._aggregators=[];this.attachEvent("onClearAll",function(){this._mat_links={};this._aggregators=[]});this.attachEvent("onCellChanged",function(C,H){if(this._mat_links[C]){var A=this._mat_links[C][H];if(A){for(var F=0;F<A.length;F++){this.cells5(A[F]).setValue(this._calcSCL(A[F]))}}}if(!this._parsing&&this._aggregators[H]){var E=this._h2.get[C].parent.id;if(E!=0){var D=this.cells(E,H);D.setValue(this._calcSCL(D.cell))}}});this.attachEvent("onAfterRowDeleted",function(C,E){if(E!=0&&!this._parsing&&this._aggregators.length){for(var A=0;A<this._aggregators.length;A++){if(this._aggregators[A]){var D=this.cells(E,A);D.setValue(this._calcSCL(D.cell))}}}return !0});this.attachEvent("onXLE",function(){for(var A=0;A<this._aggregators.length;A++){this._aggregators[A]&&this._h2.forEachChild(0,function(D){if(D.childs.length!=0){var C=this.cells(D.id,A);C.setValue(this._calcSCL(C.cell))}},this)}});(this._init_point=this._init_point_bm)&&this._init_point()};dhtmlXGridObject.prototype.enableMathSerialization=function(A){this._mathSerialization=convertStringToBoolean(A)};dhtmlXGridObject.prototype.setMathRound=function(A){this._roundDl=A;this._roundD=Math.pow(10,A)};dhtmlXGridObject.prototype.enableMathEditing=function(A){this._mathEdit=convertStringToBoolean(A)};dhtmlXGridObject.prototype._calcSCL=function(a){if(!a._code){return this.cells5(a).getValue()}try{dhtmlx.agrid=this;var c=eval(a._code)}catch(b){return"#SCL"}if(this._roundD){var d=Math.abs(c)<1?"0":"";c<0&&(d="-"+d);c=Math.round(Math.abs(c)*this._roundD).toString();if(c==0){return 0}if(this._roundDl>0){var e=c.length-this._roundDl;e<0&&(c=("000000000"+c).substring(9+e),e=0);return d+c.substring(0,e)+"."+c.substring(e,c.length)}}return c};dhtmlXGridObject.prototype._countTotal=function(C,F){for(var A=0,E=this._h2.get[C],D=0;D<E.childs.length;D++){if(!E.childs[D].buff){break}if(E.childs[D].buff._parser){this._h2.forEachChild(C,function(H){H.childs.length==0&&(A+=parseInt(this._get_cell_value(H.buff,F),10))},this);break}A+=parseInt(this._get_cell_value(E.childs[D].buff,F),10)}return A};dhtmlXGridObject.prototype._compileSCL=function(C,H,A){if(C===null||C===window.undefined){return C}C=C.toString();if(C.indexOf("=")!=0){this._reLink([],H);if(A){H._code=H.original=null}return C}H.original=C;var F=null,C=C.replace("=","");if(C.indexOf("sum")!=-1){C=C.replace("sum","(dhtmlx.agrid._countTotal('"+H.parentNode.idd+"',"+H._cellIndex+"))");if(!this._aggregators){this._aggregators=[]}this._aggregators[H._cellIndex]="sum";H._code=C;return this._parsing?"":this._calcSCL(H)}if(C.indexOf("[[")!=-1){var E=/(\[\[([^\,]*)\,([^\]]*)]\])/g;dhtmlx.agrid=this;F=F||[];C=C.replace(E,function(J,I,L,K){if(L=="-"){L=H.parentNode.idd}L.indexOf("#")==0&&(L=dhtmlx.agrid.getRowId(L.replace("#","")));F[F.length]=[L,K];return'(parseInt(dhtmlx.agrid.cells("'+L+'",'+K+").getValue(),10))"})}if(C.indexOf(":")!=-1){E=/:(\w+)/g;dhtmlx.agrid=this;var D=H.parentNode.idd,F=F||[],C=C.replace(E,function(J,I){F[F.length]=[D,dhtmlx.agrid.getColIndexById(I)];return'(parseInt(dhtmlx.agrid.cells("'+D+'",dhtmlx.agrid.getColIndexById("'+I+'")).getValue(),10))'})}else{E=/c([0-9]+)/g,dhtmlx.agrid=this,D=H.parentNode.idd,F=F||[],C=C.replace(E,function(J,I){F[F.length]=[D,I];return'(parseInt(dhtmlx.agrid.cells("'+D+'",'+I+").getValue(),10))"})}this._reLink(F,H);H._code=C;return this._calcSCL(H)};dhtmlXGridObject.prototype._reLink=function(C,E){if(C.length){for(var A=0;A<C.length;A++){this._mat_links[C[A][0]]||(this._mat_links[C[A][0]]={});var D=this._mat_links[C[A][0]];D[C[A][1]]||(D[C[A][1]]=[]);D[C[A][1]].push(E)}}};_isKHTML&&function(){var A=String.prototype.replace;String.prototype.replace=function(L,M){if(typeof M!="function"){return A.apply(this,arguments)}var K=""+this,J=M;if(!(L instanceof RegExp)){var F=K.indexOf(L);return F==-1?K:A.apply(K,[L,J(L,F,K)])}for(var H=L,I=[],E=H.lastIndex,D;(D=H.exec(K))!=null;){var F=D.index,C=D.concat(F,K);I.push(K.slice(E,F),J.apply(null,C).toString());if(H.global){E=H.lastIndex}else{E+=RegExp.lastMatch.length;break}}I.push(K.slice(E));return I.join("")}}();dhtmlXGridObject.prototype.loadCSVFile=function(A,C){this.load(A,C,"csv")};dhtmlXGridObject.prototype.enableCSVAutoID=function(A){this._csvAID=convertStringToBoolean(A)};dhtmlXGridObject.prototype.enableCSVHeader=function(A){this._csvHdr=convertStringToBoolean(A)};dhtmlXGridObject.prototype.setCSVDelimiter=function(A){this.csv.cell=A};dhtmlXGridObject.prototype._csvAID=!0;dhtmlXGridObject.prototype.loadCSVString=function(A){this.parse(A,"csv")};dhtmlXGridObject.prototype.serializeToCSV=function(C){this.editStop();this._agetm=this._mathSerialization?"getMathValue":this._strictText||C?"getTitle":"getValue";var I=[];if(this._csvHdr){for(var A=1;A<this.hdr.rows.length;A++){for(var H=[],F=0;F<this._cCount;F++){(!this._srClmn||this._srClmn[F])&&H.push(this.getColumnLabel(F,A-1))}I.push(this.csvParser.str(H,this.csv.cell,this.csv.row))}}for(var F=0,D=this.rowsBuffer.length;F<D;F++){var E=this._serializeRowToCVS(null,F);E!=""&&I.push(E)}return this.csvParser.block(I,this.csv.row)};dhtmlXGridObject.prototype._serializeRowToCVS=function(N,L,M,K){var J=[];N||(N=this.render_row(L),this._fake&&!this._fake.rowsAr[N.idd]&&this._fake.render_row(L));if(!this._csvAID){J[J.length]=N.idd}for(var M=M||0,K=K||this._cCount,F=!1,H=M;N.childNodes[M]._cellIndex>H&&M;){M--}for(var I=M;H<K;I++){if(!N.childNodes[I]){break}var E=N.childNodes[I]._cellIndex;if(!this._srClmn||this._srClmn[E]){for(var D=N.childNodes[I],C=this.cells(N.idd,E);H!=E;){if(H++,J.push(""),H>=K){break}}if(H>=K){break}H++;zxVal=C.cell?C[this._agetm]():"";this._chAttr&&C.wasChanged()&&(F=!0);J[J.length]=zxVal===null?"":zxVal;if(this._ecspn&&D.colSpan&&D.colSpan>1){for(var D=D.colSpan-1,A=0;A<D;A++){J[J.length]="",H++}}}else{H++}}return this._onlChAttr&&!F?"":this.csvParser.str(J,this.csv.cell,this.csv.row)};dhtmlXGridObject.prototype.toClipBoard=function(A){window.clipboardData?window.clipboardData.setData("Text",A):(new Clipboard).copy(A)};dhtmlXGridObject.prototype.fromClipBoard=function(){return window.clipboardData?window.clipboardData.getData("Text"):(new Clipboard).paste()};dhtmlXGridObject.prototype.cellToClipboard=function(C,D){if(!C||!D){if(!this.selectedRows[0]){return }C=this.selectedRows[0].idd;D=this.cell._cellIndex}var A=this.cells(C,D);this.toClipBoard(((A.getLabel?A.getLabel():A.getValue())||"").toString())};dhtmlXGridObject.prototype.updateCellFromClipboard=function(C,D){if(!C||!D){if(!this.selectedRows[0]){return }C=this.selectedRows[0].idd;D=this.cell._cellIndex}var A=this.cells(C,D);A[A.setImage?"setLabel":"setValue"](this.fromClipBoard())};dhtmlXGridObject.prototype.rowToClipboard=function(C){var E="";this._agetm=this._mathSerialization?"getMathValue":this._strictText?"getTitle":"getValue";if(C){E=this._serializeRowToCVS(this.getRowById(C))}else{for(var A=[],D=0;D<this.selectedRows.length;D++){A[A.length]=this._serializeRowToCVS(this.selectedRows[D]),E=this.csvParser.block(A,this.csv.row)}}this.toClipBoard(E)};dhtmlXGridObject.prototype.updateRowFromClipboard=function(C){var H=this.fromClipBoard();if(H){var A=C?this.getRowById(C):this.selectedRows[0];if(A){var F=this.csvParser,H=F.unblock(H,this.csv.cell,this.csv.row)[0];this._csvAID||H.splice(0,1);for(var E=0;E<H.length;E++){var D=this.cells3(A,E);D[D.setImage?"setLabel":"setValue"](H[E])}}}};dhtmlXGridObject.prototype.csvParser={block:function(A,C){return A.join(C)},unblock:function(C,H,A){for(var F=(C||"").split(A),E=0;E<F.length;E++){F[E]=(F[E]||"").split(H)}var D=F.length-1;F[D].length==1&&F[D][0]==""&&F.splice(D,1);return F},str:function(A,C){return A.join(C)}};dhtmlXGridObject.prototype.csvExtParser={_quote:RegExp('"',"g"),_quote_esc:RegExp('\\\\"',"g"),block:function(A,C){return A.join(C)},unblock:function(N,L,M){var K=[[]],J=0;if(!N){return K}for(var F=/^[ ]*"/,H=/"[ ]*$/,I=RegExp(".*"+M+".*$"),E=N.split(L),D=0;D<E.length;D++){if(E[D].match(F)){for(var C=E[D].replace(F,"");!E[D].match(H);){D++,C+=E[D]}K[J].push(C.replace(H,"").replace(this._quote_esc,'"'))}else{if(E[D].match(I)){var A=E[D].split(M,2);K[J].push(A[0]);J++;K[J]=[];E[D]=A[1];D--}else{(E[D]||D!=E.length-1)&&K[J].push(E[D])}}}return K},str:function(C,D){for(var A=0;A<C.length;A++){C[A]='"'+C[A].replace(this._quote,'\\"')+'"'}return C.join(D)}};dhtmlXGridObject.prototype.addRowFromClipboard=function(){var C=this.fromClipBoard();if(C){for(var D=this.csvParser.unblock(C,this.csv.cell,this.csv.row),A=0;A<D.length;A++){D[A]&&(C=D[A],C.length&&(this._csvAID?this.addRow(this.getRowsNum()+2,C):(this.rowsAr[C[0]]&&(C[0]=this.uid()),this.addRow(C[0],C.slice(1)))))}}};dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())};dhtmlXGridObject.prototype.gridFromClipboard=function(){var A=this.fromClipBoard();A&&this.loadCSVString(A)};dhtmlXGridObject.prototype.getXLS=function(C){if(!this.xslform){this.xslform=document.createElement("FORM");this.xslform.action=(C||"")+"xls.php";this.xslform.method="post";this.xslform.target=_isIE?"_blank":"";document.body.appendChild(this.xslform);var I=document.createElement("INPUT");I.type="hidden";I.name="csv";this.xslform.appendChild(I);var A=document.createElement("INPUT");A.type="hidden";A.name="csv_header";this.xslform.appendChild(A)}var H=this.serializeToCSV();this.xslform.childNodes[0].value=H;for(var F=[],D=this._cCount,E=0;E<D;E++){F.push(this.getHeaderCol(E))}F=F.join(",");this.xslform.childNodes[1].value=F;this.xslform.submit()};dhtmlXGridObject.prototype.printView=function(X,V){var W="<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \n td.filter input, td.filter select { display:none; }\t\n  </style>",U=null;if(this._fake){for(var U=[].concat(this._hrrar),T=0;T<this._fake._cCount;T++){this._hrrar[T]=null}}W+="<base  href='"+document.location.href+"'></base>";this.parentGrid||(W+=X||"");W+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var P=Math.max(this.rowsBuffer.length,this.rowsCol.length),Q=this._cCount,S=this._printWidth();W+='<tr class="header_row_1">';for(T=0;T<Q;T++){if(!this._hrrar||!this._hrrar[T]){for(var O=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(T)]:T],N=O.colSpan||1,M=O.rowSpan||1,L=1;L<N;L++){S[T]+=S[L]}W+='<td rowspan="'+M+'" width="'+S[T]+'%" style="background-color:lightgrey;" colspan="'+N+'">'+this.getHeaderCol(T)+"</td>";T+=N-1}}W+="</tr>";for(T=2;T<this.hdr.rows.length;T++){if(_isIE){W+="<tr style='background-color:lightgrey' class='header_row_"+T+"'>";for(var K=this.hdr.rows[T].childNodes,L=0;L<K.length;L++){if(!this._hrrar||!this._hrrar[K[L]._cellIndex]){W+=K[L].outerHTML}}W+="</tr>"}else{W+="<tr class='header_row_"+T+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[T].innerHTML:"")+this.hdr.rows[T].innerHTML+"</tr>"}}for(T=0;T<P;T++){if(W+="<tr>",this.rowsCol[T]&&this.rowsCol[T]._cntr){W+=this.rowsCol[T].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>"}else{if(!(this.rowsCol[T]&&this.rowsCol[T].style.display=="none")){var I;if(this.rowsCol[T]){I=this.rowsCol[T].idd}else{if(this.rowsBuffer[T]){I=this.rowsBuffer[T].idd}else{continue}}for(L=0;L<Q;L++){if(!this._hrrar||!this._hrrar[L]){if(this.rowsAr[I]&&this.rowsAr[I].tagName=="TR"){var J=this.cells(I,L),H=J._setState?"":J.getContent?J.getContent():J.getImage||J.combo?J.cell.innerHTML:J.getValue()}else{H=this._get_cell_value(this.rowsBuffer[T],L)}var E=this.columnColor[L]?"background-color:"+this.columnColor[L]+";":"",C=this.cellAlign[L]?"text-align:"+this.cellAlign[L]+";":"",D=J.getAttribute("colspan");W+='<td style="'+E+C+'" '+(D?'colSpan="'+D+'"':"")+">"+(H===""?"&nbsp;":H)+"</td>";D&&(L+=D-1)}}W+="</tr>";if(this.rowsCol[T]&&this.rowsCol[T]._expanded){var A=this.cells4(this.rowsCol[T]._expanded.ctrl);W+=A.getSubGrid?'<tr><td colspan="'+Q+'">'+A.getSubGrid().printView()+"</td></tr>":'<tr><td colspan="'+Q+'">'+this.rowsCol[T]._expanded.innerHTML+"</td></tr>"}}}}if(this.ftr){for(T=1;T<this.ftr.childNodes[0].rows.length;T++){W+="<tr style='background-color:lightgrey'>"+(this._fake?this._fake.ftr.childNodes[0].rows[T].innerHTML:"")+this.ftr.childNodes[0].rows[T].innerHTML+"</tr>"}}W+="</table>";if(this.parentGrid){return W}W+=V||"";var F=window.open("","_blank");F.document.write(W);F.document.write("<script>window.onerror=function(){return true;}<\/script>");F.document.close();if(this._fake){this._hrrar=U}};dhtmlXGridObject.prototype._printWidth=function(){for(var C=[],I=0,A=0;A<this._cCount;A++){var H=this.getColWidth(A);C.push(H);I+=H}for(var F=[],D=0,A=0;A<C.length;A++){var E=Math.floor(C[A]/I*100);D+=E;F.push(E)}F[F.length-1]+=100-D;return F};dhtmlXGridObject.prototype.loadObject=function(){};dhtmlXGridObject.prototype.loadJSONFile=function(){};dhtmlXGridObject.prototype.serializeToObject=function(){};dhtmlXGridObject.prototype.serializeToJSON=function(){};if(!window.clipboardData){window.clipboardData={_make:function(){var C=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!C){return null}var D=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!D){return null}D.addDataFlavor("text/unicode");var A=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);this._p=[C,D,A];return !0},setData:function(C,E){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(A){return dhtmlxError.throwError("Clipboard","Access to clipboard denied",[C,E]),""}if(!this._make()){return !1}this._p[2].data=E;this._p[1].setTransferData("text/unicode",this._p[2],E.length*2);var D=Components.interfaces.nsIClipboard;this._p[0].setData(this._p[1],null,D.kGlobalClipboard)},getData:function(C){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(F){return dhtmlxError.throwError("Clipboard","Access to clipboard denied",[C]),""}if(!this._make()){return !1}this._p[0].getData(this._p[1],this._p[0].kGlobalClipboard);var A={},E={};try{this._p[1].getTransferData("text/unicode",E,A)}catch(D){return""}E&&(E=E.value.QueryInterface(Components.interfaces.nsISupportsString));return E?E.data.substring(0,A.value/2):""}}}dhtmlXGridObject.prototype.setRowspan=function(M,K,L){var J=this[this._bfs_cells?"_bfs_cells":"cells"](M,K).cell,I=this.rowsAr[M];if(J.rowSpan&&J.rowSpan!=1){for(var E=I.nextSibling,F=1;F<J.rowSpan;F++){var H=E.childNodes[E._childIndexes[J._cellIndex+1]],D=document.createElement("TD");D.innerHTML="&nbsp;";D._cellIndex=J._cellIndex;D._clearCell=!0;H?H.parentNode.insertBefore(D,H):E.parentNode.appendChild(D);this._shiftIndexes(E,J._cellIndex,-1);E=E.nextSibling}}J.rowSpan=L;for(var I=this._h2?this.rowsAr[this._h2.get[I.idd].parent.childs[this._h2.get[I.idd].index+1].id]:I.nextSibling||this.rowsCol[this.rowsCol._dhx_find(I)+1],C=[],F=1;F<L;F++){var A=null,A=this._fake&&!this._realfake?this._bfs_cells3(I,K).cell:this.cells3(I,K).cell;this._shiftIndexes(I,J._cellIndex,1);A&&A.parentNode.removeChild(A);C.push(I);this._h2?(I=this._h2.get[I.idd].parent.childs[this._h2.get[I.idd].index+1])&&(I=this.rowsAr[I.id]):I=I.nextSibling||this.rowsCol[this.rowsCol._dhx_find(I)+1]}this.rowsAr[M]._rowSpan=this.rowsAr[M]._rowSpan||{};this.rowsAr[M]._rowSpan[K]=C;this._fake&&!this._realfake&&K<this._fake._cCount&&this._fake.setRowspan(M,K,L)};dhtmlXGridObject.prototype._shiftIndexes=function(C,E,A){if(!C._childIndexes){C._childIndexes=[];for(var D=0;D<C.childNodes.length;D++){C._childIndexes[D]=D}}for(D=0;D<C._childIndexes.length;D++){D>E&&(C._childIndexes[D]-=A)}};dhtmlXGridObject.prototype.enableRowspan=function(){this._erspan=!0;this.enableRowspan=function(){};this.attachEvent("onAfterSorting",function(){if(!this._dload){for(var K=1;K<this.obj.rows.length;K++){if(this.obj.rows[K]._rowSpan){var I=this.obj.rows[K],J;for(J in I._rowSpan){for(var H=I,F=H._rowSpan[J],C=0;C<F.length;C++){H.nextSibling?H.parentNode.insertBefore(F[C],H.nextSibling):H.parentNode.appendChild(F[C]);if(this._fake){var D=this._fake.rowsAr[H.idd],E=this._fake.rowsAr[F[C].idd];D.nextSibling?D.parentNode.insertBefore(E,D.nextSibling):D.parentNode.appendChild(E);this._correctRowHeight(H.idd)}H=H.nextSibling}}}}var A=this.rowsCol.stablesort;this.rowsCol=new dhtmlxArray;this.rowsCol.stablesort=A;for(K=1;K<this.obj.rows.length;K++){this.rowsCol.push(this.obj.rows[K])}}});this.attachEvent("onXLE",function(M,K,L,J){for(var I=this.xmlLoader.doXPath("//cell[@rowspan]",J),E=0;E<I.length;E++){for(var F=I[E].parentNode,H=F.getAttribute("id"),D=I[E].getAttribute("rowspan"),C=0,A=0;A<F.childNodes.length;A++){if(F.childNodes[A].tagName=="cell"){if(F.childNodes[A]==I[E]){break}else{C++}}}this.setRowspan(H,C,D)}})};dhtmlXGridObject.prototype._init_point_bspl=dhtmlXGridObject.prototype._init_point;dhtmlXGridObject.prototype._init_point=function(){this._split_later&&this.splitAt(this._split_later);(this._init_point=this._init_point_bspl)&&this._init_point()};dhtmlXGridObject.prototype.splitAt=function(Q){function O(T,S){S.style.whiteSpace="";var W=S.nextSibling,V=S.parentNode;T.parentNode.insertBefore(S,T);W?V.insertBefore(T,W):V.appendChild(T);var U=T.style.display;T.style.display=S.style.display;S.style.display=U}function P(t,q,p,c){var a=Array(Q).join(this.delim),Z=[];if(t==2){for(var W=0;W<Q;W++){var Y=q[t-1].cells[q[t-1]._childIndexes?q[t-1]._childIndexes[W]:W];if(Y.rowSpan&&Y.rowSpan>1){Z[Y._cellIndex]=Y.rowSpan-1,c[t-1].cells[c[t-1]._childIndexes?c[t-1]._childIndexes[W]:W].rowSpan=Y.rowSpan,Y.rowSpan=1}}}for(;t<q.length;t++){this._fake.attachHeader(a,null,p);for(var c=c||this._fake.ftr.childNodes[0].rows,V=Q,X=0,U=0;U<V;U++){if(Z[U]){Z[U]-=1;if(_isIE||_isFF&&_FFrv>=1.9||_isOpera){var S=document.createElement("TD");if(_isFF){S.style.display="none"}q[t].insertBefore(S,q[t].cells[0])}X++}else{var T=c[t].cells[U-X],s=q[t].cells[U-(_isIE?0:X)],r=s.rowSpan;O(T,s);if(r>1){Z[U]=r-1,s.rowSpan=r}if(c[t].cells[U].colSpan>1){q[t].cells[U].colSpan=c[t].cells[U].colSpan;V-=c[t].cells[U].colSpan-1;for(W=1;W<c[t].cells[U].colSpan;W++){c[t].removeChild(c[t].cells[U+1])}}}}}}if(!this.obj.rows[0]){return this._split_later=Q}var Q=parseInt(Q),N=document.createElement("DIV");this.entBox.appendChild(N);var M=document.createElement("DIV");this.entBox.appendChild(M);for(var J=this.entBox.childNodes.length-3;J>=0;J--){M.insertBefore(this.entBox.childNodes[J],M.firstChild)}this.entBox.style.position="relative";this.globalBox=this.entBox;this.entBox=M;M.grid=this;N.style.cssText+="border:0px solid red !important;";M.style.cssText+="border:0px solid red !important;";M.style.top="0px";M.style.position="absolute";N.style.position="absolute";N.style.top="0px";N.style.left="0px";N.style.zIndex=11;M.style.height=N.style.height=this.globalBox.clientHeight;this._fake=new dhtmlXGridObject(N);this._fake.setSkin("not_existing_skin");this.globalBox=this._fake.globalBox=this.globalBox;this._fake._fake=this;this._fake._realfake=!0;this._treeC=this.cellType._dhx_find("tree");this._fake.delim=this.delim;this._fake.customGroupFormat=this.customGroupFormat;this._fake.imgURL=this.imgURL;this._fake._customSorts=this._customSorts;this._fake.noHeader=this.noHeader;this._fake._enbTts=this._enbTts;this._fake.clists=this.clists;this._fake.fldSort=[];this._fake.selMultiRows=this.selMultiRows;if((this._fake.multiLine=this.multiLine)||this._erspan){this.attachEvent("onCellChanged",this._correctRowHeight);var K=function(){this.forEachRow(function(S){this._correctRowHeight(S)})};this.attachEvent("onPageChanged",K);this.attachEvent("onXLE",K);this.attachEvent("onResizeEnd",K);this._ads_count||this.attachEvent("onAfterSorting",K);this.attachEvent("onDistributedEnd",K)}this.attachEvent("onGridReconstructed",function(){this._fake.objBox.scrollTop=this.objBox.scrollTop});this._fake.loadedKidsHash=this.loadedKidsHash;if(this._h2){this._fake._h2=this._h2}this._fake._dInc=this._dInc;var L=[[],[],[],[],[],[],[]],I="hdrLabels,initCellWidth,cellType,cellAlign,cellVAlign,fldSort,columnColor".split(","),H="setHeader,setInitWidths,setColTypes,setColAlign,setColVAlign,setColSorting,setColumnColor".split(",");this._fake.callEvent=function(){this._fake._split_event=!0;arguments[0]=="onGridReconstructed"&&this._fake.callEvent.apply(this,arguments);return this._fake.callEvent.apply(this._fake,arguments)};this._elmn&&this._fake.enableLightMouseNavigation(!0);(this.__cssEven||this._cssUnEven)&&this._fake.attachEvent("onGridReconstructed",function(){this._fixAlterCss()});this._fake._cssEven=this._cssEven;this._fake._cssUnEven=this._cssUnEven;this._fake._cssSP=this._cssSP;this._fake.isEditable=this.isEditable;this._fake._edtc=this._edtc;this._sst&&this._fake.enableStableSorting(!0);this._fake._sclE=this._sclE;this._fake._dclE=this._dclE;this._fake._f2kE=this._f2kE;this._fake._maskArr=this._maskArr;this._fake._dtmask=this._dtmask;this._fake.combos=this.combos;for(var F=0,E=this.globalBox.offsetWidth,J=0;J<Q;J++){for(var D=0;D<I.length;D++){this[I[D]]&&(L[D][J]=this[I[D]][J]),typeof L[D][J]=="string"&&(L[D][J]=L[D][J].replace(RegExp("\\"+this.delim,"g"),"\\"+this.delim))}_isFF&&(L[1][J]*=1);this.cellWidthType=="%"?(L[1][J]=Math.round(parseInt(this[I[1]][J])*E/100),F+=L[1][J]):F+=parseInt(this[I[1]][J]);this.setColumnHidden(J,!0)}for(D=0;D<I.length;D++){var A=L[D].join(this.delim);if(H[D]!="setHeader"){if(A!=""){this._fake[H[D]](A)}}else{this._fake[H[D]](A,null,this._hstyles)}}this._fake._strangeParams=this._strangeParams;this._fake._drsclmn=this._drsclmn;F=Math.min(this.globalBox.offsetWidth,F);M.style.left=F+"px";N.style.width=F+"px";M.style.width=Math.max(this.globalBox.offsetWidth-F,0);if(this._ecspn){this._fake._ecspn=!0}this._fake.init();this.dragAndDropOff&&this.dragger.addDragLanding(this._fake.entBox,this);this._fake.objBox.style.overflow="hidden";this._fake.objBox.style.overflowX="scroll";this._fake._srdh=this._srdh||20;this._fake._srnd=this._srnd;this.hdr.rows.length>2&&P.call(this,2,this.hdr.rows,"_aHead",this._fake.hdr.rows);if(this.ftr){P.call(this,1,this.ftr.childNodes[0].rows,"_aFoot"),this._fake.ftr.parentNode.style.bottom=(_isFF?2:1)+"px"}if(this.saveSizeToCookie){this.saveSizeToCookie=function(S,W){if(this._realfake){return this._fake.saveSizeToCookie.apply(this._fake,arguments)}if(!S){S=this.entBox.id}for(var V=[],U="cellWidthPX",T=0;T<this[U].length;T++){V[T]=T<Q?this._fake[U][T]:this[U][T]}V=V.join(",");this.setCookie(S,W,0,V);V=(this.initCellWidth||[]).join(",");this.setCookie(S,W,1,V);return !0},this.loadSizeFromCookie=function(S){if(!S){S=this.entBox.id}var X=this._getCookie(S,1);if(X){this.initCellWidth=X.split(",");var X=this._getCookie(S,0),W="cellWidthPX";this.cellWidthType="px";var V=0;if(X&&X.length){for(var X=X.split(","),U=0;U<X.length;U++){U<Q?(this._fake[W][U]=X[U],V+=X[U]*1):this[W][U]=X[U]}}this._fake.entBox.style.width=V+"px";this._fake.objBox.style.width=V+"px";var T=this.globalBox.childNodes[1];T.style.left=V-(_isFF?0:0)+"px";if(this.ftr){this.ftr.style.left=V-(_isFF?0:0)+"px"}T.style.width=this.globalBox.offsetWidth-V+"px";this.setSizes();return !0}},this._fake.onRSE=this.onRSE}this.setCellTextStyleA=this.setCellTextStyle;this.setCellTextStyle=function(S,U,T){U<Q&&this._fake.setCellTextStyle(S,U,T);this.setCellTextStyleA(S,U,T)};this.setRowTextBoldA=this.setRowTextBold;this.setRowTextBold=function(S){this.setRowTextBoldA(S);this._fake.setRowTextBold(S)};this.setRowColorA=this.setRowColor;this.setRowColor=function(T,S){this.setRowColorA(T,S);this._fake.setRowColor(T,S)};this.setRowHiddenA=this.setRowHidden;this.setRowHidden=function(T,S){this.setRowHiddenA(T,S);this._fake.setRowHidden(T,S)};this.setRowTextNormalA=this.setRowTextNormal;this.setRowTextNormal=function(S){this.setRowTextNormalA(S);this._fake.setRowTextNormal(S)};this.getChangedRows=function(T){function S(V){for(var W=0;W<V.childNodes.length;W++){if(V.childNodes[W].wasChanged){return U[U.length]=V.idd}}}var U=[];this.forEachRow(function(X){var W=this.rowsAr[X],V=this._fake.rowsAr[X];if(!(W.tagName!="TR"||V.tagName!="TR")){T&&W._added?U[U.length]=W.idd:S(W)||S(V)}});return U.join(this.delim)};this.setRowTextStyleA=this.setRowTextStyle;this.setRowTextStyle=function(T,S){this.setRowTextStyleA(T,S);this._fake.rowsAr[T]&&this._fake.setRowTextStyle(T,S)};this.lockRowA=this.lockRow;this.lockRow=function(T,S){this.lockRowA(T,S);this._fake.lockRow(T,S)};this.getColWidth=function(S){return S<Q?parseInt(this._fake.cellWidthPX[S]):parseInt(this.cellWidthPX[S])};this.getColumnLabel=function(S){return this._fake.getColumnLabel.apply(S<Q?this._fake:this,arguments)};this.setColWidthA=this._fake.setColWidthA=this.setColWidth;this.setColWidth=function(S,T){S*=1;S<Q?this._fake.setColWidthA(S,T):this.setColWidthA(S,T);S+1<=Q&&this._fake._correctSplit(Math.min(this._fake.objBox.offsetWidth,this._fake.obj.offsetWidth))};this.adjustColumnSizeA=this.adjustColumnSize;this.setColumnLabelA=this.setColumnLabel;this.setColumnLabel=function(S,W,V,U){var T=this;if(S<Q){T=this._fake}return this.setColumnLabelA.apply(T,[S,W,V,U])};this.adjustColumnSize=function(S,T){if(S<Q){if(_isIE){this._fake.obj.style.tableLayout=""}this._fake.adjustColumnSize(S,T);if(_isIE){this._fake.obj.style.tableLayout="fixed"}this._fake._correctSplit()}else{return this.adjustColumnSizeA(S,T)}};var C="cells";this._bfs_cells=this[C];this[C]=function(){return arguments[1]<Q?this._fake.cells.apply(this._fake,arguments):this._bfs_cells.apply(this,arguments)};this._bfs_isColumnHidden=this.isColumnHidden;this.isColumnHidden=function(){return parseInt(arguments[0])<Q?this._fake.isColumnHidden.apply(this._fake,arguments):this._bfs_isColumnHidden.apply(this,arguments)};this._bfs_setColumnHidden=this.setColumnHidden;this.setColumnHidden=function(){return parseInt(arguments[0])<Q?(this._fake.setColumnHidden.apply(this._fake,arguments),this._fake._correctSplit()):this._bfs_setColumnHidden.apply(this,arguments)};C="cells2";this._bfs_cells2=this[C];this[C]=function(){return arguments[1]<Q?this._fake.cells2.apply(this._fake,arguments):this._bfs_cells2.apply(this,arguments)};C="cells3";this._bfs_cells3=this[C];this[C]=function(S,T){if(arguments[1]<Q&&this._fake.rowsAr[arguments[0].idd]){if(this._fake.rowsAr[S.idd]&&this._fake.rowsAr[S.idd].childNodes.length==0){return this._bfs_cells3.apply(this,arguments)}arguments[0]=arguments[0].idd;return this._fake.cells.apply(this._fake,arguments)}else{return this._bfs_cells3.apply(this,arguments)}};C="changeRowId";this._bfs_changeRowId=this[C];this[C]=function(){this._bfs_changeRowId.apply(this,arguments);this._fake.rowsAr[arguments[0]]&&this._fake.changeRowId.apply(this._fake,arguments)};this._fake.getRowById=function(T){var S=this.rowsAr[T];!S&&this._fake.rowsAr[T]&&(S=this._fake.getRowById(T));if(S){if(S.tagName!="TR"){for(var U=0;U<this.rowsBuffer.length;U++){if(this.rowsBuffer[U]&&this.rowsBuffer[U].idd==T){return this.render_row(U)}}if(this._h2){return this.render_row(null,S.idd)}}return S}return null};if(this.collapseKids){this._fake._bfs_collapseKids=this.collapseKids,this._fake.collapseKids=function(S){return this._fake.collapseKids.apply(this._fake,[this._fake.rowsAr[S.idd]])},this._bfs_collapseKids=this.collapseKids,this.collapseKids=function(){var S=this._bfs_collapseKids.apply(this,arguments);this._fake._h2syncModel();this._cssSP||this._fake._fixAlterCss()},this._fake._bfs_expandKids=this.expandKids,this._fake.expandKids=function(S){this._fake.expandKids.apply(this._fake,[this._fake.rowsAr[S.idd]]);this._cssSP||this._fake._fixAlterCss()},this._bfs_expandAll=this.expandAll,this.expandAll=function(){this._bfs_expandAll();this._fake._h2syncModel();this._cssSP||this._fake._fixAlterCss()},this._bfs_collapseAll=this.collapseAll,this.collapseAll=function(){this._bfs_collapseAll();this._fake._h2syncModel();this._cssSP||this._fake._fixAlterCss()},this._bfs_expandKids=this.expandKids,this.expandKids=function(){var S=this._bfs_expandKids.apply(this,arguments);this._fake._h2syncModel();this._cssSP||this._fake._fixAlterCss()},this._fake._h2syncModel=function(){this._fake.pagingOn?this._fake._renderSort():this._renderSort()},this._updateTGRState=function(S){return this._fake._updateTGRState(S)}}if(this._elmnh){this._setRowHoverA=this._fake._setRowHoverA=this._setRowHover,this._unsetRowHoverA=this._fake._unsetRowHoverA=this._unsetRowHover,this._setRowHover=this._fake._setRowHover=function(){var T=this.grid;T._setRowHoverA.apply(this,arguments);var S=_isIE?event.srcElement:arguments[0].target;(S=T._fake.rowsAr[T.getFirstParentOfType(S,"TD").parentNode.idd])&&T._fake._setRowHoverA.apply(T._fake.obj,[{target:S.childNodes[0]},arguments[1]])},this._unsetRowHover=this._fake._unsetRowHover=function(){var S=arguments[1]?this:this.grid;S._unsetRowHoverA.apply(this,arguments);S._fake._unsetRowHoverA.apply(S._fake.obj,arguments)},this._fake.enableRowsHover(!0,this._hvrCss),this.enableRowsHover(!1),this.enableRowsHover(!0,this._fake._hvrCss)}this._updateTGRState=function(S){if(S.update&&S.id!=0){if(this.rowsAr[S.id].imgTag){this.rowsAr[S.id].imgTag.src=this.imgURL+S.state+".gif"}if(this._fake.rowsAr[S.id]&&this._fake.rowsAr[S.id].imgTag){this._fake.rowsAr[S.id].imgTag.src=this.imgURL+S.state+".gif"}S.update=!1}};this.copy_row=function(S){var X=S.cloneNode(!0);X._skipInsert=S._skipInsert;var W=Q;X._attrs={};X._css=S._css;if(this._ecspn){for(var V=W=0;W<X.childNodes.length&&V<Q;V+=X.childNodes[W].colSpan||1){W++}}for(;X.childNodes.length>W;){X.removeChild(X.childNodes[X.childNodes.length-1])}for(var U=W,V=0;V<U;V++){if(this.dragAndDropOff&&this.dragger.addDraggableItem(X.childNodes[V],this),X.childNodes[V].style.display=this._fake._hrrar?this._fake._hrrar[V]?"none":"":"",X.childNodes[V]._cellIndex=V,X.childNodes[V].combo_value=S.childNodes[V].combo_value,X.childNodes[V]._clearCell=S.childNodes[V]._clearCell,X.childNodes[V]._cellType=S.childNodes[V]._cellType,X.childNodes[V]._brval=S.childNodes[V]._brval,X.childNodes[V]._attrs=S.childNodes[V]._attrs,X.childNodes[V].chstate=S.childNodes[V].chstate,S._attrs.style&&(X.childNodes[V].style.cssText+=";"+S._attrs.style),X.childNodes[V].colSpan>1){this._childIndexes=this._fake._childIndexes}}if(this._h2&&this._treeC<Q){var T=this._h2.get[S.idd];X.imgTag=X.childNodes[this._treeC].childNodes[0].childNodes[T.level];X.valTag=X.childNodes[this._treeC].childNodes[0].childNodes[T.level+2]}X.idd=S.idd;X.grid=this._fake;return X};C="_insertRowAt";this._bfs_insertRowAt=this[C];this[C]=function(){var T=this._bfs_insertRowAt.apply(this,arguments);arguments[0]=this.copy_row(arguments[0]);var S=this._fake._insertRowAt.apply(this._fake,arguments);if(T._fhd){S.parentNode.removeChild(S),this._fake.rowsCol._dhx_removeAt(this._fake.rowsCol._dhx_find(S)),T._fhd=!1}return T};this._bfs_setSizes=this.setSizes;this.setSizes=function(){if(!this._notresize){this._bfs_setSizes(this,arguments),this.sync_headers(),this.sync_scroll()&&this._ahgr&&this.setSizes(),this._fake.entBox.style.height=this.entBox.style.height,this._fake.objBox.style.height=this.objBox.style.height,this._fake.hdrBox.style.height=this.hdrBox.style.height,this._fake.objBox.scrollTop=this.objBox.scrollTop,this._fake.setColumnSizes(this._fake.entBox.clientWidth),this.globalBox.style.width=parseInt(this.entBox.style.width)+parseInt(this._fake.entBox.style.width),this.globalBox.style.height=this.entBox.style.height}};this.sync_scroll=this._fake.sync_scroll=function(T){var S=this.objBox.style.overflowX;if(this.obj.offsetWidth<=this.objBox.offsetWidth){if(!T){return this._fake.sync_scroll(!0)}this.objBox.style.overflowX="hidden";this._fake.objBox.style.overflowX="hidden"}else{this.objBox.style.overflowX="scroll",this._fake.objBox.style.overflowX="scroll"}return S!=this.objBox.style.overflowX};this.sync_headers=this._fake.sync_headers=function(){if(!(this.noHeader||this._fake.hdr.scrollHeight==this.hdr.offsetHeight)){for(var S=1;S<this.hdr.rows.length;S++){var U=this.hdr.rows[S].scrollHeight,T=this._fake.hdr.rows[S].scrollHeight;if(U!=T){this._fake.hdr.rows[S].style.height=this.hdr.rows[S].style.height=Math.max(U,T)+"px"}if(window._KHTMLrv){this._fake.hdr.rows[S].childNodes[0].style.height=this.hdr.rows[S].childNodes[Q].style.height=Math.max(U,T)+"px"}}}};this._fake._bfs_setSizes=this._fake.setSizes;this._fake.setSizes=function(){this._fake._notresize||this._fake.setSizes()};C="_doOnScroll";this._bfs__doOnScroll=this[C];this[C]=function(){this._bfs__doOnScroll.apply(this,arguments);this._fake.objBox.scrollTop=this.objBox.scrollTop;this._fake._doOnScroll.apply(this._fake,arguments)};C="selectAll";this._bfs__selectAll=this[C];this[C]=function(){this._bfs__selectAll.apply(this,arguments);this._bfs__selectAll.apply(this._fake,arguments)};C="doClick";this._bfs_doClick=this[C];this[C]=function(){this._bfs_doClick.apply(this,arguments);if(arguments[0].tagName=="TD"){var S=arguments[0]._cellIndex>=Q;if(arguments[0].parentNode.idd){if(!S){arguments[0].className=arguments[0].className.replace(/cellselected/g,"")}this._fake.rowsAr[arguments[0].parentNode.idd]||this._fake.render_row(this.getRowIndex(arguments[0].parentNode.idd));arguments[0]=this._fake.cells(arguments[0].parentNode.idd,S?0:arguments[0]._cellIndex).cell;if(S){this._fake.cell=null}this._fake._bfs_doClick.apply(this._fake,arguments);S?this._fake.cell=this.cell:this.cell=this._fake.cell;this._fake.onRowSelectTime&&clearTimeout(this._fake.onRowSelectTime);S?(arguments[0].className=arguments[0].className.replace(/cellselected/g,""),globalActiveDHTMLGridObject=this,this._fake.cell=this.cell):this.objBox.scrollTop=this._fake.objBox.scrollTop}}};this._fake._bfs_doClick=this._fake[C];this._fake[C]=function(){this._bfs_doClick.apply(this,arguments);if(arguments[0].tagName=="TD"){var S=arguments[0]._cellIndex<Q;if(arguments[0].parentNode.idd&&(arguments[0]=this._fake._bfs_cells(arguments[0].parentNode.idd,S?Q:arguments[0]._cellIndex).cell,this._fake.cell=null,this._fake._bfs_doClick.apply(this._fake,arguments),this._fake.cell=this.cell,this._fake.onRowSelectTime&&clearTimeout(this._fake.onRowSelectTime),S)){arguments[0].className=arguments[0].className.replace(/cellselected/g,""),globalActiveDHTMLGridObject=this,this._fake.cell=this.cell,this._fake.objBox.scrollTop=this.objBox.scrollTop}}};this.clearSelectionA=this.clearSelection;this.clearSelection=function(S){S&&this._fake.clearSelection();this.clearSelectionA()};this.moveRowUpA=this.moveRowUp;this.moveRowUp=function(S){this._h2||this._fake.moveRowUp(S);this.moveRowUpA(S);this._h2&&this._fake._h2syncModel()};this.moveRowDownA=this.moveRowDown;this.moveRowDown=function(S){this._h2||this._fake.moveRowDown(S);this.moveRowDownA(S);this._h2&&this._fake._h2syncModel()};this._fake.getUserData=function(){return this._fake.getUserData.apply(this._fake,arguments)};this._fake.setUserData=function(){return this._fake.setUserData.apply(this._fake,arguments)};this.getSortingStateA=this.getSortingState;this.getSortingState=function(){var S=this.getSortingStateA();return S.length!=0?S:this._fake.getSortingState()};this.setSortImgStateA=this._fake.setSortImgStateA=this.setSortImgState;this.setSortImgState=function(S,V,U,T){this.setSortImgStateA(S,V,U,T);V*1<Q?(this._fake.setSortImgStateA(S,V,U,T),this.setSortImgStateA(!1)):this._fake.setSortImgStateA(!1)};this._fake.doColResizeA=this._fake.doColResize;this._fake.doColResize=function(S,Y,X,W,V){var U=-1,T=0;if(arguments[1]._cellIndex==Q-1){U=this._initalSplR+(S.clientX-W);if(!this._initalSplF){this._initalSplF=arguments[3]+this.objBox.scrollWidth-this.objBox.offsetWidth}if(this.objBox.scrollWidth==this.objBox.offsetWidth&&(this._fake.alter_split_resize||S.clientX-W>0)){arguments[3]=this._initalSplF||arguments[3]}}else{if(this.obj.offsetWidth<this.entBox.offsetWidth){U=this.obj.offsetWidth}}T=this.doColResizeA.apply(this,arguments);this._correctSplit(U);this.resized=this._fake.resized=1;return T};this._fake.changeCursorState=function(T){var S=T.target||T.srcElement;S.tagName!="TD"&&(S=this.getFirstParentOfType(S,"TD"));if(!(S.tagName=="TD"&&this._drsclmn&&!this._drsclmn[S._cellIndex])){var V=(T.layerX||0)+(!_isIE&&T.target.tagName=="DIV"?S.offsetLeft:0),U=parseInt(this.getPosition(S,this.hdrBox));S.style.cursor=S.offsetWidth-(T.offsetX||(U-V)*-1)<(_isOpera?20:10)||this.entBox.offsetWidth-(T.offsetX?T.offsetX+S.offsetLeft:V)+this.objBox.scrollLeft-0<(_isOpera?20:10)?"E-resize":"default";if(_isOpera){this.hdrBox.scrollLeft=this.objBox.scrollLeft}}};this._fake.startColResizeA=this._fake.startColResize;this._fake.startColResize=function(T){var S=this.startColResizeA(T);this._initalSplR=this.entBox.offsetWidth;this._initalSplF=null;if(this.entBox.onmousemove){var U=this.entBox.parentNode;if(U._aggrid){return S}U._aggrid=U.grid;U.grid=this;this.entBox.parentNode.onmousemove=this.entBox.onmousemove;this.entBox.onmousemove=null}return S};this._fake.stopColResizeA=this._fake.stopColResize;this._fake.stopColResize=function(T){if(this.entBox.parentNode.onmousemove){var S=this.entBox.parentNode;S.grid=S._aggrid;S._aggrid=null;this.entBox.onmousemove=this.entBox.parentNode.onmousemove;this.entBox.parentNode.onmousemove=null;this.obj.offsetWidth<this.entBox.offsetWidth&&this._correctSplit(this.obj.offsetWidth)}return this.stopColResizeA(T)};this.doKeyA=this.doKey;this._fake.doKeyA=this._fake.doKey;this._fake.doKey=this.doKey=function(S){if(!S){return !0}if(this._htkebl){return !0}if((S.target||S.srcElement).value!==window.undefined){var V=S.target||S.srcElement;if(!V.parentNode||V.parentNode.className.indexOf("editable")==-1){return !0}}switch(S.keyCode){case 9:if(S.shiftKey){if(this._realfake){if(this.cell&&this.cell._cellIndex==0){S.preventDefault&&S.preventDefault();if(T=this._fake.rowsBuffer[this._fake.getRowIndex(this.cell.parentNode.idd)-1]){this._fake.showRow(T.idd);for(U=this._fake._cCount-1;T.childNodes[U].style.display=="none";){U--}this._fake.selectCell(this._fake.getRowIndex(T.idd),U,!1,!1,!0)}return !1}}else{if(this.cell&&this.cell._cellIndex==Q){return S.preventDefault&&S.preventDefault(),this._fake.selectCell(this.getRowIndex(this.cell.parentNode.idd),Q-1,!1,!1,!0),!1}}}else{if(this._realfake){if(this.cell&&this.cell._cellIndex==Q-1){S.preventDefault&&S.preventDefault();for(var U=Q;this._fake._hrrar&&this._fake._hrrar[U];){U++}this._fake.selectCell(this._fake.getRowIndex(this.cell.parentNode.idd),U,!1,!1,!0);return !1}else{var T=this.doKeyA(S)}globalActiveDHTMLGridObject=this;return T}else{if(this.cell){for(U=this.cell._cellIndex+1;this.rowsCol[0].childNodes[U]&&this.rowsCol[0].childNodes[U].style.display=="none";){U++}if(U==this.rowsCol[0].childNodes.length&&(S.preventDefault&&S.preventDefault(),T=this.rowsBuffer[this.getRowIndex(this.cell.parentNode.idd)+1])){return this.showRow(T.idd),this._fake.selectCell(this._fake.getRowIndex(T.idd),0,!1,!1,!0),!1}}}}}return this.doKeyA(S)};this.editCellA=this.editCell;this.editCell=function(){return this.cell&&this.cell.parentNode.grid!=this?this._fake.editCell():this.editCellA()};this.deleteRowA=this.deleteRow;this.deleteRow=function(T,S){if(this.deleteRowA(T,S)===!1){return !1}this._fake.rowsAr[T]&&this._fake.deleteRow(T)};this.clearAllA=this.clearAll;this.clearAll=function(){this.clearAllA();this._fake.clearAll()};this.editStopA=this.editStop;this.editStop=function(){this._fake.editor?this._fake.editStop():this.editStopA()};this.attachEvent("onAfterSorting",function(S){S>=Q&&this._fake.setSortImgState(!1)});this._fake.sortField=function(T,S){this._fake.sortField.call(this._fake,T,S,this._fake.hdr.rows[0].cells[T]);if(this.fldSort[T]!="na"&&this._fake.fldSorted){var U=this._fake.getSortingState()[1];this._fake.setSortImgState(!1);this.setSortImgState(!0,T,U)}};this.sortTreeRowsA=this.sortTreeRows;this._fake.sortTreeRowsA=this._fake.sortTreeRows;this.sortTreeRows=this._fake.sortTreeRows=function(T,S,V,U){if(this._realfake){return this._fake.sortTreeRows(T,S,V,U)}this.sortTreeRowsA(T,S,V,U);this._fake._h2syncModel();this._fake.setSortImgStateA(!1);this._fake.fldSorted=null};this._fake._fillers=[];this._fake.rowsBuffer=this.rowsBuffer;this.attachEvent("onClearAll",function(){this._fake.rowsBuffer=this.rowsBuffer});this._add_filler_s=this._add_filler;this._add_filler=function(T,S,W,V){if(!V){if(!this._fake._fillers){this._fake._fillers=[]}var U;if(W){if(W.idd){U=this._fake.rowsAr[W.idd]}else{if(W.nextSibling){U={},U.nextSibling=this._fake.rowsAr[W.nextSibling.idd],U.parentNode=U.nextSibling.parentNode}}}this._fake._fillers.push(this._fake._add_filler(T,S,U))}return this._add_filler_s.apply(this,arguments)};this._add_from_buffer_s=this._add_from_buffer;this._add_from_buffer=function(){var S=this._add_from_buffer_s.apply(this,arguments);S!=-1&&(this._fake._add_from_buffer.apply(this._fake,arguments),this.multiLine&&this._correctRowHeight(this.rowsBuffer[arguments[0]].idd));return S};this._fake.render_row=function(T){var S=this._fake.render_row(T);return S==-1?-1:S?this.rowsAr[S.idd]=this.rowsAr[S.idd]||this._fake.copy_row(S):null};this._reset_view_s=this._reset_view;this._reset_view=function(){this._fake._reset_view(!0);this._fake._fillers=[];this._reset_view_s()};this.moveColumn_s=this.moveColumn;this.moveColumn=function(S,T){if(T>=Q){return this.moveColumn_s(S,T)}};this.attachEvent("onCellChanged",function(S,W,V){if(this._split_event&&W<Q&&this.rowsAr[S]){var U=this._fake.rowsAr[S];if(U){var U=U._childIndexes?U.childNodes[U._childIndexes[W]]:U.childNodes[W],T=this.rowsAr[S].childNodes[W];T._treeCell&&T.firstChild.lastChild?T.firstChild.lastChild.innerHTML=V:T.innerHTML=U.innerHTML;T._clearCell=!1;T.chstate=U.chstate}}});this._fake.combos=this.combos;this.setSizes();this.rowsBuffer[0]&&this._reset_view();this.attachEvent("onXLE",function(){this._fake._correctSplit()});this._fake._correctSplit()};dhtmlXGridObject.prototype._correctSplit=function(C){C=C||this.obj.scrollWidth-this.objBox.scrollLeft;C=Math.min(this.globalBox.offsetWidth,C);if(C>-1){this.entBox.style.width=C+"px";this.objBox.style.width=C+"px";var D=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;this._fake.entBox.style.left=C+"px";this._fake.entBox.style.width=Math.max(0,this.globalBox.offsetWidth-C-(this.quirks?0:2)*D)+"px";if(this._fake.ftr){this._fake.ftr.parentNode.style.width=this._fake.entBox.style.width}if(_isIE){var A=_isIE&&!window.xmlHttpRequest,D=this.globalBox.offsetWidth-this.globalBox.clientWidth;this._fake.hdrBox.style.width=this._fake.objBox.style.width=Math.max(0,this.globalBox.offsetWidth-(A?D:0)-C)+"px"}}};dhtmlXGridObject.prototype._correctRowHeight=function(C){if(this.rowsAr[C]&&this._fake.rowsAr[C]){var E=this.rowsAr[C].offsetHeight,A=this._fake.rowsAr[C].offsetHeight,D=Math.max(E,A);if(D&&(this.rowsAr[C].style.height=this._fake.rowsAr[C].style.height=D+"px",window._KHTMLrv)){this.rowsAr[C].childNodes[this._fake._cCount].style.height=this._fake.rowsAr[C].firstChild.style.height=D+"px"}}};function eXcell_dhxCalendar(C){if(C&&(this.cell=C,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var E=this.grid._grid_calendarA=new dhtmlxCalendarObject;this.grid.callEvent("onDhxCalendarCreated",[E]);var A=this.grid;E.attachEvent("onClick",function(){this._last_operation_calendar=!0;window.setTimeout(function(){A.editStop()},1);return !0});var D=function(F){(F||event).cancelBubble=!0};dhtmlxEvent(E.base,"click",D);E=null}}eXcell_dhxCalendar.prototype=new eXcell;eXcell_dhxCalendar.prototype.edit=function(){var A=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1);this.grid._grid_calendarA.setPosition(A[0],A[1]+this.cell.offsetHeight);this.grid._grid_calendarA._last_operation_calendar=!1;this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.cell._cediton=!0;this.val=this.cell.val;this._val=this.cell.innerHTML;var C=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){};this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y");this.grid._grid_calendarA.setDate(this.val||new Date);this.grid._grid_calendarA.draw=C};eXcell_dhxCalendar.prototype.getDate=function(){return this.cell.val?this.cell.val:null};eXcell_dhxCalendar.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()};eXcell_dhxCalendar.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){this.cell._cediton=!1;if(this.grid._grid_calendarA._last_operation_calendar){var C=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),D=this.grid._grid_calendarA.getDate();this.cell.val=new Date(D);this.setCValue(C,D);this.cell._clearCell=!C;var A=this.val;this.val=this._val;return this.cell.val.valueOf()!=A}return !1}};eXcell_dhxCalendar.prototype.setValue=function(A){typeof A=="object"?(this.cell.val=A,this.cell._clearCell=!1,this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",A).toString(),this.cell.val)):(!A||A.toString()._dhx_trim()==""?(A="&nbsp",this.cell._clearCell=!0,this.cell.val=""):(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",A.toString(),null,!0)),this.grid._dtmask_inc&&(A=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))),this.cell.val=="NaN"||this.cell.val=="Invalid Date"?(this.cell._clearCell=!0,this.cell.val=new Date,this.setCValue("&nbsp;",0)):this.setCValue((A||"").toString(),this.cell.val))};function eXcell_dhxCalendarA(C){if(C&&(this.cell=C,this.grid=this.cell.parentNode.grid,!this.grid._grid_calendarA)){var E=this.grid._grid_calendarA=new dhtmlxCalendarObject(!1,!1,{isYearEditable:!0});this.grid.callEvent("onDhxCalendarCreated",[E]);var A=this.grid;E.attachEvent("onClick",function(){this._last_operation_calendar=!0;window.setTimeout(function(){A.editStop()},1);return !0});var D=function(F){(F||event).cancelBubble=!0};dhtmlxEvent(E.base,"click",D)}}eXcell_dhxCalendarA.prototype=new eXcell;eXcell_dhxCalendarA.prototype.edit=function(){var A=this.grid.getPosition(this.cell);this.grid._grid_calendarA._show(!1,!1);this.grid._grid_calendarA.setPosition(A[0]*1+this.cell.offsetWidth,A[1]*1);this.grid.callEvent("onCalendarShow",[this.grid._grid_calendarA,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid._grid_calendarA._last_operation_calendar=!1;this.cell._cediton=!0;this.val=this.cell.val;this._val=this.cell.innerHTML;var C=this.grid._grid_calendarA.draw;this.grid._grid_calendarA.draw=function(){};this.grid._grid_calendarA.setDateFormat(this.grid._dtmask||"%d/%m/%Y");this.grid._grid_calendarA.setDate(this.val);this.grid._grid_calendarA.draw=C;this.grid._grid_calendarA.draw();this.cell.atag=!this.grid.multiLine&&(_isKHTML||_isMacOS||_isFF)?"INPUT":"TEXTAREA";this.obj=document.createElement(this.cell.atag);this.obj.style.height=this.cell.offsetHeight-(_isIE?4:2)+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.align;this.obj.onclick=function(D){(D||event).cancelBubble=!0};this.obj.onmousedown=function(D){(D||event).cancelBubble=!0};this.obj.value=this.getValue();this.cell.innerHTML="";this.cell.appendChild(this.obj);if(_isFF&&(this.obj.style.overflow="visible",this.grid.multiLine&&this.obj.offsetHeight>=18&&this.obj.offsetHeight<40)){this.obj.style.height="36px",this.obj.style.overflow="scroll"}this.obj.onselectstart=function(D){D||(D=event);return D.cancelBubble=!0};this.obj.focus();this.obj.focus()};eXcell_dhxCalendarA.prototype.getDate=function(){return this.cell.val?this.cell.val:null};eXcell_dhxCalendarA.prototype.getValue=function(){return this.cell._clearCell?"":this.grid._dtmask_inc&&this.cell.val?this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc,this.cell.val).toString():this.cell.innerHTML.toString()._dhx_trim()};eXcell_dhxCalendarA.prototype.detach=function(){if(this.grid._grid_calendarA&&(this.grid._grid_calendarA.hide(),this.cell._cediton)){this.cell._cediton=!1;if(this.grid._grid_calendarA._last_operation_calendar){this.grid._grid_calendarA._last_operation_calendar=!1;var C=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y"),D=this.grid._grid_calendarA.getDate();this.cell.val=new Date(D);this.setCValue(C,D);this.cell._clearCell=!C;var A=this.val;this.val=this._val;return this.cell.val.valueOf()!=(A|0).valueOf()}this.setValue(this.obj.value);A=this.val;this.val=this._val;return this.cell.val.valueOf()!=(A||"").valueOf()}};eXcell_dhxCalendarA.prototype.setValue=function(A){typeof A=="object"?(this.cell.val=A,this.cell._clearCell=!1,this.setCValue(this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",A).toString(),this.cell.val)):(!A||A.toString()._dhx_trim()==""?(A="&nbsp",this.cell._clearCell=!0,this.cell.val=""):(this.cell._clearCell=!1,this.cell.val=new Date(this.grid._grid_calendarA.setFormatedDate(this.grid._dtmask_inc||this.grid._dtmask||"%d/%m/%Y",A.toString(),null,!0)),this.grid._dtmask_inc&&(A=this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask||"%d/%m/%Y",this.cell.val))),this.cell.val=="NaN"||this.cell.val=="Invalid Date"?(this.cell.val=new Date,this.cell._clearCell=!0,this.setCValue("&nbsp;",0)):this.setCValue((A||"").toString(),this.cell.val))};function eXcell_cntr(A){this.cell=A;this.grid=this.cell.parentNode.grid;if(!this.grid._ex_cntr_ready&&!this._realfake){this.grid._ex_cntr_ready=!0,this.grid._h2&&this.grid.attachEvent("onOpenEn",function(){this.resetCounter(A._cellIndex)}),this.grid.attachEvent("onBeforeSorting",function(){var C=this;window.setTimeout(function(){C.resetCounter&&(C._fake&&!C._realfake&&A._cellIndex<C._fake._cCount?C._fake.resetCounter(A._cellIndex):C.resetCounter(A._cellIndex))},1);return !0})}this.edit=function(){};this.getValue=function(){return this.cell.innerHTML};this.setValue=function(){this.cell.style.paddingRight="2px";var C=this.cell;window.setTimeout(function(){if(C.parentNode){var D=C.parentNode.rowIndex;if(C.parentNode.grid.currentPage||D<0||C.parentNode.grid._srnd){D=C.parentNode.grid.rowsBuffer._dhx_find(C.parentNode)+1}if(!(D<=0)){C.innerHTML=D,C.parentNode.grid._fake&&C._cellIndex<C.parentNode.grid._fake._cCount&&C.parentNode.grid._fake.rowsAr[C.parentNode.idd]&&C.parentNode.grid._fake.cells(C.parentNode.idd,C._cellIndex).setCValue(D),C=null}}},100)}}dhtmlXGridObject.prototype.resetCounter=function(A){this._fake&&!this._realfake&&A<this._fake._cCount&&this._fake.resetCounter(A,this.currentPage);var C=A||0;this.currentPage&&(C=(this.currentPage-1)*this.rowsBufferOutSize);for(C=0;C<this.rowsBuffer.length;C++){if(this.rowsBuffer[C]&&this.rowsBuffer[C].tagName=="TR"&&this.rowsAr[this.rowsBuffer[C].idd]){this.rowsAr[this.rowsBuffer[C].idd].childNodes[A].innerHTML=C+1}}};eXcell_cntr.prototype=new eXcell;function eXcell_link(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.isDisabled=function(){return !0};this.edit=function(){};this.getValue=function(){return this.cell.firstChild.getAttribute?this.cell.firstChild.innerHTML+"^"+this.cell.firstChild.getAttribute("href"):""};this.setValue=function(D){if(typeof D!="number"&&(!D||D.toString()._dhx_trim()=="")){return this.setCValue("&nbsp;",C),this.cell._clearCell=!0}var C=D.split("^");C.length==1?C[1]="":C.length>1&&(C[1]="href='"+C[1]+"'",C[1]+=C.length==3?" target='"+C[2]+"'":" target='_blank'");this.setCValue("<a "+C[1]+" onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>"+C[0]+"</a>",C)}}eXcell_link.prototype=new eXcell;eXcell_link.prototype.getTitle=function(){var A=this.cell.firstChild;return A&&A.tagName?A.getAttribute("href"):""};eXcell_link.prototype.getContent=function(){var A=this.cell.firstChild;return A&&A.tagName?A.innerHTML:""};function eXcell_clist(A){try{this.cell=A,this.grid=this.cell.parentNode.grid}catch(C){}this.edit=function(){this.val=this.getValue();var D=this.cell._combo||this.grid.clists[this.cell._cellIndex];if(D){this.obj=document.createElement("DIV");for(var K=this.val.split(","),J="",F=0;F<D.length;F++){for(var H=!1,I=0;I<K.length;I++){D[F]==K[I]&&(H=!0)}J+=H?"<div><input type='checkbox' checked='true' /><label>"+D[F]+"</label></div>":"<div><input type='checkbox' id='ch_lst_"+F+"'/><label>"+D[F]+"</label></div>"}J+="<div><input type='button' value='Apply' style='width:100px; font-size:8pt;' onclick='this.parentNode.parentNode.editor.grid.editStop();'/></div>";this.obj.editor=this;this.obj.innerHTML=J;document.body.appendChild(this.obj);this.obj.style.position="absolute";this.obj.className="dhx_clist";this.obj.onclick=function(L){return(L||event).cancelBubble=!0};var E=this.grid.getPosition(this.cell);this.obj.style.left=E[0]+"px";this.obj.style.top=E[1]+this.cell.offsetHeight+"px";this.obj.getValue=function(){for(var M="",L=0;L<this.childNodes.length-1;L++){this.childNodes[L].childNodes[0].checked&&(M&&(M+=","),M+=this.childNodes[L].childNodes[1].innerHTML)}return M}}};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){if(this.obj){this.setValue(this.obj.getValue()),this.obj.editor=null,this.obj.parentNode.removeChild(this.obj),this.obj=null}return this.val!=this.getValue()}}eXcell_clist.prototype=new eXcell;eXcell_clist.prototype.setValue=function(C){if(typeof C=="object"){var D=this.grid.xmlLoader.doXPath("./option",C);if(D.length){this.cell._combo=[]}for(var A=0;A<D.length;A++){this.cell._combo.push(D[A].firstChild?D[A].firstChild.data:"")}C=C.firstChild.data}C===""||C===this.undefined?(this.setCTxtValue(" ",C),this.cell._clearCell=!0):(this.setCValue(C),this.cell._clearCell=!1)};dhtmlXGridObject.prototype.registerCList=function(A,C){if(!this.clists){this.clists=[]}typeof C!="object"&&(C=C.split(","));this.clists[A]=C};function dhtmlXToolbarObject(C,D){var A=this;for(this.cont=typeof C!="object"?document.getElementById(C):C;this.cont.childNodes.length>0;){this.cont.removeChild(this.cont.childNodes[0])}this.cont.dir="ltr";this.cont.innerHTML+="<div class='dhxtoolbar_hdrline_ll'></div><div class='dhxtoolbar_hdrline_rr'></div><div class='dhxtoolbar_hdrline_l'></div><div class='dhxtoolbar_hdrline_r'></div>";this.base=document.createElement("DIV");this.base.className="float_left";this.cont.appendChild(this.base);this.align="left";this.setAlign=function(E){this.align=E=="right"?"right":"left";this.base.className=E=="right"?"float_right":"float_left";if(this._spacer){this._spacer.className="dhxtoolbar_spacer "+(E=="right"?" float_left":" float_right")}};this._isIE6=!1;if(_isIE){this._isIE6=window.XMLHttpRequest==null?!0:!1}if(this._isIPad=navigator.userAgent.search(/iPad/gi)>=0){this.cont.ontouchstart=function(E){E=E||event;E.returnValue=!1;E.cancelBubble=!0;return !1}}this.selectPolygonOffsetLeft=this.selectPolygonOffsetTop=0;this.setSkin=function(F){this.skin=F;if(this.skin=="dhx_skyblue"){this.selectPolygonOffsetTop=2}if(this.skin=="dhx_web"){this.selectPolygonOffsetLeft=this.selectPolygonOffsetTop=1}this.cont.className="dhx_toolbar_base_"+this.skin+(this.rtl?" rtl":"");for(var E in this.objPull){var H=this.objPull[E];if(H.type=="slider"){H.pen._detectLimits(),H.pen._definePos(),H.label.className="dhx_toolbar_slider_label_"+this.skin+(this.rtl?" rtl":"")}if(H.type=="buttonSelect"){H.polygon.className="dhx_toolbar_poly_"+this.skin+(this.rtl?" rtl":"")}}};this.setSkin(D==null?"dhx_skyblue":D);this.objPull={};this.anyUsed="none";this.imagePath="";this.setIconPath=this.setIconsPath=function(E){this.imagePath=E};this._doOnLoad=function(){};this.loadXML=function(F,E){if(E!=null){this._doOnLoad=function(){E()}}this.callEvent("onXLS",[]);this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXML(F)};this.loadXMLString=function(F,E){if(E!=null){this._doOnLoad=function(){E()}}this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXMLString(F)};this._xmlParser=function(){for(var T=this.getXMLTopNode("toolbar"),S="id,type,hidden,title,text,enabled,img,imgdis,action,openAll,renderSelect,maxOpen,width,value,selected,length,textMin,textMax,toolTip,valueMin,valueMax,valueNow".split(","),O="id,type,enabled,disabled,action,selected,img,text".split(","),P=0;P<T.childNodes.length;P++){if(T.childNodes[P].tagName=="item"){for(var Q={},N=0;N<S.length;N++){Q[S[N]]=T.childNodes[P].getAttribute(S[N])}Q.items=[];Q.userdata=[];for(var M=0;M<T.childNodes[P].childNodes.length;M++){if(T.childNodes[P].childNodes[M].tagName=="item"&&Q.type=="buttonSelect"){for(var L={},N=0;N<O.length;N++){L[O[N]]=T.childNodes[P].childNodes[M].getAttribute(O[N])}try{L.itemText=T.childNodes[P].childNodes[M].getElementsByTagName("itemText")[0].firstChild.nodeValue}catch(K){}for(var J=T.childNodes[P].childNodes[M].getElementsByTagName("userdata"),N=0;N<J.length;N++){if(!L.userdata){L.userdata={}}var H={};try{H.name=J[N].getAttribute("name")}catch(I){H.name=""}try{H.value=J[N].firstChild.nodeValue}catch(F){H.value=""}if(H.name!=""){L.userdata[H.name]=H.value}}Q.items[Q.items.length]=L}if(T.childNodes[P].childNodes[M].tagName=="userdata"){L={};try{L.name=T.childNodes[P].childNodes[M].getAttribute("name")}catch(E){L.name=""}try{L.value=T.childNodes[P].childNodes[M].firstChild.nodeValue}catch(U){L.value=""}Q.userdata[Q.userdata.length]=L}}A._addItemToStorage(Q)}}A.callEvent("onXLE",[]);A._doOnLoad();this.destructor()};this._addItemToStorage=function(F,E){var J=F.id||this._genStr(24),H=F.type||"";if(H!=""&&this["_"+H+"Object"]!=null){this.objPull[this.idPrefix+J]=new this["_"+H+"Object"](this,J,F),this.objPull[this.idPrefix+J].type=H,this.setPosition(J,E)}if(F.userdata){for(var I=0;I<F.userdata.length;I++){this.setUserData(J,F.userdata[I].name,F.userdata[I].value)}}};this._genStr=function(F){for(var E="",I="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",H=0;H<F;H++){E+=I.charAt(Math.round(Math.random()*(I.length-1)))}return E};this.rootTypes="button,buttonSelect,buttonTwoState,separator,label,slider,text,buttonInput".split(",");this.idPrefix=this._genStr(12);dhtmlxEventable(this);this._getObj=function(F,E){for(var I=null,H=0;H<F.childNodes.length;H++){F.childNodes[H].tagName!=null&&String(F.childNodes[H].tagName).toLowerCase()==String(E).toLowerCase()&&(I=F.childNodes[H])}return I};this._addImgObj=function(F){var E=document.createElement("IMG");F.childNodes.length>0?F.insertBefore(E,F.childNodes[0]):F.appendChild(E);return E};this._setItemImage=function(F,E,I){I==!0?F.imgEn=E:F.imgDis=E;if(!(!F.state&&I==!0||F.state&&I==!1)){var H=this._getObj(F.obj,"img");H==null&&(H=this._addImgObj(F.obj));H.src=this.imagePath+E}};this._clearItemImage=function(F,E){E==!0?F.imgEn="":F.imgDis="";if(!(!F.state&&E==!0||F.state&&E==!1)){var H=this._getObj(F.obj,"img");H!=null&&H.parentNode.removeChild(H)}};this._setItemText=function(F,E){var H=this._getObj(F.obj,"div");E==null||E.length==0?H!=null&&H.parentNode.removeChild(H):(H==null&&(H=document.createElement("DIV"),F.obj.appendChild(H)),H.innerHTML=E)};this._getItemText=function(F){var E=this._getObj(F.obj,"div");return E!=null?E.innerHTML:""};this._enableItem=function(F){if(!F.state){F.state=!0;this.objPull[F.id].type=="buttonTwoState"&&this.objPull[F.id].obj.pressed==!0?(F.obj.className="dhx_toolbar_btn pres",F.obj.renderAs="dhx_toolbar_btn over"):(F.obj.className="dhx_toolbar_btn def",F.obj.renderAs=F.obj.className);if(F.arw){F.arw.className=String(F.obj.className).replace("btn","arw")}var E=this._getObj(F.obj,"img");F.imgEn!=""?(E==null&&(E=this._addImgObj(F.obj)),E.src=this.imagePath+F.imgEn):E!=null&&E.parentNode.removeChild(E)}};this._disableItem=function(F){if(F.state){F.state=!1;F.obj.className="dhx_toolbar_btn dis";F.obj.renderAs="dhx_toolbar_btn def";if(F.arw){F.arw.className=String(F.obj.className).replace("btn","arw")}var E=this._getObj(F.obj,"img");F.imgDis!=""?(E==null&&(E=this._addImgObj(F.obj)),E.src=this.imagePath+F.imgDis):E!=null&&E.parentNode.removeChild(E);if(F.polygon!=null&&F.polygon.style.display!="none"&&(F.polygon.style.display="none",F.polygon._ie6cover)){F.polygon._ie6cover.style.display="none"}this.anyUsed="none"}};this.clearAll=function(){for(var E in this.objPull){this._removeItem(String(E).replace(this.idPrefix,""))}};this._isWebToolbar=!0;this._doOnClick=function(){A.forEachItem(function(E){if(A.objPull[A.idPrefix+E].type=="buttonSelect"){var F=A.objPull[A.idPrefix+E];if(F.polygon.style.display!="none"&&(F.obj.renderAs="dhx_toolbar_btn def",F.obj.className=F.obj.renderAs,F.arw.className=String(F.obj.renderAs).replace("btn","arw"),A.anyUsed="none",F.polygon.style.display="none",F.polygon._ie6cover)){F.polygon._ie6cover.style.display="none"}}})};this._isIPad?document.addEventListener("touchstart",this._doOnClick,!1):_isIE?document.body.attachEvent("onclick",this._doOnClick):window.addEventListener("click",this._doOnClick,!1);return this}dhtmlXToolbarObject.prototype.addSpacer=function(C){var I=this.idPrefix+C;if(this._spacer!=null){if(this._spacer.idd!=C){if(this._spacer==this.objPull[I].obj.parentNode){for(var A=!0;A;){var H=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]);if(H==C||this._spacer.childNodes.length==0){this.objPull[I].arw!=null&&this.base.appendChild(this.objPull[I].arw),A=!1}}this._spacer.idd=C}else{if(this.base==this.objPull[I].obj.parentNode){for(var A=!0,F=this.objPull[I].arw!=null;A;){var D=this.base.childNodes.length-1;F==!0&&this.base.childNodes[D]==this.objPull[I].arw&&(A=!1);this.base.childNodes[D].idd==C&&(A=!1);A&&(this._spacer.childNodes.length>0?this._spacer.insertBefore(this.base.childNodes[D],this._spacer.childNodes[0]):this._spacer.appendChild(this.base.childNodes[D]))}this._spacer.idd=C}}}}else{for(var E=null,D=0;D<this.base.childNodes.length;D++){this.base.childNodes[D]==this.objPull[this.idPrefix+C].obj&&(E=D,this.objPull[this.idPrefix+C].arw!=null&&(E=D+1))}if(E!=null){this._spacer=document.createElement("DIV");this._spacer.className="dhxtoolbar_spacer "+(this.align=="right"?" float_left":" float_right");this._spacer.dir="rtl";for(this._spacer.idd=C;this.base.childNodes.length>E+1;){this._spacer.appendChild(this.base.childNodes[E+1])}this.cont.appendChild(this._spacer)}}};dhtmlXToolbarObject.prototype.removeSpacer=function(){if(this._spacer){for(;this._spacer.childNodes.length>0;){this.base.appendChild(this._spacer.childNodes[0])}this._spacer.parentNode.removeChild(this._spacer);this._spacer=null}};dhtmlXToolbarObject.prototype.getType=function(C){var E=this.getParentId(C);if(E!=null){var A=null,D=this.objPull[this.idPrefix+E]._listOptions[C];D!=null&&(A=D.sep!=null?"buttonSelectSeparator":"buttonSelectButton");return A}else{return this.objPull[this.idPrefix+C]==null?null:this.objPull[this.idPrefix+C].type}};dhtmlXToolbarObject.prototype.getTypeExt=function(A){var C=this.getType(A);return C=="buttonSelectButton"||C=="buttonSelectSeparator"?C=C=="buttonSelectButton"?"button":"separator":null};dhtmlXToolbarObject.prototype.inArray=function(C,D){for(var A=0;A<C.length;A++){if(C[A]==D){return !0}}return !1};dhtmlXToolbarObject.prototype.getParentId=function(C){var E=null,A;for(A in this.objPull){if(this.objPull[A]._listOptions){for(var D in this.objPull[A]._listOptions){D==C&&(E=String(A).replace(this.idPrefix,""))}}}return E};dhtmlXToolbarObject.prototype._addItem=function(A,C){this._addItemToStorage(A,C)};dhtmlXToolbarObject.prototype.addButton=function(C,F,A,E,D){this._addItem({id:C,type:"button",text:A,img:E,imgdis:D},F)};dhtmlXToolbarObject.prototype.addText=function(C,D,A){this._addItem({id:C,type:"text",text:A},D)};dhtmlXToolbarObject.prototype.addButtonSelect=function(N,L,M,K,J,F,H,I,E){for(var D=[],C=0;C<K.length;C++){var A={};K[C].id&&K[C].type?(A.id=K[C].id,A.type=K[C].type=="obj"?"button":"separator",A.text=K[C].text,A.img=K[C].img):(A.id=K[C][0],A.type=K[C][1]=="obj"?"button":"separator",A.text=K[C][2]||null,A.img=K[C][3]||null);D[D.length]=A}this._addItem({id:N,type:"buttonSelect",text:M,img:J,imgdis:F,renderSelect:H,openAll:I,items:D,maxOpen:E},L)};dhtmlXToolbarObject.prototype.addSeparator=function(A,C){this._addItem({id:A,type:"separator"},C)};dhtmlXToolbarObject.prototype.addInput=function(C,E,A,D){this._addItem({id:C,type:"buttonInput",value:A,width:D},E)};dhtmlXToolbarObject.prototype.forEachItem=function(A){for(var C in this.objPull){this.inArray(this.rootTypes,this.objPull[C].type)&&A(this.objPull[C].id.replace(this.idPrefix,""))}};(function(){for(var C="showItem,hideItem,isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),H=["","",!1,"","",!1,"","","","","","","","","",!1,"","","",null,"",[null,null],"",[null,null],"",null],A=function(J,I){return function(M,L,K){M=this.idPrefix+M;return this.objPull[M][J]!=null?this.objPull[M][J].call(this.objPull[M],L,K):I}},F=0;F<C.length;F++){var E=C[F],D=H[F];dhtmlXToolbarObject.prototype[E]=A(E,D)}})();dhtmlXToolbarObject.prototype.getPosition=function(A){return this._getPosition(A)};dhtmlXToolbarObject.prototype._getPosition=function(C){if(this.objPull[this.idPrefix+C]==null){return null}for(var E=null,A=0,D=0;D<this.base.childNodes.length;D++){this.base.childNodes[D].idd!=null&&(this.base.childNodes[D].idd==C&&(E=A),A++)}if(!E&&this._spacer!=null){for(D=0;D<this._spacer.childNodes.length;D++){this._spacer.childNodes[D].idd!=null&&(this._spacer.childNodes[D].idd==C&&(E=A),A++)}}return E};dhtmlXToolbarObject.prototype.setPosition=function(A,C){this._setPosition(A,C)};dhtmlXToolbarObject.prototype._setPosition=function(C,F){if(this.objPull[this.idPrefix+C]!=null){if(isNaN(F)){F=this.base.childNodes.length}F<0&&(F=0);var A=null;if(this._spacer){A=this._spacer.idd,this.removeSpacer()}var E=this.objPull[this.idPrefix+C];this.base.removeChild(E.obj);E.arw&&this.base.removeChild(E.arw);var D=this._getIdByPosition(F,!0);D[0]==null?(this.base.appendChild(E.obj),E.arw&&this.base.appendChild(E.arw)):(this.base.insertBefore(E.obj,this.base.childNodes[D[1]]),E.arw&&this.base.insertBefore(E.arw,this.base.childNodes[D[1]+1]));A!=null&&this.addSpacer(A)}};dhtmlXToolbarObject.prototype._getIdByPosition=function(C,H){for(var A=null,F=0,E=0,D=0;D<this.base.childNodes.length;D++){this.base.childNodes[D].idd!=null&&A==null&&F++==C&&(A=this.base.childNodes[D].idd),A==null&&E++}E=A==null?null:E;return H==!0?[A,E]:A};dhtmlXToolbarObject.prototype.removeItem=function(A){this._removeItem(A)};dhtmlXToolbarObject.prototype._removeItem=function(C){var E=this.getType(C),C=this.idPrefix+C,A=this.objPull[C];if(E=="button"){A.obj._doOnMouseOver=null,A.obj._doOnMouseOut=null,A.obj._doOnMouseUp=null,A.obj._doOnMouseUpOnceAnywhere=null,A.obj.onclick=null,A.obj.onmouseover=null,A.obj.onmouseout=null,A.obj.onmouseup=null,A.obj.onmousedown=null,A.obj.onselectstart=null,A.obj.renderAs=null,A.obj.idd=null,A.obj.parentNode.removeChild(A.obj),A.obj=null,A.id=null,A.state=null,A.img=null,A.imgEn=null,A.imgDis=null,A.type=null,A.enableItem=null,A.disableItem=null,A.isEnabled=null,A.showItem=null,A.hideItem=null,A.isVisible=null,A.setItemText=null,A.getItemText=null,A.setItemImage=null,A.clearItemImage=null,A.setItemImageDis=null,A.clearItemImageDis=null,A.setItemToolTip=null,A.getItemToolTip=null}if(E=="buttonTwoState"){A.obj._doOnMouseOver=null,A.obj._doOnMouseOut=null,A.obj.onmouseover=null,A.obj.onmouseout=null,A.obj.onmousedown=null,A.obj.onselectstart=null,A.obj.renderAs=null,A.obj.idd=null,A.obj.parentNode.removeChild(A.obj),A.obj=null,A.id=null,A.state=null,A.img=null,A.imgEn=null,A.imgDis=null,A.type=null,A.enableItem=null,A.disableItem=null,A.isEnabled=null,A.showItem=null,A.hideItem=null,A.isVisible=null,A.setItemText=null,A.getItemText=null,A.setItemImage=null,A.clearItemImage=null,A.setItemImageDis=null,A.clearItemImageDis=null,A.setItemToolTip=null,A.getItemToolTip=null,A.setItemState=null,A.getItemState=null}if(E=="buttonSelect"){for(var D in A._listOptions){this.removeListOption(C,D)}A._listOptions=null;if(A.polygon._ie6cover){document.body.removeChild(A.polygon._ie6cover),A.polygon._ie6cover=null}A.p_tbl.removeChild(A.p_tbody);A.polygon.removeChild(A.p_tbl);A.polygon.onselectstart=null;document.body.removeChild(A.polygon);A.p_tbody=null;A.p_tbl=null;A.polygon=null;A.obj.onclick=null;A.obj.onmouseover=null;A.obj.onmouseout=null;A.obj.onmouseup=null;A.obj.onmousedown=null;A.obj.onselectstart=null;A.obj.idd=null;A.obj.iddPrefix=null;A.obj.parentNode.removeChild(A.obj);A.obj=null;A.arw.onclick=null;A.arw.onmouseover=null;A.arw.onmouseout=null;A.arw.onmouseup=null;A.arw.onmousedown=null;A.arw.onselectstart=null;A.arw.parentNode.removeChild(A.arw);A.arw=null;A.renderSelect=null;A.state=null;A.type=null;A.id=null;A.img=null;A.imgEn=null;A.imgDis=null;A.openAll=null;A._isListButton=null;A._separatorButtonSelectObject=null;A._buttonButtonSelectObject=null;A.setWidth=null;A.enableItem=null;A.disableItem=null;A.isEnabled=null;A.showItem=null;A.hideItem=null;A.isVisible=null;A.setItemText=null;A.getItemText=null;A.setItemImage=null;A.clearItemImage=null;A.setItemImageDis=null;A.clearItemImageDis=null;A.setItemToolTip=null;A.getItemToolTip=null;A.addListOption=null;A.removeListOption=null;A.showListOption=null;A.hideListOption=null;A.isListOptionVisible=null;A.enableListOption=null;A.disableListOption=null;A.isListOptionEnabled=null;A.setListOptionPosition=null;A.getListOptionPosition=null;A.setListOptionImage=null;A.getListOptionImage=null;A.clearListOptionImage=null;A.setListOptionText=null;A.getListOptionText=null;A.setListOptionToolTip=null;A.getListOptionToolTip=null;A.forEachListOption=null;A.getAllListOptions=null;A.setListOptionSelected=null;A.getListOptionSelected=null}if(E=="buttonInput"){A.obj.childNodes[0].onkeydown=null,A.obj.removeChild(A.obj.childNodes[0]),A.obj.w=null,A.obj.idd=null,A.obj.parentNode.removeChild(A.obj),A.obj=null,A.id=null,A.type=null,A.enableItem=null,A.disableItem=null,A.isEnabled=null,A.showItem=null,A.hideItem=null,A.isVisible=null,A.setItemToolTip=null,A.getItemToolTip=null,A.setWidth=null,A.getWidth=null,A.setValue=null,A.getValue=null,A.setItemText=null,A.getItemText=null}if(E=="slider"){this._isIPad?(document.removeEventListener("touchmove",pen._doOnMouseMoveStart,!1),document.removeEventListener("touchend",pen._doOnMouseMoveEnd,!1)):_isIE?(document.body.detachEvent("onmousemove",A.pen._doOnMouseMoveStart),document.body.detachEvent("onmouseup",A.pen._doOnMouseMoveEnd)):(window.removeEventListener("mousemove",A.pen._doOnMouseMoveStart,!1),window.removeEventListener("mouseup",A.pen._doOnMouseMoveEnd,!1));A.pen.allowMove=null;A.pen.initXY=null;A.pen.maxX=null;A.pen.minX=null;A.pen.nowX=null;A.pen.newNowX=null;A.pen.valueMax=null;A.pen.valueMin=null;A.pen.valueNow=null;A.pen._definePos=null;A.pen._detectLimits=null;A.pen._doOnMouseMoveStart=null;A.pen._doOnMouseMoveEnd=null;A.pen.onmousedown=null;A.obj.removeChild(A.pen);A.pen=null;A.label.tip=null;document.body.removeChild(A.label);A.label=null;A.obj.onselectstart=null;for(A.obj.idd=null;A.obj.childNodes.length>0;){A.obj.removeChild(A.obj.childNodes[0])}A.obj.parentNode.removeChild(A.obj);A.obj=null;A.id=null;A.type=null;A.state=null;A.enableItem=null;A.disableItem=null;A.isEnabled=null;A.setItemToolTipTemplate=null;A.getItemToolTipTemplate=null;A.setMaxValue=null;A.setMinValue=null;A.getMaxValue=null;A.getMinValue=null;A.setValue=null;A.getValue=null;A.showItem=null;A.hideItem=null;A.isVisible=null}if(E=="separator"){A.obj.onselectstart=null,A.obj.idd=null,A.obj.parentNode.removeChild(A.obj),A.obj=null,A.id=null,A.type=null,A.showItem=null,A.hideItem=null,A.isVisible=null}if(E=="text"){A.obj.onselectstart=null,A.obj.idd=null,A.obj.parentNode.removeChild(A.obj),A.obj=null,A.id=null,A.type=null,A.showItem=null,A.hideItem=null,A.isVisible=null,A.setWidth=null,A.setItemText=null,A.getItemText=null}A=E=null;this.objPull[this.idPrefix+C]=null;delete this.objPull[this.idPrefix+C]};(function(){for(var C="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),E=function(F){return function(H,M,L,K,J,I){H=this.idPrefix+H;if(this.objPull[H]!=null){return this.objPull[H].type!="buttonSelect"?void 0:this.objPull[H][F].call(this.objPull[H],M,L,K,J,I)}}},A=0;A<C.length;A++){var D=C[A];dhtmlXToolbarObject.prototype[D]=E(D)}})();dhtmlXToolbarObject.prototype._rtlParseBtn=function(A,C){return A+C};dhtmlXToolbarObject.prototype._separatorObject=function(C,D,A){this.id=C.idPrefix+D;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_sep";this.obj.style.display=A.hidden!=null?"none":"";this.obj.idd=String(D);this.obj.title=A.title||"";this.obj.onselectstart=function(E){E=E||event;E.returnValue=!1};if(C._isIPad){this.obj.ontouchstart=function(E){E=E||event;E.returnValue=!1;E.cancelBubble=!0;return !1}}C.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};return this};dhtmlXToolbarObject.prototype._textObject=function(C,D,A){this.id=C.idPrefix+D;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_text";this.obj.style.display=A.hidden!=null?"none":"";this.obj.idd=String(D);this.obj.title=A.title||"";this.obj.onselectstart=function(E){E=E||event;E.returnValue=!1};if(C._isIPad){this.obj.ontouchstart=function(E){E=E||event;E.returnValue=!1;E.cancelBubble=!0;return !1}}this.obj.innerHTML=A.text||"";C.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(E){this.obj.innerHTML=E};this.getItemText=function(){return this.obj.innerHTML};this.setWidth=function(E){this.obj.style.width=E+"px"};this.setItemToolTip=function(E){this.obj.title=E};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._buttonObject=function(C,E,A){this.id=C.idPrefix+E;this.state=A.enabled!=null?!1:!0;this.imgEn=A.img||"";this.imgDis=A.imgdis||"";this.img=this.state?this.imgEn!=""?this.imgEn:"":this.imgDis!=""?this.imgDis:"";this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=A.hidden!=null?"none":"";this.obj.allowClick=!1;this.obj.extAction=A.action||null;this.obj.renderAs=this.obj.className;this.obj.idd=String(E);this.obj.title=A.title||"";this.obj.pressed=!1;this.obj.innerHTML=C._rtlParseBtn(this.img!=""?"<img src='"+C.imagePath+this.img+"'>":"",A.text!=null?"<div>"+A.text+"</div>":"");var D=this;this.obj.onselectstart=function(F){F=F||event;F.returnValue=!1};this.obj.onmouseover=function(){this._doOnMouseOver()};this.obj.onmouseout=function(){this._doOnMouseOut()};this.obj._doOnMouseOver=function(){this.allowClick=!0;if(D.state!=!1&&C.anyUsed=="none"){this.renderAs=this.className="dhx_toolbar_btn over"}};this.obj._doOnMouseOut=function(){this.allowClick=!1;if(D.state!=!1&&C.anyUsed=="none"){this.className="dhx_toolbar_btn def",this.renderAs=this.renderAs}};this.obj.onclick=function(F){if(D.state!=!1&&this.allowClick!=!1){var F=F||event,I=this.idd.replace(C.idPrefix,"");if(this.extAction){try{window[this.extAction](I)}catch(H){}}C&&C.callEvent&&C.callEvent("onClick",[I])}};this.obj[C._isIPad?"ontouchstart":"onmousedown"]=function(F){if(D.state==!1){return F=F||event,F.returnValue=!1,F.cancelBubble=!0,!1}if(C.anyUsed=="none"){return C.anyUsed=this.idd,this.className="dhx_toolbar_btn pres",this.pressed=!0,this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){C.anyUsed="none";this._doOnMouseOut()},!1}};this.obj[C._isIPad?"ontouchend":"onmouseup"]=function(){if(D.state!=!1&&!(C.anyUsed!="none"&&C.anyUsed!=this.idd)){var F=C.anyUsed;this._doOnMouseUp();C._isIPad&&F!="none"&&C.callEvent("onClick",[this.idd.replace(C.idPrefix,"")])}};if(C._isIPad){this.obj.ontouchmove=function(){this._doOnMouseUp()}}this.obj._doOnMouseUp=function(){C.anyUsed="none";this.className=this.renderAs;this.pressed=!1};this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp();this.onmouseover=function(){this._doOnMouseOver()};this.onmouseout=function(){this._doOnMouseOut()}};C.base.appendChild(this.obj);this.enableItem=function(){C._enableItem(this)};this.disableItem=function(){C._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(F){C._setItemText(this,F)};this.getItemText=function(){return C._getItemText(this)};this.setItemImage=function(F){C._setItemImage(this,F,!0)};this.clearItemImage=function(){C._clearItemImage(this,!0)};this.setItemImageDis=function(F){C._setItemImage(this,F,!1)};this.clearItemImageDis=function(){C._clearItemImage(this,!1)};this.setItemToolTip=function(F){this.obj.title=F};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._buttonSelectObject=function(C,H,A){this.id=C.idPrefix+H;this.state=A.enabled!=null?A.enabled=="true"?!0:!1:!0;this.imgEn=A.img||"";this.imgDis=A.imgdis||"";this.img=this.state?this.imgEn!=""?this.imgEn:"":this.imgDis!=""?this.imgDis:"";this.openAll=A.openAll!=null;this.maxOpen=!isNaN(A.maxOpen?A.maxOpen:"")?A.maxOpen:null;this._maxOpenTest=function(){if(!isNaN(this.maxOpen)&&!C._sbw){var I=document.createElement("DIV");I.className="dhxtoolbar_maxopen_test";document.body.appendChild(I);var J=document.createElement("DIV");J.className="dhxtoolbar_maxopen_test2";I.appendChild(J);C._sbw=I.offsetWidth-J.offsetWidth;I.removeChild(J);J=null;document.body.removeChild(I);I=null}};this._maxOpenTest();this.obj=document.createElement("DIV");this.obj.allowClick=!1;this.obj.extAction=A.action||null;this.obj.className="dhx_toolbar_btn def";this.obj.style.display=A.hidden!=null?"none":"";this.obj.renderAs=this.obj.className;this.obj.onselectstart=function(I){I=I||event;I.returnValue=!1};this.obj.idd=String(H);this.obj.title=A.title||"";this.callEvent=this.obj.pressed=!1;this.renderSelect=A.renderSelect!=null?A.renderSelect=="false"||A.renderSelect=="disabled"?!1:!0:!0;this.obj.innerHTML=C._rtlParseBtn(this.img!=""?"<img src='"+C.imagePath+this.img+"'>":"",A.text!=null?"<div>"+A.text+"</div>":"");C.base.appendChild(this.obj);this.arw=document.createElement("DIV");this.arw.className="dhx_toolbar_arw def";this.arw.style.display=this.obj.style.display;this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>";this.arw.title=this.obj.title;this.arw.onselectstart=function(I){I=I||event;I.returnValue=!1};C.base.appendChild(this.arw);var F=this;this.obj.onmouseover=function(I){I=I||event;if(C.anyUsed=="none"&&F.state){F.obj.renderAs="dhx_toolbar_btn over",F.obj.className=F.obj.renderAs,F.arw.className=String(F.obj.renderAs).replace("btn","arw")}};this.obj.onmouseout=function(){F.obj.allowClick=!1;if(C.anyUsed=="none"&&F.state){F.obj.renderAs="dhx_toolbar_btn def",F.obj.className=F.obj.renderAs,F.arw.className=String(F.obj.renderAs).replace("btn","arw"),F.callEvent=!1}};this.arw.onmouseover=this.obj.onmouseover;this.arw.onmouseout=this.obj.onmouseout;if(this.openAll!=!0){this.obj.onclick=function(I){I=I||event;if(F.obj.allowClick&&F.state&&C.anyUsed=="none"){var K=F.obj.idd.replace(C.idPrefix,"");if(F.obj.extAction){try{window[F.obj.extAction](K)}catch(J){}}C.callEvent("onClick",[K])}},this.obj[C._isIPad?"ontouchstart":"onmousedown"]=function(I){I=I||event;if(C.anyUsed=="none"&&F.state){F.obj.allowClick=!0,F.obj.className="dhx_toolbar_btn pres",F.arw.className="dhx_toolbar_arw pres",F.callEvent=!0}},this.obj[C._isIPad?"ontouchend":"onmouseup"]=function(I){I=I||event;I.cancelBubble=!0;if(C.anyUsed=="none"&&F.state&&(F.obj.className=F.obj.renderAs,F.arw.className=String(F.obj.renderAs).replace("btn","arw"),C._isIPad&&F.callEvent)){var J=F.obj.idd.replace(C.idPrefix,"");C.callEvent("onClick",[J])}}}if(C._isIPad){this.obj.ontouchmove=this.obj.onmouseout}this.arw[C._isIPad?"ontouchstart":"onmousedown"]=function(I){I=I||event;if(F.state){if(C.anyUsed==F.obj.idd){if(F.obj.className=F.obj.renderAs,F.arw.className=String(F.obj.renderAs).replace("btn","arw"),C.anyUsed="none",F.polygon.style.display="none",F.polygon._ie6cover){F.polygon._ie6cover.style.display="none"}}else{if(C.anyUsed!="none"&&C.objPull[C.idPrefix+C.anyUsed].type=="buttonSelect"){var M=C.objPull[C.idPrefix+C.anyUsed];if(M.polygon.style.display!="none"&&(M.obj.renderAs="dhx_toolbar_btn def",M.obj.className=M.obj.renderAs,M.arw.className=String(F.obj.renderAs).replace("btn","arw"),M.polygon.style.display="none",M.polygon._ie6cover)){M.polygon._ie6cover.style.display="none"}}F.obj.className="dhx_toolbar_btn over";F.arw.className="dhx_toolbar_arw pres";C.anyUsed=F.obj.idd;F.polygon.style.top="0px";F.polygon.style.visibility="hidden";F.polygon.style.display="";F._fixMaxOpenHeight(F.maxOpen||null);C._autoDetectVisibleArea();var L=getAbsoluteTop(F.obj)+F.obj.offsetHeight+C.selectPolygonOffsetTop,K=F.polygon.offsetHeight;if(L+K>C.tY2){var J=F.maxOpen!=null?Math.floor((C.tY2-L)/22):0;J>=1?F._fixMaxOpenHeight(J):(L=getAbsoluteTop(F.obj)-K-C.selectPolygonOffsetTop,L<0&&(L=0))}F.polygon.style.top=L+"px";F.polygon.style.left=C.rtl?getAbsoluteLeft(F.obj)+F.obj.offsetWidth-F.polygon.offsetWidth+C.selectPolygonOffsetLeft+"px":getAbsoluteLeft(F.obj)+C.selectPolygonOffsetLeft+"px";F.polygon.style.visibility="visible";if(F.polygon._ie6cover){F.polygon._ie6cover.style.left=F.polygon.style.left,F.polygon._ie6cover.style.top=F.polygon.style.top,F.polygon._ie6cover.style.width=F.polygon.offsetWidth+"px",F.polygon._ie6cover.style.height=F.polygon.offsetHeight+"px",F.polygon._ie6cover.style.display=""}}return !1}};this.arw.onclick=function(I){I=I||event;I.cancelBubble=!0};this.arw[C._isIPad?"ontouchend":"onmouseup"]=function(I){I=I||event;I.cancelBubble=!0};if(this.openAll===!0&&(this.obj.onclick=this.arw.onclick,this.obj.onmousedown=this.arw.onmousedown,this.obj.onmouseup=this.arw.onmouseup,C._isIPad)){this.obj.ontouchstart=this.arw.ontouchstart,this.obj.ontouchend=this.arw.ontouchend}this.obj.iddPrefix=C.idPrefix;this._listOptions={};this._fixMaxOpenHeight=function(I){var M="auto",L=!1;if(I!==null){var K=0,J;for(J in this._listOptions){K++}K>I?(this._ph=22*I,M=this._ph+"px"):L=!0}this.polygon.style.width="auto";this.polygon.style.height="auto";if(!L&&F.maxOpen!=null){this.polygon.style.width=this.p_tbl.offsetWidth+C._sbw+"px",this.polygon.style.height=M}};this._separatorButtonSelectObject=function(J,I,K){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.className="tr_sep";this.obj.tr.onselectstart=function(L){L=L||event;return L.returnValue=!1};this.obj.td=document.createElement("TD");this.obj.td.colSpan="2";this.obj.td.className="td_btn_sep";this.obj.td.onselectstart=function(L){L=L||event;return L.returnValue=!1};isNaN(K)?K=F.p_tbody.childNodes.length+1:K<1&&(K=1);K>F.p_tbody.childNodes.length?F.p_tbody.appendChild(this.obj.tr):F.p_tbody.insertBefore(this.obj.tr,F.p_tbody.childNodes[K-1]);this.obj.tr.appendChild(this.obj.td);this.obj.sep=document.createElement("DIV");this.obj.sep.className="btn_sep";this.obj.sep.onselectstart=function(L){L=L||event;return L.returnValue=!1};this.obj.td.appendChild(this.obj.sep);F._listOptions[J]=this.obj;return this};this._buttonButtonSelectObject=function(I,L,K){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.en=L.enabled=="false"?!1:L.disabled=="true"?!1:!0;this.obj.tr.extAction=L.action||null;this.obj.tr._selected=L.selected!=null;this.obj.tr.className="tr_btn"+(this.obj.tr.en?this.obj.tr._selected&&F.renderSelect?" tr_btn_selected":"":" tr_btn_disabled");this.obj.tr.onselectstart=function(M){M=M||event;return M.returnValue=!1};this.obj.tr.idd=String(I);if(L.userdata){this.obj.userData=L.userdata}isNaN(K)?K=F.p_tbody.childNodes.length+1:K<1&&(K=1);K>F.p_tbody.childNodes.length?F.p_tbody.appendChild(this.obj.tr):F.p_tbody.insertBefore(this.obj.tr,F.p_tbody.childNodes[K-1]);this.obj.td_a=document.createElement("TD");this.obj.td_a.className="td_btn_img";this.obj.td_a.onselectstart=function(M){M=M||event;return M.returnValue=!1};this.obj.td_b=document.createElement("TD");this.obj.td_b.className="td_btn_txt";this.obj.td_b.onselectstart=function(M){M=M||event;return M.returnValue=!1};C.rtl?(this.obj.tr.appendChild(this.obj.td_b),this.obj.tr.appendChild(this.obj.td_a)):(this.obj.tr.appendChild(this.obj.td_a),this.obj.tr.appendChild(this.obj.td_b));if(L.img!=null){this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+C.imagePath+L.img+"' border='0'>"}var J=L.text!=null?L.text:L.itemText||"";this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+J+"</div>";this.obj.tr[C._isIPad?"ontouchstart":"onmouseover"]=function(){if(this.en&&(!this._selected||!F.renderSelect)){this.className="tr_btn tr_btn_over"}};this.obj.tr.onmouseout=function(){if(this.en){if(this._selected&&F.renderSelect){if(String(this.className).search("tr_btn_selected")==-1){this.className="tr_btn tr_btn_selected"}}else{this.className="tr_btn"}}};this.obj.tr[C._isIPad?"ontouchend":"onclick"]=function(M){M=M||event;M.cancelBubble=!0;if(this.en){F.setListOptionSelected(this.idd.replace(C.idPrefix,""));F.obj.renderAs="dhx_toolbar_btn def";F.obj.className=F.obj.renderAs;F.arw.className=String(F.obj.renderAs).replace("btn","arw");F.polygon.style.display="none";if(F.polygon._ie6cover){F.polygon._ie6cover.style.display="none"}C.anyUsed="none";var O=this.idd.replace(C.idPrefix,"");if(this.extAction){try{window[this.extAction](O)}catch(N){}}C.callEvent("onClick",[O])}};F._listOptions[I]=this.obj;return this};this.polygon=document.createElement("DIV");this.polygon.dir="ltr";this.polygon.style.display="none";this.polygon.style.zIndex=101;this.polygon.className="dhx_toolbar_poly_"+C.skin+(C.rtl?" rtl":"");this.polygon.onselectstart=function(I){I=I||event;I.returnValue=!1};this.polygon.style.overflowY="auto";if(C._isIPad){this.polygon.ontouchstart=function(I){I=I||event;I.returnValue=!1;I.cancelBubble=!0;return !1}}this.p_tbl=document.createElement("TABLE");this.p_tbl.className="buttons_cont";this.p_tbl.cellSpacing="0";this.p_tbl.cellPadding="0";this.p_tbl.border="0";this.polygon.appendChild(this.p_tbl);this.p_tbody=document.createElement("TBODY");this.p_tbl.appendChild(this.p_tbody);if(A.items){for(var E=0;E<A.items.length;E++){var D="_"+(A.items[E].type||"")+"ButtonSelectObject";typeof this[D]=="function"&&new this[D](A.items[E].id||C._genStr(24),A.items[E])}}document.body.appendChild(this.polygon);if(C._isIE6){this.polygon._ie6cover=document.createElement("IFRAME"),this.polygon._ie6cover.frameBorder=0,this.polygon._ie6cover.style.position="absolute",this.polygon._ie6cover.style.border="none",this.polygon._ie6cover.style.backgroundColor="#000000",this.polygon._ie6cover.style.filter="alpha(opacity=100)",this.polygon._ie6cover.style.display="none",this.polygon._ie6cover.setAttribute("src","javascript:false;"),document.body.appendChild(this.polygon._ie6cover)}this.setWidth=function(I){this.obj.style.width=I-this.arw.offsetWidth+"px";this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px";this.p_tbl.style.width=this.polygon.style.width};this.enableItem=function(){C._enableItem(this)};this.disableItem=function(){C._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display="";this.arw.style.display=""};this.hideItem=function(){this.obj.style.display="none";this.arw.style.display="none"};this.isVisible=function(){return this.obj.style.display==""};this.setItemText=function(I){C._setItemText(this,I)};this.getItemText=function(){return C._getItemText(this)};this.setItemImage=function(I){C._setItemImage(this,I,!0)};this.clearItemImage=function(){C._clearItemImage(this,!0)};this.setItemImageDis=function(I){C._setItemImage(this,I,!1)};this.clearItemImageDis=function(){C._clearItemImage(this,!1)};this.setItemToolTip=function(I){this.obj.title=I;this.arw.title=I};this.getItemToolTip=function(){return this.obj.title};this.addListOption=function(J,I,N,M,L){if(N=="button"||N=="separator"){var K={id:J,type:N,text:M,img:L};new this["_"+N+"ButtonSelectObject"](J,K,I)}};this.removeListOption=function(J){if(this._isListButton(J,!0)){var I=this._listOptions[J];if(I.td_a!=null&&I.td_b!=null){I.td_a.onselectstart=null;for(I.td_b.onselectstart=null;I.td_a.childNodes.length>0;){I.td_a.removeChild(I.td_a.childNodes[0])}for(;I.td_b.childNodes.length>0;){I.td_b.removeChild(I.td_b.childNodes[0])}I.tr.onselectstart=null;I.tr.onmouseover=null;I.tr.onmouseout=null;for(I.tr.onclick=null;I.tr.childNodes.length>0;){I.tr.removeChild(I.tr.childNodes[0])}I.tr.parentNode.removeChild(I.tr);I.td_a=null;I.td_b=null}else{I.sep.onselectstart=null;I.td.onselectstart=null;for(I.tr.onselectstart=null;I.td.childNodes.length>0;){I.td.removeChild(I.td.childNodes[0])}for(;I.tr.childNodes.length>0;){I.tr.removeChild(I.tr.childNodes[0])}I.tr.parentNode.removeChild(I.tr);I.sep=null;I.td=null}I=I.tr=null;this._listOptions[J]=null;try{delete this._listOptions[J]}catch(K){}}};this.showListOption=function(I){if(this._isListButton(I,!0)){this._listOptions[I].tr.style.display=""}};this.hideListOption=function(I){if(this._isListButton(I,!0)){this._listOptions[I].tr.style.display="none"}};this.isListOptionVisible=function(I){return !this._isListButton(I,!0)?void 0:this._listOptions[I].tr.style.display!="none"};this.enableListOption=function(I){if(this._isListButton(I)){this._listOptions[I].tr.en=!0,this._listOptions[I].tr.className="tr_btn"+(this._listOptions[I].tr._selected&&C.renderSelect?" tr_btn_selected":"")}};this.disableListOption=function(I){if(this._isListButton(I)){this._listOptions[I].tr.en=!1,this._listOptions[I].tr.className="tr_btn tr_btn_disabled"}};this.isListOptionEnabled=function(I){return !this._isListButton(I)?void 0:this._listOptions[I].tr.en};this.setListOptionPosition=function(J,I){if(this._listOptions[J]&&!(this.getListOptionPosition(J)==I||isNaN(I))){I<1&&(I=1);var K=this._listOptions[J].tr;this.p_tbody.removeChild(K);I>this.p_tbody.childNodes.length?this.p_tbody.appendChild(K):this.p_tbody.insertBefore(K,this.p_tbody.childNodes[I-1]);K=null}};this.getListOptionPosition=function(J){var I=-1;if(!this._listOptions[J]){return I}for(var K=0;K<this.p_tbody.childNodes.length;K++){this.p_tbody.childNodes[K]==this._listOptions[J].tr&&(I=K+1)}return I};this.setListOptionImage=function(I,L){if(this._isListButton(I)){var K=this._listOptions[I].tr.childNodes[C.rtl?1:0];if(K.childNodes.length>0){K.childNodes[0].src=C.imagePath+L}else{var J=document.createElement("IMG");J.className="btn_sel_img";J.src=C.imagePath+L;K.appendChild(J)}K=null}};this.getListOptionImage=function(I){if(this._isListButton(I)){var K=this._listOptions[I].tr.childNodes[C.rtl?1:0],J=null;if(K.childNodes.length>0){J=K.childNodes[0].src}K=null;return J}};this.clearListOptionImage=function(I){if(this._isListButton(I)){for(var J=this._listOptions[I].tr.childNodes[C.rtl?1:0];J.childNodes.length>0;){J.removeChild(J.childNodes[0])}J=null}};this.setListOptionText=function(I,J){if(this._isListButton(I)){this._listOptions[I].tr.childNodes[C.rtl?0:1].childNodes[0].innerHTML=J}};this.getListOptionText=function(I){return !this._isListButton(I)?void 0:this._listOptions[I].tr.childNodes[C.rtl?0:1].childNodes[0].innerHTML};this.setListOptionToolTip=function(J,I){if(this._isListButton(J)){this._listOptions[J].tr.title=I}};this.getListOptionToolTip=function(I){return !this._isListButton(I)?void 0:this._listOptions[I].tr.title};this.forEachListOption=function(J){for(var I in this._listOptions){J(I)}};this.getAllListOptions=function(){var J=[],I;for(I in this._listOptions){J[J.length]=I}return J};this.setListOptionSelected=function(J){for(var I in this._listOptions){var K=this._listOptions[I];if(K.td_a!=null&&K.td_b!=null&&K.tr.en){I==J?(K.tr._selected=!0,K.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":"")):(K.tr._selected=!1,K.tr.className="tr_btn")}K=null}};this.getListOptionSelected=function(){var J=null,I;for(I in this._listOptions){this._listOptions[I].tr._selected==!0&&(J=I)}return J};this._isListButton=function(J,I){return this._listOptions[J]==null?!1:!I&&this._listOptions[J].tr.className=="tr_sep"?!1:!0};this.setMaxOpen=function(I){this._ph=null;typeof I=="number"?(this.maxOpen=I,this._maxOpenTest()):this.maxOpen=null};return this};dhtmlXToolbarObject.prototype._buttonInputObject=function(C,F,A){this.id=C.idPrefix+F;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn def";this.obj.style.display=A.hidden!=null?"none":"";this.obj.idd=String(F);this.obj.w=A.width!=null?A.width:100;this.obj.title=A.title!=null?A.title:"";this.obj.innerHTML="<input class='inp' type='text' style='-moz-user-select:text;width:"+this.obj.w+"px;'"+(A.value!=null?"' value='"+A.value+"'":"")+">";var E=C,D=this;this.obj.childNodes[0].onkeydown=function(H){H=H||event;H.keyCode==13&&E.callEvent("onEnter",[D.obj.idd,this.value])};C.base.appendChild(this.obj);this.enableItem=function(){this.obj.childNodes[0].disabled=!1};this.disableItem=function(){this.obj.childNodes[0].disabled=!0};this.isEnabled=function(){return !this.obj.childNodes[0].disabled};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return this.obj.style.display!="none"};this.setValue=function(H){this.obj.childNodes[0].value=H};this.getValue=function(){return this.obj.childNodes[0].value};this.setWidth=function(H){this.obj.w=H;this.obj.childNodes[0].style.width=this.obj.w+"px"};this.getWidth=function(){return this.obj.w};this.setItemToolTip=function(H){this.obj.title=H};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype.unload=function(){this._isIPad?document.removeEventListener("touchstart",this._doOnClick,!1):_isIE?document.body.detachEvent("onclick",this._doOnClick):window.removeEventListener("click",this._doOnClick,!1);this._doOnClick=null;this.clearAll();this.objPull=null;if(this._xmlLoader){this._xmlLoader.destructor(),this._xmlLoader=null}for(;this.base.childNodes.length>0;){this.base.removeChild(this.base.childNodes[0])}this.cont.removeChild(this.base);for(this.base=null;this.cont.childNodes.length>0;){this.cont.removeChild(this.cont.childNodes[0])}this.cont.className="";this.cont=null;this.detachAllEvents();this.items=this.setMaxOpen=this.getUserData=this.setUserData=this.unload=this.getListOptionSelected=this.setListOptionSelected=this.getAllListOptions=this.forEachListOption=this.clearListOptionImage=this.getListOptionImage=this.setListOptionImage=this.getListOptionToolTip=this.setListOptionToolTip=this.getListOptionText=this.setListOptionText=this.getListOptionPosition=this.setListOptionPosition=this.isListOptionEnabled=this.disableListOption=this.enableListOption=this.isListOptionVisible=this.hideListOption=this.showListOption=this.removeListOption=this.addListOption=this.removeItem=this.setPosition=this.getPosition=this.getWidth=this.setWidth=this.getMaxValue=this.setMaxValue=this.getMinValue=this.setMinValue=this.getValue=this.setValue=this.getItemToolTipTemplate=this.setItemToolTipTemplate=this.getItemState=this.setItemState=this.clearItemImageDis=this.clearItemImage=this.setItemImageDis=this.setItemImage=this.getItemToolTip=this.setItemToolTip=this.getItemText=this.setItemText=this.isEnabled=this.disableItem=this.enableItem=this.isVisible=this.hideItem=this.showItem=this.forEachItem=this.addInput=this.addSlider=this.addSeparator=this.addButtonTwoState=this.addButtonSelect=this.addText=this.addButton=this.getParentId=this.inArray=this.getTypeExt=this.getType=this.removeSpacer=this.addSpacer=this.clearAll=this.detachAllEvents=this.detachEvent=this.eventCatcher=this.checkEvent=this.callEvent=this.attachEvent=this.loadXMLString=this.loadXML=this.setIconPath=this.setIconsPath=this.setSkin=this.setAlign=this._removeItem=this._autoDetectVisibleArea=this._sliderObject=this._buttonTwoStateObject=this._buttonInputObject=this._buttonSelectObject=this._buttonObject=this._textObject=this._separatorObject=this._getIdByPosition=this._setPosition=this._getPosition=this._addItem=this._genStr=this._addItemToStorage=this._doOnLoad=this._xmlParser=this._disableItem=this._enableItem=this._getItemText=this._setItemText=this._clearItemImage=this._setItemImage=this._addImgObj=this._getObj=this._sbw=this.setRTL=this._rtlParseBtn=this._rtl=this.skin=this.selectPolygonOffsetTop=this.selectPolygonOffsetLeft=this.rootTypes=this.imagePath=this.idPrefix=this.anyUsed=this.align=this._isWebToolbar=this._isIE6=this.tY2=this.tY1=this.tX2=this.tX1=null};dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){this.tX1=document.body.scrollLeft;this.tX2=this.tX1+(window.innerWidth||document.body.clientWidth);this.tY1=Math.max((_isIE?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);this.tY2=this.tY1+(_isIE?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight)};dhtmlXToolbarObject.prototype.setUserData=function(C,E,A){if(this.objPull[this.idPrefix+C]!=null){var D=this.objPull[this.idPrefix+C];if(D.userData==null){D.userData={}}D.userData[E]=A}};dhtmlXToolbarObject.prototype.getUserData=function(A,C){return this.objPull[this.idPrefix+A]==null?null:this.objPull[this.idPrefix+A].userData==null?null:this.objPull[this.idPrefix+A].userData[C]==null?null:this.objPull[this.idPrefix+A].userData[C]};dhtmlXToolbarObject.prototype._isListOptionExists=function(C,D){if(this.objPull[this.idPrefix+C]==null){return !1}var A=this.objPull[this.idPrefix+C];return A.type!="buttonSelect"?!1:A._listOptions[D]==null?!1:!0};dhtmlXToolbarObject.prototype.setListOptionUserData=function(C,F,A,E){if(this._isListOptionExists(C,F)){var D=this.objPull[this.idPrefix+C]._listOptions[F];if(D.userData==null){D.userData={}}D.userData[A]=E}};dhtmlXToolbarObject.prototype.getListOptionUserData=function(C,E,A){if(!this._isListOptionExists(C,E)){return null}var D=this.objPull[this.idPrefix+C]._listOptions[E];return !D.userData?null:D.userData[A]?D.userData[A]:null};(function(){dhtmlx.extend_api("dhtmlXToolbarObject",{_init:function(A){return[A.parent,A.skin]},icon_path:"setIconsPath",xml:"loadXML",items:"items",align:"setAlign",rtl:"setRTL",skin:"setSkin"},{items:function(C){for(var D=0;D<C.length;D++){var A=C[D];A.type=="button"&&this.addButton(A.id,null,A.text,A.img,A.img_disabled);A.type=="separator"&&this.addSeparator(A.id,null);A.type=="text"&&this.addText(A.id,null,A.text);A.type=="buttonSelect"&&this.addButtonSelect(A.id,null,A.text,A.options,A.img,A.img_disabled);A.type=="buttonTwoState"&&this.addButtonTwoState(A.id,null,A.text,A.img,A.img_disabled);A.type=="buttonInput"&&this.addInput(A.id,null,A.text);A.type=="slider"&&this.addSlider(A.id,null,A.length,A.value_min,A.value_max,A.value_now,A.text_min,A.text_max,A.tip_template);A.width&&this.setWidth(A.id,A.width);A.disabled&&this.disableItem(A.id);A.tooltip&&this.setItemToolTip(A.id,A.tooltip);A.pressed===!0&&this.setItemState(A.id,!0)}}})})();function dhtmlXContainer(a){var c=this;this.obj=a;this.dhxcont=null;this.st=document.createElement("DIV");this.st.style.position="absolute";this.st.style.left="-200px";this.st.style.top="0px";this.st.style.width="100px";this.st.style.height="1px";this.st.style.visibility="hidden";this.st.style.overflow="hidden";document.body.insertBefore(this.st,document.body.childNodes[0]);this.obj._getSt=function(){return c.st};this.obj.dv="def";this.obj.av=this.obj.dv;this.obj.cv=this.obj.av;this.obj.vs={};this.obj.vs[this.obj.av]={};this.obj.view=function(a){if(!this.vs[a]){this.vs[a]={};this.vs[a].dhxcont=this.vs[this.dv].dhxcont;var b=document.createElement("DIV");b.style.position="relative";b.style.left="0px";b.style.width="200px";b.style.height="200px";b.style.overflow="hidden";b.style.visibility="";c.st.appendChild(b);this.vs[a].dhxcont.mainCont[a]=b}this.avt=this.av;this.av=a;return this};this.obj.setActive=function(){if(this.vs[this.av]){this.cv=this.av,this.vs[this.avt].dhxcont==this.vs[this.avt].dhxcont.mainCont[this.avt].parentNode&&(c.st.appendChild(this.vs[this.avt].dhxcont.mainCont[this.avt]),this.vs[this.avt].menu&&c.st.appendChild(document.getElementById(this.vs[this.avt].menuId)),this.vs[this.avt].toolbar&&c.st.appendChild(document.getElementById(this.vs[this.avt].toolbarId)),this.vs[this.avt].sb&&c.st.appendChild(document.getElementById(this.vs[this.avt].sbId))),this.vs[this.av].dhxcont!=this.vs[this.av].dhxcont.mainCont[this.av].parentNode&&(this.vs[this.av].dhxcont.insertBefore(this.vs[this.av].dhxcont.mainCont[this.av],this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1]),this.vs[this.av].menu&&this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].menuId),this.vs[this.av].dhxcont.childNodes[0]),this.vs[this.av].toolbar&&this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].toolbarId),this.vs[this.av].dhxcont.childNodes[this.vs[this.av].menu?1:0]),this.vs[this.av].sb&&this.vs[this.av].dhxcont.insertBefore(document.getElementById(this.vs[this.av].sbId),this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1])),this._doOnResize&&this._doOnResize(),this.avt=null}};this.obj._viewRestore=function(){var a=this.av;if(this.avt){this.av=this.avt,this.avt=null}return a};this.setContent=function(a){this.obj.vs[this.obj.av].dhxcont=a;this.obj._init()};this.obj._init=function(){this.vs[this.av].dhxcont.innerHTML="<div ida='dhxMainCont' style='position: relative; left: 0px; top: 0px; overflow: hidden;'></div><div ida='dhxContBlocker' class='dhxcont_content_blocker' style='display: none;'></div>";this.vs[this.av].dhxcont.mainCont={};this.vs[this.av].dhxcont.mainCont[this.av]=this.vs[this.av].dhxcont.childNodes[0]};this.obj._genStr=function(a){for(var b="",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",g=0;g<a;g++){b+=c.charAt(Math.round(Math.random()*(c.length-1)))}return b};this.obj.setMinContentSize=function(a,b){this.vs[this.av]._minDataSizeW=a;this.vs[this.av]._minDataSizeH=b};this.obj._setPadding=function(a,b){typeof a=="object"?(this._offsetTop=a[0],this._offsetLeft=a[1],this._offsetWidth=a[2],this._offsetHeight=a[3]):(this._offsetLeft=this._offsetTop=a,this._offsetWidth=-a*2,this._offsetHeight=-a*2);this.vs[this.av].dhxcont.className="dhxcont_global_content_area "+(b||"")};this.obj.moveContentTo=function(a){for(var b in this.vs){a.view(b).setActive();var c=null;this.vs[b].grid&&(c="grid");this.vs[b].tree&&(c="tree");this.vs[b].tabbar&&(c="tabbar");this.vs[b].folders&&(c="folders");this.vs[b].layout&&(c="layout");c!=null&&(a.view(b).attachObject(this.vs[b][c+"Id"]),a.vs[b][c]=this.vs[b][c],a.vs[b][c+"Id"]=this.vs[b][c+"Id"],a.vs[b][c+"Obj"]=this.vs[b][c+"Obj"],this.vs[b][c]=null,this.vs[b][c+"Id"]=null,this.vs[b][c+"Obj"]=null);if(this.vs[b]._frame){a.vs[b]._frame=this.vs[b]._frame,this.vs[b]._frame=null}if(this.vs[b].menu!=null){a.cv==a.av?a.vs[a.av].dhxcont.insertBefore(document.getElementById(this.vs[b].menuId),a.vs[a.av].dhxcont.childNodes[0]):a._getSt().appendChild(document.getElementById(this.vs[b].menuId)),a.vs[b].menu=this.vs[b].menu,a.vs[b].menuId=this.vs[b].menuId,a.vs[b].menuHeight=this.vs[b].menuHeight,this.vs[b].menu=null,this.vs[b].menuId=null,this.vs[b].menuHeight=null,this.cv==this.av&&this._doOnAttachMenu&&this._doOnAttachMenu("unload"),a.cv==a.av&&a._doOnAttachMenu&&a._doOnAttachMenu("move")}if(this.vs[b].toolbar!=null){a.cv==a.av?a.vs[a.av].dhxcont.insertBefore(document.getElementById(this.vs[b].toolbarId),a.vs[a.av].dhxcont.childNodes[a.vs[a.av].menu!=null?1:0]):a._getSt().appendChild(document.getElementById(this.vs[b].toolbarId)),a.vs[b].toolbar=this.vs[b].toolbar,a.vs[b].toolbarId=this.vs[b].toolbarId,a.vs[b].toolbarHeight=this.vs[b].toolbarHeight,this.vs[b].toolbar=null,this.vs[b].toolbarId=null,this.vs[b].toolbarHeight=null,this.cv==this.av&&this._doOnAttachToolbar&&this._doOnAttachToolbar("unload"),a.cv==a.av&&a._doOnAttachToolbar&&a._doOnAttachToolbar("move")}if(this.vs[b].sb!=null){a.cv==a.av?a.vs[a.av].dhxcont.insertBefore(document.getElementById(this.vs[b].sbId),a.vs[a.av].dhxcont.childNodes[a.vs[a.av].dhxcont.childNodes.length-1]):a._getSt().appendChild(document.getElementById(this.vs[b].sbId)),a.vs[b].sb=this.vs[b].sb,a.vs[b].sbId=this.vs[b].sbId,a.vs[b].sbHeight=this.vs[b].sbHeight,this.vs[b].sb=null,this.vs[b].sbId=null,this.vs[b].sbHeight=null,this.cv==this.av&&this._doOnAttachStatusBar&&this._doOnAttachStatusBar("unload"),a.cv==a.av&&a._doOnAttachStatusBar&&a._doOnAttachStatusBar("move")}for(var g=this.vs[b].dhxcont.mainCont[b],f=a.vs[b].dhxcont.mainCont[b];g.childNodes.length>0;){f.appendChild(g.childNodes[0])}}a.view(this.av).setActive()};this.obj.adjustContent=function(a,b,c,g,f){this.vs[this.av].dhxcont.style.left=(this._offsetLeft||0)+"px";this.vs[this.av].dhxcont.style.top=(this._offsetTop||0)+b+"px";var i=a.clientWidth+(this._offsetWidth||0);if(g!==!0){this.vs[this.av].dhxcont.style.width=Math.max(0,i)+"px"}if(g!==!0&&this.vs[this.av].dhxcont.offsetWidth>i){this.vs[this.av].dhxcont.style.width=Math.max(0,i*2-this.vs[this.av].dhxcont.offsetWidth)+"px"}var j=a.clientHeight+(this._offsetHeight||0);this.vs[this.av].dhxcont.style.height=Math.max(0,j-b)+(c!=null?c:0)+"px";if(this.vs[this.av].dhxcont.offsetHeight>j-b){this.vs[this.av].dhxcont.style.height=Math.max(0,(j-b)*2-this.vs[this.av].dhxcont.offsetHeight)+"px"}if(f&&!isNaN(f)){this.vs[this.av].dhxcont.style.height=Math.max(0,parseInt(this.vs[this.av].dhxcont.style.height)-f)+"px"}if(this.vs[this.av]._minDataSizeH!=null&&parseInt(this.vs[this.av].dhxcont.style.height)<this.vs[this.av]._minDataSizeH){this.vs[this.av].dhxcont.style.height=this.vs[this.av]._minDataSizeH+"px"}if(this.vs[this.av]._minDataSizeW!=null&&parseInt(this.vs[this.av].dhxcont.style.width)<this.vs[this.av]._minDataSizeW){this.vs[this.av].dhxcont.style.width=this.vs[this.av]._minDataSizeW+"px"}if(g!==!0&&(this.vs[this.av].dhxcont.mainCont[this.av].style.width=this.vs[this.av].dhxcont.clientWidth+"px",this.vs[this.av].dhxcont.mainCont[this.av].offsetWidth>this.vs[this.av].dhxcont.clientWidth)){this.vs[this.av].dhxcont.mainCont[this.av].style.width=Math.max(0,this.vs[this.av].dhxcont.clientWidth*2-this.vs[this.av].dhxcont.mainCont[this.av].offsetWidth)+"px"}var k=this.vs[this.av].menu!=null?!this.vs[this.av].menuHidden?this.vs[this.av].menuHeight:0:0,l=this.vs[this.av].toolbar!=null?!this.vs[this.av].toolbarHidden?this.vs[this.av].toolbarHeight:0:0,m=this.vs[this.av].sb!=null?!this.vs[this.av].sbHidden?this.vs[this.av].sbHeight:0:0;this.vs[this.av].dhxcont.mainCont[this.av].style.height=this.vs[this.av].dhxcont.clientHeight+"px";if(this.vs[this.av].dhxcont.mainCont[this.av].offsetHeight>this.vs[this.av].dhxcont.clientHeight){this.vs[this.av].dhxcont.mainCont[this.av].style.height=Math.max(0,this.vs[this.av].dhxcont.clientHeight*2-this.vs[this.av].dhxcont.mainCont[this.av].offsetHeight)+"px"}this.vs[this.av].dhxcont.mainCont[this.av].style.height=Math.max(0,parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)-k-l-m)+"px"};this.obj.coverBlocker=function(){return this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1]};this.obj.showCoverBlocker=function(){this.coverBlocker().style.display=""};this.obj.hideCoverBlocker=function(){this.coverBlocker().style.display="none"};this.obj.updateNestedObjects=function(){this.vs[this.av].grid&&this.vs[this.av].grid.setSizes();this.vs[this.av].sched&&this.vs[this.av].sched.setSizes();this.vs[this.av].tabbar&&this.vs[this.av].tabbar.adjustOuterSize();this.vs[this.av].folders&&this.vs[this.av].folders.setSizes();this.vs[this.av].editor&&(_isIE||this.vs[this.av].editor._prepareContent(!0),this.vs[this.av].editor.setSizes());if(this.vs[this.av].layout){(this.vs[this.av].dhxcont._isAcc||this.vs[this.av].dhxcont._isTabbarCell)&&this.vs[this.av].dhxcont.skin=="dhx_skyblue"?(this.vs[this.av].layoutObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px",this.vs[this.av].layoutObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"):(this.vs[this.av].layoutObj.style.width=this.vs[this.av].dhxcont.mainCont[this.av].style.width,this.vs[this.av].layoutObj.style.height=this.vs[this.av].dhxcont.mainCont[this.av].style.height),this.vs[this.av].layout.setSizes()}if(this.vs[this.av].accordion!=null){this.skin=="dhx_web"?(this.vs[this.av].accordionObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px",this.vs[this.av].accordionObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px"):(this.vs[this.av].accordionObj.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px",this.vs[this.av].accordionObj.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"),this.vs[this.av].accordion.setSizes()}this.vs[this.av].dockedCell&&this.vs[this.av].dockedCell.updateNestedObjects();this.vs[this.av].form&&this.vs[this.av].form.setSizes()};this.obj.attachStatusBar=function(){if(!this.vs[this.av].sb){var a=document.createElement("DIV");a.className=this._isCell?"dhxcont_sb_container_layoutcell":"dhxcont_sb_container";a.id="sbobj_"+this._genStr(12);a.innerHTML="<div class='dhxcont_statusbar'></div>";this.cv==this.av?this.vs[this.av].dhxcont.insertBefore(a,this.vs[this.av].dhxcont.childNodes[this.vs[this.av].dhxcont.childNodes.length-1]):c.st.appendChild(a);a.setText=function(a){this.childNodes[0].innerHTML=a};a.getText=function(){return this.childNodes[0].innerHTML};a.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.vs[this.av].sb=a;this.vs[this.av].sbHeight=this.skin=="dhx_web"?41:this.skin=="dhx_skyblue"?23:a.offsetHeight;this.vs[this.av].sbId=a.id;this._doOnAttachStatusBar&&this._doOnAttachStatusBar("init");this.adjust();return this.vs[this._viewRestore()].sb}};this.obj.detachStatusBar=function(){if(this.vs[this.av].sb){this.vs[this.av].sb.setText=null,this.vs[this.av].sb.getText=null,this.vs[this.av].sb.onselectstart=null,this.vs[this.av].sb.parentNode.removeChild(this.vs[this.av].sb),this.vs[this.av].sb=null,this.vs[this.av].sbHeight=null,this.vs[this.av].sbId=null,this._viewRestore(),this._doOnAttachStatusBar&&this._doOnAttachStatusBar("unload")}};this.obj.getFrame=function(){return this.getView()._frame};this.obj.getView=function(a){return this.vs[a||this.av]};this.obj.attachMenu=function(a){if(!this.vs[this.av].menu){var b=document.createElement("DIV");b.style.position="relative";b.style.overflow="hidden";b.id="dhxmenu_"+this._genStr(12);this.cv==this.av?this.vs[this.av].dhxcont.insertBefore(b,this.vs[this.av].dhxcont.childNodes[0]):c.st.appendChild(b);typeof a!="object"?this.vs[this.av].menu=new dhtmlXMenuObject(b.id,a||this.skin):(a.parent=b.id,this.vs[this.av].menu=new dhtmlXMenuObject(a));this.vs[this.av].menuHeight=this.skin=="dhx_web"?29:b.offsetHeight;this.vs[this.av].menuId=b.id;this._doOnAttachMenu&&this._doOnAttachMenu("init");this.adjust();return this.vs[this._viewRestore()].menu}};this.obj.detachMenu=function(){if(this.vs[this.av].menu){var a=document.getElementById(this.vs[this.av].menuId);this.vs[this.av].menu.unload();this.vs[this.av].menu=null;this.vs[this.av].menuId=null;this.vs[this.av].menuHeight=null;a&&a.parentNode.removeChild(a);a=null;this._viewRestore();this._doOnAttachMenu&&this._doOnAttachMenu("unload")}};this.obj.attachToolbar=function(a){if(!this.vs[this.av].toolbar){var b=document.createElement("DIV");b.style.position="relative";b.style.overflow="hidden";b.id="dhxtoolbar_"+this._genStr(12);this.cv==this.av?this.vs[this.av].dhxcont.insertBefore(b,this.vs[this.av].dhxcont.childNodes[this.vs[this.av].menu!=null?1:0]):c.st.appendChild(b);typeof a!="object"?this.vs[this.av].toolbar=new dhtmlXToolbarObject(b.id,a||this.skin):(a.parent=b.id,this.vs[this.av].toolbar=new dhtmlXToolbarObject(a));this.vs[this.av].toolbarHeight=this.skin=="dhx_web"?41:b.offsetHeight+(this._isLayout&&this.skin=="dhx_skyblue"?2:0);this.vs[this.av].toolbarId=b.id;this._doOnAttachToolbar&&this._doOnAttachToolbar("init");this.adjust();return this.vs[this._viewRestore()].toolbar}};this.obj.detachToolbar=function(){if(this.vs[this.av].toolbar){var a=document.getElementById(this.vs[this.av].toolbarId);this.vs[this.av].toolbar.unload();this.vs[this.av].toolbar=null;this.vs[this.av].toolbarId=null;this.vs[this.av].toolbarHeight=null;a&&a.parentNode.removeChild(a);a=null;this._viewRestore();this._doOnAttachToolbar&&this._doOnAttachToolbar("unload")}};this.obj.attachGrid=function(){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw()}var a=document.createElement("DIV");a.id="dhxGridObj_"+this._genStr(12);a.style.width="100%";a.style.height="100%";a.cmp="grid";document.body.appendChild(a);this.attachObject(a.id,!1,!0);this.vs[this.av].grid=new dhtmlXGridObject(a.id);this.vs[this.av].grid.setSkin(this.skin);if(this.skin!="dhx_web"){this.vs[this.av].grid.entBox.style.border="0px solid white",this.vs[this.av].grid._sizeFix=0}this.vs[this.av].gridId=a.id;this.vs[this.av].gridObj=a;return this.vs[this._viewRestore()].grid};this.obj.attachScheduler=function(a,b,c){if(c){g=document.getElementById(c)}else{var g=document.createElement("DIV");g.id="dhxSchedObj_"+this._genStr(12);g.innerHTML='<div id="'+g.id+'" class="dhx_cal_container" style="width:100%; height:100%;"><div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div></div>';document.body.appendChild(g.firstChild)}this.attachObject(g.id,!1,!0);this.vs[this.av].sched=scheduler;this.vs[this.av].schedId=g.id;scheduler.setSizes=scheduler.update_view;scheduler.destructor=function(){};scheduler.init(g.id,a,b);return this.vs[this._viewRestore()].sched};this.obj.attachTree=function(a){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw()}var b=document.createElement("DIV");b.id="dhxTreeObj_"+this._genStr(12);b.style.width="100%";b.style.height="100%";b.cmp="tree";document.body.appendChild(b);this.attachObject(b.id,!1,!0);this.vs[this.av].tree=new dhtmlXTreeObject(b.id,"100%","100%",a||0);this.vs[this.av].tree.setSkin(this.skin);this.vs[this.av].tree.allTree.childNodes[0].style.marginTop="2px";this.vs[this.av].tree.allTree.childNodes[0].style.marginBottom="2px";this.vs[this.av].treeId=b.id;this.vs[this.av].treeObj=b;return this.vs[this._viewRestore()].tree};this.obj.attachTabbar=function(a){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.style.border="none",this.setDimension(this.w,this.h)}var b=document.createElement("DIV");b.id="dhxTabbarObj_"+this._genStr(12);b.style.width="100%";b.style.height="100%";b.style.overflow="hidden";b.cmp="tabbar";document.body.appendChild(b);this.attachObject(b.id,!1,!0);this.className=="dhtmlxLayoutSinglePoly"&&this.hideHeader();this.vs[this.av].tabbar=new dhtmlXTabBar(b.id,a||"top",20);if(!this._isWindow){this.vs[this.av].tabbar._s.expand=!0}this.vs[this.av].tabbar.setSkin(this.skin);this.vs[this.av].tabbar.adjustOuterSize();this.vs[this.av].tabbarId=b.id;this.vs[this.av].tabbarObj=b;return this.vs[this._viewRestore()].tabbar};this.obj.attachFolders=function(){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw()}var a=document.createElement("DIV");a.id="dhxFoldersObj_"+this._genStr(12);a.style.width="100%";a.style.height="100%";a.style.overflow="hidden";a.cmp="folders";document.body.appendChild(a);this.attachObject(a.id,!1,!0);this.vs[this.av].folders=new dhtmlxFolders(a.id);this.vs[this.av].folders.setSizes();this.vs[this.av].foldersId=a.id;this.vs[this.av].foldersObj=a;return this.vs[this._viewRestore()].folders};this.obj.attachAccordion=function(){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw()}var a=document.createElement("DIV");a.id="dhxAccordionObj_"+this._genStr(12);this.skin=="dhx_web"?(a.style.left="0px",a.style.top="0px",a.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px",a.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px"):(a.style.left="-1px",a.style.top="-1px",a.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px",a.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px");a.style.position="relative";a.cmp="accordion";document.body.appendChild(a);this.attachObject(a.id,!1,!0);this.vs[this.av].accordion=new dhtmlXAccordion(a.id,this.skin);this.vs[this.av].accordion.setSizes();this.vs[this.av].accordionId=a.id;this.vs[this.av].accordionObj=a;return this.vs[this._viewRestore()].accordion};this.obj.attachLayout=function(a,b){if(this._isCell&&this.skin=="dhx_skyblue"){this.hideHeader(),this.vs[this.av].dhxcont.style.border="0px solid white",this.adjustContent(this.childNodes[0],0)}this._isCell&&this.skin=="dhx_web"&&this.hideHeader();var c=document.createElement("DIV");c.id="dhxLayoutObj_"+this._genStr(12);c.style.overflow="hidden";c.style.position="absolute";c.style.left="0px";c.style.top="0px";c.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+"px";c.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+"px";if((this._isTabbarCell||this._isAcc)&&this.skin=="dhx_skyblue"){c.style.left="-1px",c.style.top="-1px",c.style.width=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.width)+2+"px",c.style.height=parseInt(this.vs[this.av].dhxcont.mainCont[this.av].style.height)+2+"px"}c.dhxContExists=!0;c.cmp="layout";document.body.appendChild(c);this.attachObject(c.id,!1,!0);this.vs[this.av].layout=new dhtmlXLayoutObject(c,a,b||this.skin);this._isWindow&&this.attachEvent("_onBeforeTryResize",this.vs[this.av].layout._defineWindowMinDimension);this.vs[this.av].layoutId=c.id;this.vs[this.av].layoutObj=c;return this.vs[this._viewRestore()].layout};this.obj.attachEditor=function(){if(this._isWindow&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw()}var a=document.createElement("DIV");a.id="dhxEditorObj_"+this._genStr(12);a.style.position="relative";a.style.display="none";a.style.overflow="hidden";a.style.width="100%";a.style.height="100%";a.cmp="editor";document.body.appendChild(a);this.attachObject(a.id,!1,!0);this.vs[this.av].editor=new dhtmlXEditor(a.id,this.skin);this.vs[this.av].editorId=a.id;this.vs[this.av].editorObj=a;return this.vs[this._viewRestore()].editor};this.obj.attachMap=function(a){var b=document.createElement("DIV");b.id="GMapsObj_"+this._genStr(12);b.style.position="relative";b.style.display="none";b.style.overflow="hidden";b.style.width="100%";b.style.height="100%";b.cmp="gmaps";document.body.appendChild(b);this.attachObject(b.id,!1,!0);a||(a={center:new google.maps.LatLng(40.719837,-73.992348),zoom:11,mapTypeId:google.maps.MapTypeId.ROADMAP});this.vs[this.av].gmaps=new google.maps.Map(b,a);return this.vs[this.av].gmaps};this.obj.attachObject=function(a,b,c){typeof a=="string"&&(a=document.getElementById(a));if(b){a.style.visibility="hidden";a.style.display="";var g=a.offsetWidth,f=a.offsetHeight}this._attachContent("obj",a);if(b&&this._isWindow){a.style.visibility="",this._adjustToContent(g,f)}c||this._viewRestore()};this.obj.detachObject=function(a,b){for(var c=null,g=null,f="tree,grid,layout,tabbar,accordion,folders".split(","),i=0;i<f.length;i++){if(this.vs[this.av][f[i]]){c=this.vs[this.av][f[i]];g=this.vs[this.av][f[i]+"Obj"];if(a){c.unload&&c.unload();for(c.destructor&&c.destructor();g.childNodes.length>0;){g.removeChild(g.childNodes[0])}g.parentNode.removeChild(g);c=g=null}else{document.body.appendChild(g),g.style.display="none"}this.vs[this.av][f[i]]=null;this.vs[this.av][f[i]+"Id"]=null;this.vs[this.av][f[i]+"Obj"]=null}}if(c!=null&&g!=null){return[c,g]}if(a&&this.vs[this.av]._frame){this._detachURLEvents(),this.vs[this.av]._frame=null}for(var j=this.vs[this.av].dhxcont.mainCont[this.av];j.childNodes.length>0;){if(a==!0){j.removeChild(j.childNodes[0])}else{var k=j.childNodes[0];b!=null?(typeof b!="object"&&(b=document.getElementById(b)),b.appendChild(k)):document.body.appendChild(k);k.style.display="none"}}};this.obj.appendObject=function(a){typeof a=="string"&&(a=document.getElementById(a));this._attachContent("obj",a,!0)};this.obj.attachHTMLString=function(a){this._attachContent("str",a);for(var b=a.match(/<script[^>]*>[^\f]*?<\/script>/g)||[],c=0;c<b.length;c++){var g=b[c].replace(/<([\/]{0,1})script[^>]*>/g,"");g&&(window.execScript?window.execScript(g):window.eval(g))}};this.obj.attachURL=function(a,b){this._attachContent(b==!0?"urlajax":"url",a,!1);this._viewRestore()};this.obj.adjust=function(){if(this.skin=="dhx_skyblue"){if(this.vs[this.av].menu){if(this._isWindow||this._isLayout){this.vs[this.av].menu._topLevelOffsetLeft=0,document.getElementById(this.vs[this.av].menuId).style.height="26px",this.vs[this.av].menuHeight=document.getElementById(this.vs[this.av].menuId).offsetHeight,this._doOnAttachMenu&&this._doOnAttachMenu("show")}if(this._isCell){document.getElementById(this.vs[this.av].menuId).className+=" in_layoutcell",this.vs[this.av].menuHeight=25}if(this._isAcc){document.getElementById(this.vs[this.av].menuId).className+=" in_acccell",this.vs[this.av].menuHeight=25}this._doOnAttachMenu&&this._doOnAttachMenu("adjust")}if(this.vs[this.av].toolbar){if(this._isWindow||this._isLayout){document.getElementById(this.vs[this.av].toolbarId).style.height="29px",this.vs[this.av].toolbarHeight=document.getElementById(this.vs[this.av].toolbarId).offsetHeight,this._doOnAttachToolbar&&this._doOnAttachToolbar("show")}this._isCell&&(document.getElementById(this.vs[this.av].toolbarId).className+=" in_layoutcell");this._isAcc&&(document.getElementById(this.vs[this.av].toolbarId).className+=" in_acccell")}}};this.obj._attachContent=function(a,b,c){if(c!==!0){if(this.vs[this.av]._frame){this._detachURLEvents(),this.vs[this.av]._frame=null}for(;this.vs[this.av].dhxcont.mainCont[this.av].childNodes.length>0;){this.vs[this.av].dhxcont.mainCont[this.av].removeChild(this.vs[this.av].dhxcont.mainCont[this.av].childNodes[0])}}if(a=="url"){if(this._isWindow&&b.cmp==null&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this._redraw()}var g=document.createElement("IFRAME");g.frameBorder=0;g.border=0;g.style.width="100%";g.style.height="100%";g.setAttribute("src","javascript:false;");this.vs[this.av].dhxcont.mainCont[this.av].appendChild(g);g.src=b;this.vs[this.av]._frame=g;this._attachURLEvents()}else{if(a=="urlajax"){if(this._isWindow&&b.cmp==null&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor="#FFFFFF",this._redraw()}var f=this,i=String(this.av).valueOf(),j=function(){var a=f.av;f.av=i;f.attachHTMLString(this.xmlDoc.responseText,this);f.av=a;f._doOnFrameContentLoaded&&f._doOnFrameContentLoaded();this.destructor()},k=new dtmlXMLLoaderObject(j,window);k.dhxWindowObject=this;k.loadXML(b)}else{if(a=="obj"){if(this._isWindow&&b.cmp==null&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor="#FFFFFF",this._redraw()}this.vs[this.av].dhxcont._frame=null;this.vs[this.av].dhxcont.mainCont[this.av].appendChild(b);this.vs[this.av].dhxcont.mainCont[this.av].style.overflow=c===!0?"auto":"hidden";b.style.display=""}else{if(a=="str"){if(this._isWindow&&b.cmp==null&&this.skin=="dhx_skyblue"){this.vs[this.av].dhxcont.mainCont[this.av].style.border="#a4bed4 1px solid",this.vs[this.av].dhxcont.mainCont[this.av].style.backgroundColor="#FFFFFF",this._redraw()}this.vs[this.av].dhxcont._frame=null;this.vs[this.av].dhxcont.mainCont[this.av].innerHTML=b}}}}};this.obj._attachURLEvents=function(){var a=this,b=this.vs[this.av]._frame;_isIE?b.onreadystatechange=function(){if(b.readyState=="complete"){try{b.contentWindow.document.body.onmousedown=function(){a._doOnFrameMouseDown&&a._doOnFrameMouseDown()}}catch(c){}try{a._doOnFrameContentLoaded&&a._doOnFrameContentLoaded()}catch(g){}}}:b.onload=function(){try{b.contentWindow.onmousedown=function(){a._doOnFrameMouseDown&&a._doOnFrameMouseDown()}}catch(c){}try{a._doOnFrameContentLoaded&&a._doOnFrameContentLoaded()}catch(g){}}};this.obj._detachURLEvents=function(){if(_isIE){try{this.vs[this.av]._frame.onreadystatechange=null,this.vs[this.av]._frame.contentWindow.document.body.onmousedown=null,this.vs[this.av]._frame.onload=null}catch(a){}}else{try{this.vs[this.av]._frame.contentWindow.onmousedown=null,this.vs[this.av]._frame.onload=null}catch(b){}}};this.obj.showMenu=function(){if(this.vs[this.av].menu&&this.vs[this.av].menuId&&document.getElementById(this.vs[this.av].menuId).style.display=="none"){this.vs[this.av].menuHidden=!1,this._doOnAttachMenu&&this._doOnAttachMenu("show"),document.getElementById(this.vs[this.av].menuId).style.display="",this._viewRestore()}};this.obj.hideMenu=function(){if(this.vs[this.av].menu&&this.vs[this.av].menuId&&document.getElementById(this.vs[this.av].menuId).style.display!="none"){document.getElementById(this.vs[this.av].menuId).style.display="none",this.vs[this.av].menuHidden=!0,this._doOnAttachMenu&&this._doOnAttachMenu("hide"),this._viewRestore()}};this.obj.showToolbar=function(){if(this.vs[this.av].toolbar&&this.vs[this.av].toolbarId&&document.getElementById(this.vs[this.av].toolbarId).style.display=="none"){this.vs[this.av].toolbarHidden=!1,this._doOnAttachToolbar&&this._doOnAttachToolbar("show"),document.getElementById(this.vs[this.av].toolbarId).style.display="",this._viewRestore()}};this.obj.hideToolbar=function(){if(this.vs[this.av].toolbar&&this.vs[this.av].toolbarId&&document.getElementById(this.vs[this.av].toolbarId).style.display!="none"){this.vs[this.av].toolbarHidden=!0,document.getElementById(this.vs[this.av].toolbarId).style.display="none",this._doOnAttachToolbar&&this._doOnAttachToolbar("hide"),this._viewRestore()}};this.obj.showStatusBar=function(){if(this.vs[this.av].sb&&this.vs[this.av].sbId&&document.getElementById(this.vs[this.av].sbId).style.display=="none"){this.vs[this.av].sbHidden=!1,this._doOnAttachStatusBar&&this._doOnAttachStatusBar("show"),document.getElementById(this.vs[this.av].sbId).style.display="",this._viewRestore()}};this.obj.hideStatusBar=function(){if(this.vs[this.av].sb&&this.vs[this.av].sbId&&document.getElementById(this.vs[this.av].sbId).style.display!="none"){this.vs[this.av].sbHidden=!0,document.getElementById(this.vs[this.av].sbId).style.display="none",this._doOnAttachStatusBar&&this._doOnAttachStatusBar("hide"),this._viewRestore()}};this.obj._dhxContDestruct=function(){var a=this.av,b;for(b in this.vs){this.av=b,this.detachMenu(),this.detachToolbar(),this.detachStatusBar(),this.detachObject(!0),this.vs[b].dhxcont.mainCont[b].parentNode.removeChild(this.vs[b].dhxcont.mainCont[b]),this.vs[b].dhxcont.mainCont[b]=null}this.vs[this.dv].dhxcont.mainCont=null;this.vs[this.dv].dhxcont.parentNode.removeChild(this.vs[this.dv].dhxcont);for(b in this.vs){this.vs[b].dhxcont=null}this._dhxContDestruct=this._genStr=this._init=this._setPadding=this._viewRestore=this._detachURLEvents=this._attachURLEvents=this._attachContent=this.updateNestedObjects=this.hideCoverBlocker=this.showCoverBlocker=this.coverBlocker=this.adjustContent=this.moveContentTo=this.setMinContentSize=this.adjust=this.show=this.view=this.attachURL=this.attachHTMLString=this.appendObject=this.detachObject=this.attachObject=this.attachEditor=this.attachLayout=this.attachAccordion=this.attachFolders=this.attachTabbar=this.attachTree=this.attachScheduler=this.attachGrid=this.hideStatusBar=this.hideToolbar=this.hideMenu=this.showStatusBar=this.showToolbar=this.showMenu=this.detachStatusBar=this.detachToolbar=this.detachMenu=this.attachStatusBar=this.attachToolbar=this.attachMenu=this.vs=null;c.st.parentNode.removeChild(c.st);c.st=null;c.setContent=null;c.dhxcont=null;c=c.obj=null;if(dhtmlx.detaches){for(b in dhtmlx.detaches){dhtmlx.detaches[b](this)}}};if(dhtmlx.attaches){for(var b in dhtmlx.attaches){this.obj[b]=dhtmlx.attaches[b]}}}function dhtmlXCalendarObject(L,J){this.i={};this.uid=function(){if(!this.uidd){this.uidd=(new Date).getTime()}return this.uidd++};var K=null,I=typeof L=="string"?document.getElementById(L):L;I&&typeof I=="object"&&I.tagName&&String(I.tagName).toLowerCase()!="input"&&(K=I);I=null;if(typeof L!="object"||!L.length){L=[L]}for(var H=0;H<L.length;H++){typeof L[H]=="string"&&(L[H]=document.getElementById(L[H])||null),L[H]!=null&&L[H].tagName&&String(L[H].tagName).toLowerCase()=="input"&&(this.i[this.uid()]=L[H]),L[H]=null}this.skin=J||"dhx_skyblue";this.setSkin=function(M){this.skin=M;this.base.className="dhtmlxcalendar_container dhtmlxcalendar_skin_"+this.skin;this._ifrSize()};this.base=document.createElement("DIV");this.base.className="dhtmlxcalendar_container";this.base.style.display="none";K!=null?(this._hasParent=!0,K.appendChild(this.base),K=null):document.body.appendChild(this.base);this.setParent=function(M){this._hasParent&&(typeof M=="object"?M.appendChild(this.base):typeof M=="string"&&document.getElementById(M).appendChild(this.base))};this.setSkin(this.skin);this.base.onclick=function(M){M=M||event;M.cancelBubble=!0};this.loadUserLanguage=function(N){if(this.langData[N]&&(this.lang=N,this.setWeekStartDay(this.langData[this.lang].weekstart),this.msCont)){for(var M=0,P=0;P<this.msCont.childNodes.length;P++){for(var O=0;O<this.msCont.childNodes[P].childNodes.length;O++){this.msCont.childNodes[P].childNodes[O].innerHTML=this.langData[this.lang].monthesSNames[M++]}}}};this.contMonth=document.createElement("DIV");this.contMonth.className="dhtmlxcalendar_month_cont";this.contMonth.onselectstart=function(M){M=M||event;M.cancelBubble=!0;return M.returnValue=!1};this.base.appendChild(this.contMonth);var D=document.createElement("UL");D.className="dhtmlxcalendar_line";this.contMonth.appendChild(D);var E=document.createElement("LI");E.className="dhtmlxcalendar_cell dhtmlxcalendar_month_hdr";E.innerHTML="<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div><span class='dhtmlxcalendar_month_label_month'>Month</span><span class='dhtmlxcalendar_month_label_year'>Year</span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>";D.appendChild(E);var F=this;E.onclick=function(N){var N=N||event,M=N.target||N.srcElement;if(M.className&&M.className.indexOf("dhtmlxcalendar_month_arrow")===0){F._hideSelector();var O=M.parentNode.firstChild==M?-1:1;F._drawMonth(new Date(F._activeMonth.getFullYear(),F._activeMonth.getMonth()+O,1,0,0,0,0))}else{M.className&&M.className=="dhtmlxcalendar_month_label_month"?(N.cancelBubble=!0,F._showSelector("month",31,21,"selector_month",!0)):M.className&&M.className=="dhtmlxcalendar_month_label_year"?(N.cancelBubble=!0,F._showSelector("year",42,21,"selector_year",!0)):F._hideSelector()}};this.contDays=document.createElement("DIV");this.contDays.className="dhtmlxcalendar_days_cont";this.base.appendChild(this.contDays);this.setWeekStartDay=function(M){M==0&&(M=7);this._wStart=Math.min(Math.max(isNaN(M)?1:M,1),7);this._drawDaysOfWeek()};this._drawDaysOfWeek=function(){if(this.contDays.childNodes.length==0){var N=document.createElement("UL");N.className="dhtmlxcalendar_line";this.contDays.appendChild(N)}else{N=this.contDays.firstChild}var M=this._wStart,Q=this.langData[this.lang].daysSNames;Q.push(String(this.langData[this.lang].daysSNames[0]).valueOf());for(var P=0;P<7;P++){if(N.childNodes[P]==null){var O=document.createElement("LI");N.appendChild(O)}else{O=N.childNodes[P]}O.className="dhtmlxcalendar_cell"+(M>=6?" dhtmlxcalendar_day_weekday_cell":"")+(P==0?"_first":"");O.innerHTML=Q[M];++M>7&&(M=1)}this._activeMonth!=null&&this._drawMonth(this._activeMonth)};this._wStart=this.langData[this.lang].weekstart;this.setWeekStartDay(this._wStart);this.contDates=document.createElement("DIV");this.contDates.className="dhtmlxcalendar_dates_cont";this.base.appendChild(this.contDates);this.contDates.onclick=function(N){var N=N||event,M=N.target||N.srcElement;if(M._date!=null&&!M._css_dis){var Q=F._activeDate.getHours(),P=F._activeDate.getMinutes();if(!F.checkEvent("onBeforeChange")||F.callEvent("onBeforeChange",[new Date(M._date.getFullYear(),M._date.getMonth(),M._date.getDate(),Q,P)])){if(F._activeDateCell!=null){F._activeDateCell._css_date=!1,F._updateCellStyle(F._activeDateCell._q,F._activeDateCell._w)}var O=F._hasParent&&F._activeDate.getFullYear()+"_"+F._activeDate.getMonth()!=M._date.getFullYear()+"_"+M._date.getMonth();F._nullDate=!1;F._activeDate=new Date(M._date.getFullYear(),M._date.getMonth(),M._date.getDate(),Q,P);F._activeDateCell=M;F._activeDateCell._css_date=!0;F._activeDateCell._css_hover=!1;F._lastHover=null;F._updateCellStyle(F._activeDateCell._q,F._activeDateCell._w);O&&F._drawMonth(F._activeDate);if(F._activeInp&&F.i[F._activeInp]){F.i[F._activeInp].value=F._dateToStr(new Date(F._activeDate.getTime()))}F._hasParent||F._hide();F.callEvent("onClick",[new Date(F._activeDate.getTime())])}}};this.contDates.onmouseover=function(N){var N=N||event,M=N.target||N.srcElement;if(M._date!=null){M._css_hover=!0,F._updateCellStyle(M._q,M._w),F._lastHover=M}};this.contDates.onmouseout=function(){F._clearDayHover()};this._lastHover=null;this._clearDayHover=function(){if(this._lastHover){this._lastHover._css_hover=!1,this._updateCellStyle(this._lastHover._q,this._lastHover._w),this._lastHover=null}};for(H=0;H<6;H++){D=document.createElement("UL");D.className="dhtmlxcalendar_line";this.contDates.appendChild(D);for(var C=0;C<7;C++){E=document.createElement("LI"),E.className="dhtmlxcalendar_cell",D.appendChild(E)}}this.contTime=document.createElement("DIV");this.contTime.className="dhtmlxcalendar_time_cont";this.base.appendChild(this.contTime);this.showTime=function(){if(String(this.base.className).search("dhtmlxcalendar_time_hidden")>0){this.base.className=String(this.base.className).replace(/dhtmlxcalendar_time_hidden/gi,"")}this._ifrSize()};this.hideTime=function(){String(this.base.className).search("dhtmlxcalendar_time_hidden")<0&&(this.base.className+=" dhtmlxcalendar_time_hidden");this._ifrSize()};D=document.createElement("UL");D.className="dhtmlxcalendar_line";this.contTime.appendChild(D);E=document.createElement("LI");E.className="dhtmlxcalendar_cell dhtmlxcalendar_time_hdr";E.innerHTML="<div class='dhtmlxcalendar_time_label'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'>:</span><span class='dhtmlxcalendar_label_minutes'></span>";D.appendChild(E);E.onclick=function(N){var N=N||event,M=N.target||N.srcElement;M.className&&M.className=="dhtmlxcalendar_label_hours"?(N.cancelBubble=!0,F._showSelector("hours",3,115,"selector_hours",!0)):M.className&&M.className=="dhtmlxcalendar_label_minutes"?(N.cancelBubble=!0,F._showSelector("minutes",59,115,"selector_minutes",!0)):F._hideSelector()};this._activeMonth=null;this._activeDate=new Date;this._activeDateCell=null;this.setDate=function(N){this._nullDate=typeof N=="undefined"||N===""||!N;N instanceof Date||(N=this._strToDate(String(N)),N=="Invalid Date"&&(N=new Date));var M=N.getTime();if(!this._isOutOfRange(M)){this._activeDate=new Date(M),this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleHours(),this._updateVisibleMinutes()}};this.getDate=function(N){if(this._nullDate){return null}var M=new Date(this._activeDate.getTime());return N?this._dateToStr(M):M};this._drawMonth=function(X){if(X instanceof Date){isNaN(X.getFullYear())&&(X=new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),1,0,0,0,0));this._activeMonth=new Date(X.getFullYear(),X.getMonth(),1,0,0,0,0);this._activeDateCell=null;var W=new Date(this._activeMonth.getTime()),V=W.getDay(),U=V-this._wStart;U<0&&(U+=7);W.setDate(W.getDate()-U);for(var T=X.getMonth(),S=(new Date(this._activeDate.getFullYear(),this._activeDate.getMonth(),this._activeDate.getDate(),0,0,0,0)).getTime(),Q=0,P=0;P<6;P++){for(var O=this._wStart,N=0;N<7;N++){var M=new Date(W.getFullYear(),W.getMonth(),W.getDate()+Q++,0,0,0,0);this.contDates.childNodes[P].childNodes[N].innerHTML=M.getDate();var Z=M.getDay(),Y=M.getTime();this.contDates.childNodes[P].childNodes[N]._date=new Date(Y);this.contDates.childNodes[P].childNodes[N]._q=P;this.contDates.childNodes[P].childNodes[N]._w=N;this.contDates.childNodes[P].childNodes[N]._css_month=M.getMonth()==T;this.contDates.childNodes[P].childNodes[N]._css_date=!this._nullDate&&Y==S;this.contDates.childNodes[P].childNodes[N]._css_weekend=O>=6;this.contDates.childNodes[P].childNodes[N]._css_dis=this._isOutOfRange(Y);this.contDates.childNodes[P].childNodes[N]._css_holiday=this._holidays[Y]==!0;this._updateCellStyle(P,N);if(Y==S){this._activeDateCell=this.contDates.childNodes[P].childNodes[N]}++O>7&&(O=1)}}this.contMonth.firstChild.firstChild.childNodes[1].innerHTML=this.langData[this.lang].monthesFNames[X.getMonth()];this.contMonth.firstChild.firstChild.childNodes[2].innerHTML=X.getFullYear()}};this._updateCellStyle=function(N,M){var P=this.contDates.childNodes[N].childNodes[M],O="dhtmlxcalendar_cell dhtmlxcalendar_cell";O+=P._css_month?"_month":"";O+=P._css_date?"_date":"";O+=P._css_weekend?"_weekend":"";O+=P._css_holiday?"_holiday":"";O+=P._css_dis?"_dis":"";O+=P._css_hover&&!P._css_dis?"_hover":"";P.className=O;P=null};this._initSelector=function(N,M){if(!this._selCover){this._selCover=document.createElement("DIV"),this._selCover.className="dhtmlxcalendar_selector_cover",this.base.appendChild(this._selCover)}if(!this._sel){this._sel=document.createElement("DIV"),this._sel.className="dhtmlxcalendar_selector_obj",this.base.appendChild(this._sel),this._sel.appendChild(document.createElement("TABLE")),this._sel.firstChild.className="dhtmlxcalendar_selector_table",this._sel.firstChild.cellSpacing=0,this._sel.firstChild.cellPadding=0,this._sel.firstChild.border=0,this._sel.firstChild.appendChild(document.createElement("TBODY")),this._sel.firstChild.firstChild.appendChild(document.createElement("TR")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD")),this._sel.firstChild.firstChild.firstChild.childNodes[0].className="dhtmlxcalendar_selector_cell_left",this._sel.firstChild.firstChild.firstChild.childNodes[1].className="dhtmlxcalendar_selector_cell_middle",this._sel.firstChild.firstChild.firstChild.childNodes[2].className="dhtmlxcalendar_selector_cell_right",this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML="&nbsp;",this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_left"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover=function(){this.className="dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"},this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout=function(){this.className="dhtmlxcalendar_selector_cell_right"},this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick=function(U){U=U||event;U.cancelBubble=!0;F._scrollYears(-1)},this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick=function(U){U=U||event;U.cancelBubble=!0;F._scrollYears(1)},this._sel._ta={},this._selHover=null,this._sel.onmouseover=function(V){var V=V||event,U=V.target||V.srcElement;if(U._cell===!0&&(F._selHover!=U&&F._clearSelHover(),String(U.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi)!=null)){U.className+=" dhtmlxcalendar_selector_cell_hover",F._selHover=U}},this._sel.onmouseout=function(){F._clearSelHover()},this._sel.appendChild(document.createElement("DIV")),this._sel.lastChild.className="dhtmlxcalendar_selector_obj_arrow"}if(this._sel._ta[N]!=!0){if(N=="month"){this._msCells={};this.msCont=document.createElement("DIV");this.msCont.className="dhtmlxcalendar_area_"+M;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);for(var T=0,S=0;S<4;S++){var Q=document.createElement("UL");Q.className="dhtmlxcalendar_selector_line";this.msCont.appendChild(Q);for(var O=0;O<3;O++){var P=document.createElement("LI");P.innerHTML=this.langData[this.lang].monthesSNames[T];P.className="dhtmlxcalendar_selector_cell";Q.appendChild(P);P._month=T;P._cell=!0;this._msCells[T++]=P}}this.msCont.onclick=function(V){V=V||event;V.cancelBubble=!0;var U=V.target||V.srcElement;U._month!=null&&(F._hideSelector(),F._updateActiveMonth(),F._drawMonth(new Date(F._activeMonth.getFullYear(),U._month,1,0,0,0,0)),F._doOnSelectorChange())}}if(N=="year"){this._ysCells={};this.ysCont=document.createElement("DIV");this.ysCont.className="dhtmlxcalendar_area_"+M;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);for(S=0;S<4;S++){Q=document.createElement("UL");Q.className="dhtmlxcalendar_selector_line";this.ysCont.appendChild(Q);for(O=0;O<3;O++){P=document.createElement("LI"),P.className="dhtmlxcalendar_selector_cell",P._cell=!0,Q.appendChild(P)}}this.ysCont.onclick=function(V){V=V||event;V.cancelBubble=!0;var U=V.target||V.srcElement;U._year!=null&&(F._hideSelector(),F._drawMonth(new Date(U._year,F._activeMonth.getMonth(),1,0,0,0,0)),F._doOnSelectorChange())}}if(N=="hours"){this._hsCells={};this.hsCont=document.createElement("DIV");this.hsCont.className="dhtmlxcalendar_area_"+M;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);for(S=T=0;S<4;S++){Q=document.createElement("UL");Q.className="dhtmlxcalendar_selector_line";this.hsCont.appendChild(Q);for(O=0;O<6;O++){P=document.createElement("LI"),P.innerHTML=this._fixLength(T,2),P.className="dhtmlxcalendar_selector_cell",Q.appendChild(P),P._hours=T,P._cell=!0,this._hsCells[T++]=P}}this.hsCont.onclick=function(V){V=V||event;V.cancelBubble=!0;var U=V.target||V.srcElement;U._hours!=null&&(F._hideSelector(),F._activeDate.setHours(U._hours),F._updateActiveHours(),F._updateVisibleHours(),F._doOnSelectorChange())}}if(N=="minutes"){this._rsCells={};this.rsCont=document.createElement("DIV");this.rsCont.className="dhtmlxcalendar_area_"+M;this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);for(S=T=0;S<4;S++){Q=document.createElement("UL");Q.className="dhtmlxcalendar_selector_line";this.rsCont.appendChild(Q);for(O=0;O<3;O++){P=document.createElement("LI"),P.innerHTML=this._fixLength(T,2),P.className="dhtmlxcalendar_selector_cell",Q.appendChild(P),P._minutes=T,P._cell=!0,this._rsCells[T]=P,T+=5}}this.rsCont.onclick=function(V){V=V||event;V.cancelBubble=!0;var U=V.target||V.srcElement;U._minutes!=null&&(F._hideSelector(),F._activeDate.setMinutes(U._minutes),F._updateActiveMinutes(),F._updateVisibleMinutes(),F._doOnSelectorChange())}}this._sel._ta[N]=!0}};this._showSelector=function(N,M,Q,P,O){O===!0&&this._sel!=null&&this._isSelectorVisible()&&N==this._sel._t?this._hideSelector():((!this._sel||!this._sel._ta[N])&&this._initSelector(N,P),this._selCover.style.display="",this._sel._t=N,this._sel.style.left=M+"px",this._sel.style.top=Q+"px",this._sel.style.display="",this._sel.className="dhtmlxcalendar_selector_obj dhtmlxcalendar_"+P,this._doOnSelectorShow(N))};this._doOnSelectorShow=function(M){M=="month"&&this._updateActiveMonth();M=="year"&&this._updateYearsList(this._activeMonth);M=="hours"&&this._updateActiveHours();M=="minutes"&&this._updateActiveMinutes()};this._hideSelector=function(){if(this._sel){this._sel.style.display="none",this._selCover.style.display="none"}};this._isSelectorVisible=function(){return !this._sel?!1:this._sel.style.display!="none"};this._doOnSelectorChange=function(M){this.callEvent("onChange",[new Date(this._activeMonth.getFullYear(),this._activeMonth.getMonth(),this._activeDate.getDate(),this._activeDate.getHours(),this._activeDate.getMinutes(),this._activeDate.getSeconds()),M])};this._clearSelHover=function(){if(this._selHover){this._selHover.className=String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi,"")),this._selHover=null}};this._updateActiveMonth=function(){if(typeof this._msActive!="undefined"&&typeof this._msCells[this._msActive]!="undefined"){this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell"}this._msActive=this._activeMonth.getMonth();this._msCells[this._msActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateActiveYear=function(){var M=this._activeMonth.getFullYear();if(this._ysCells[M]){this._ysCells[M].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"}};this._updateYearsList=function(N){for(var M in this._ysCells){this._ysCells[M]=null,delete this._ysCells[M]}for(var Q=12*Math.floor(N.getFullYear()/12),P=0;P<4;P++){for(var O=0;O<3;O++){this.ysCont.childNodes[P].childNodes[O].innerHTML=Q,this.ysCont.childNodes[P].childNodes[O]._year=Q,this.ysCont.childNodes[P].childNodes[O].className="dhtmlxcalendar_selector_cell",this._ysCells[Q++]=this.ysCont.childNodes[P].childNodes[O]}}this._updateActiveYear()};this._scrollYears=function(N){var M=(N<0?this.ysCont.firstChild.firstChild._year:this.ysCont.lastChild.lastChild._year)+N,O=new Date(M,this._activeMonth.getMonth(),1,0,0,0,0);this._updateYearsList(O)};this._updateActiveHours=function(){if(typeof this._hsActive!="undefined"&&typeof this._hsCells[this._hsActive]!="undefined"){this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell"}this._hsActive=this._activeDate.getHours();this._hsCells[this._hsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"};this._updateVisibleHours=function(){this.contTime.firstChild.firstChild.childNodes[1].innerHTML=this._fixLength(this._activeDate.getHours(),2)};this._updateActiveMinutes=function(){if(typeof this._rsActive!="undefined"&&typeof this._rsCells[this._rsActive]!="undefined"){this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell"}this._rsActive=this._activeDate.getMinutes();if(typeof this._rsCells[this._rsActive]!="undefined"){this._rsCells[this._rsActive].className="dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"}};this._updateVisibleMinutes=function(){this.contTime.firstChild.firstChild.childNodes[3].innerHTML=this._fixLength(this._activeDate.getMinutes(),2)};this._fixLength=function(N,M){for(;String(N).length<M;){N="0"+String(N)}return N};this._dateFormat="";this._dateFormatRE=null;this.setDateFormat=function(M){this._dateFormat=M;this._dateFormatRE=RegExp(String(this._dateFormat).replace(/%[a-zA-Z]+/g,function(O){var N=O.replace(/%/,"");switch(N){case"n":case"j":case"g":case"G":return"\\d{1,2}";case"m":case"d":case"H":case"i":case"s":case"y":return"\\d{2}";case"Y":return"\\d{4}";case"M":return"("+F.langData[F.lang].monthesSNames.join("|").toLowerCase()+"){1,}";case"F":return"("+F.langData[F.lang].monthesFNames.join("|").toLowerCase()+"){1,}"}return O}),"i")};this.setDateFormat("%Y-%m-%d");this._getInd=function(N,M){for(var O=0;O<M.length;O++){if(M[O].toLowerCase()==N){return O}}return -1};this._strToDate=function(N,M){var M=M||this._dateFormat,U=N.match(/[a-z0-9]{1,}/gi),T=M.match(/%[a-zA-Z]/g);if(!U){return"Invalid Date"}for(var S=new Date,Q=0;Q<U.length;Q++){switch(T[Q]){case"%d":case"%j":case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":if(!isNaN(U[Q])){S[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds"}[T[Q]]](Number(U[Q])+(T[Q]=="%m"||T[Q]=="%n"?-1:0))}break;case"%M":case"%F":var P=this._getInd(U[Q].toLowerCase(),F.langData[F.lang][{"%M":"monthesSNames","%F":"monthesFNames"}[T[Q]]]);P>=0&&S.setMonth(P);break;case"%y":if(!isNaN(U[Q])){var O=Number(U[Q]);S.setFullYear(O+(O>50?1900:2000))}break;case"%g":case"%h":isNaN(U[Q])||(O=Number(U[Q]),O<=12&&O>=0&&S.setHours(O+(this._getInd("pm",U)>=0?12:0)))}}return S};this._dateToStr=function(N,M){if(N instanceof Date){var Q=function(S){return String(S).length==1?"0"+String(S):S},P=function(S){switch(S){case"%d":return Q(N.getDate());case"%j":return N.getDate();case"%D":return F.langData[F.lang].daysSNames[N.getDay()];case"%l":return F.langData[F.lang].daysFNames[N.getDay()];case"%m":return Q(N.getMonth()+1);case"%n":return N.getMonth()+1;case"%M":return F.langData[F.lang].monthesSNames[N.getMonth()];case"%F":return F.langData[F.lang].monthesFNames[N.getMonth()];case"%y":return Q(N.getYear()%100);case"%Y":return N.getFullYear();case"%g":return(N.getHours()+11)%12+1;case"%h":return Q((N.getHours()+11)%12+1);case"%G":return N.getHours();case"%H":return Q(N.getHours());case"%i":return Q(N.getMinutes());case"%s":return Q(N.getSeconds());case"%a":return N.getHours()>11?"pm":"am";case"%A":return N.getHours()>11?"PM":"AM";default:return S}},O=String(M||this._dateFormat).replace(/%[a-zA-Z]/g,P)}return O||String(N)};this._updateDateStr=function(N){if(N==""){this.setDate(new Date),this.callEvent("onChange",[null,!0])}else{if(this._dateFormatRE&&N.match(this._dateFormatRE)){var M=this._strToDate(N);if(M instanceof Date){this._nullDate=!1,this._activeDate=M,this._drawMonth(this._nullDate?new Date:this._activeDate),this._updateVisibleMinutes(),this._updateVisibleHours(),this._sel&&this._isSelectorVisible()&&this._doOnSelectorShow(this._sel._t),this._doOnSelectorChange(!0)}}}};this.setFormatedDate=function(N,M,Q,P){var O=this._strToDate(M,N);if(P){return O}this.setDate(O)};this.getFormatedDate=function(N,M){if(this._nullDate){return""}M&&M instanceof Date||(M=new Date(this._activeDate));return this._dateToStr(M,N)};this.show=function(N){if(!N&&this._hasParent){this._show()}else{if(typeof N=="object"&&typeof N._dhtmlxcalendar_uid!="undefined"&&this.i[N._dhtmlxcalendar_uid]==N){this._show(N._dhtmlxcalendar_uid)}else{if(typeof N=="undefined"){for(var M in this.i){N||(N=M)}}N&&this._show(N)}}};this.hide=function(){this._isVisible()&&this._hide()};this.isVisible=function(){return this._isVisible()};this.draw=function(){this.show()};this.close=function(){this.hide()};this._activeInp=null;this.pos="bottom";this.setPosition=function(N,M){this._py=this._px=null;if(N=="right"||N=="bottom"){this.pos=N}else{this.pos="int";if(typeof N!="undefined"&&!isNaN(N)){this.base.style.left=N+"px",this._px=N}if(typeof M!="undefined"&&!isNaN(M)){this.base.style.top=M+"px",this._py=M}this._ifrSize()}};this._show=function(N,M){if(M===!0&&this._activeInp==N&&this._isVisible()){this._hide()}else{if(N?(this.pos=="right"?(this.base.style.left=this._getLeft(this.i[N])+this.i[N].offsetWidth-1+"px",this.base.style.top=this._getTop(this.i[N])+"px"):this.pos=="bottom"?(this.base.style.left=this._getLeft(this.i[N])+"px",this.base.style.top=this._getTop(this.i[N])+this.i[N].offsetHeight-1+"px"):(this.base.style.left=(this._px||0)+"px",this.base.style.top=(this._py||0)+"px"),this._activeInp=N):this._px&&this._py?(this.base.style.left=this._px+"px",this.base.style.top=this._py+"px"):(this.base.style.left="0px",this.base.style.top="0px"),this._hideSelector(),this.base.style.display="",this._ifrSize(),this._ifr){this._ifr.style.display=""}}};this._hide=function(){this._hideSelector();this.base.style.display="none";this._activeInp=null;if(this._ifr){this._ifr.style.display="none"}};this._isVisible=function(){return this.base.style.display!="none"};this._getLeft=function(M){return this._posGetOffset(M).left};this._getTop=function(M){return this._posGetOffset(M).top};this._posGetOffsetSum=function(N){for(var M=0,O=0;N;){M+=parseInt(N.offsetTop),O+=parseInt(N.offsetLeft),N=N.offsetParent}return{top:M,left:O}};this._posGetOffsetRect=function(W){var V=W.getBoundingClientRect(),U=document.body,T=document.documentElement,S=window.pageYOffset||T.scrollTop||U.scrollTop,Q=window.pageXOffset||T.scrollLeft||U.scrollLeft,P=T.clientTop||U.clientTop||0,O=T.clientLeft||U.clientLeft||0,N=V.top+S-P,M=V.left+Q-O;return{top:Math.round(N),left:Math.round(M)}};this._posGetOffset=function(M){return this[M.getBoundingClientRect?"_posGetOffsetRect":"_posGetOffsetSum"](M)};this._rangeActive=!1;this._rangeTo=this._rangeFrom=null;this._rangeSet={};this.setInsensitiveDays=function(N){for(var M=this._extractDates(N),O=0;O<M.length;O++){this._rangeSet[(new Date(M[O].getFullYear(),M[O].getMonth(),M[O].getDate(),0,0,0,0)).getTime()]=!0}this._drawMonth(this._activeMonth)};this.clearInsensitiveDays=function(){this._clearRangeSet();this._drawMonth(this._activeMonth)};this._holidays={};this.setHolidays=function(N){if(N==null){this._clearHolidays()}else{if(N!=null){for(var M=this._extractDates(N),O=0;O<M.length;O++){this._holidays[(new Date(M[O].getFullYear(),M[O].getMonth(),M[O].getDate(),0,0,0,0)).getTime()]=!0}}}this._drawMonth(this._activeMonth)};this._extractDates=function(N){if(typeof N=="string"||N instanceof Date){N=[N]}for(var M=[],Q=0;Q<N.length;Q++){if(typeof N[Q]=="string"){for(var P=N[Q].split(","),O=0;O<P.length;O++){M.push(this._strToDate(P[O]))}}else{N[Q] instanceof Date&&M.push(N[Q])}}return M};this._clearRange=function(){this._rangeActive=!1;this._rangeTo=this._rangeFrom=this._rangeType=null};this._clearRangeSet=function(){for(var M in this._rangeSet){this._rangeSet[M]=null,delete this._rangeSet[M]}};this._clearHolidays=function(){for(var M in this._holidays){this._holidays[M]=null,delete this._holidays[M]}};this._isOutOfRange=function(N){if(this._rangeSet[N]==!0){return !0}if(this._rangeActive){if(this._rangeType=="in"&&(N<this._rangeFrom||N>this._rangeTo)){return !0}if(this._rangeType=="out"&&N>=this._rangeFrom&&N<=this._rangeTo){return !0}if(this._rangeType=="from"&&N<this._rangeFrom){return !0}if(this._rangeType=="to"&&N>this._rangeTo){return !0}}var M=new Date(N);return this._rangeWeek&&this._rangeWeekData[M.getDay()]===!0?!0:this._rangeMonth&&this._rangeMonthData[M.getDate()]===!0?!0:this._rangeYear&&this._rangeYearData[M.getMonth()+"_"+M.getDate()]===!0?!0:!1};this.clearSensitiveRange=function(){this._clearRange();this._drawMonth(this._activeMonth)};this.setSensitiveRange=function(N,M,P){var O=!1;if(N!=null&&M!=null){N instanceof Date||(N=this._strToDate(N));M instanceof Date||(M=this._strToDate(M));if(N.getTime()>M.getTime()){return }this._rangeFrom=(new Date(N.getFullYear(),N.getMonth(),N.getDate(),0,0,0,0)).getTime();this._rangeTo=(new Date(M.getFullYear(),M.getMonth(),M.getDate(),0,0,0,0)).getTime();this._rangeActive=!0;this._rangeType="in";O=!0}if(!O&&N!=null&&M==null){N instanceof Date||(N=this._strToDate(N)),this._rangeFrom=(new Date(N.getFullYear(),N.getMonth(),N.getDate(),0,0,0,0)).getTime(),this._rangeTo=null,P===!0&&this._rangeFrom++,this._rangeActive=!0,this._rangeType="from",O=!0}if(!O&&N==null&&M!=null){M instanceof Date||(M=this._strToDate(M)),this._rangeFrom=null,this._rangeTo=(new Date(M.getFullYear(),M.getMonth(),M.getDate(),0,0,0,0)).getTime(),P===!0&&this._rangeTo--,this._rangeActive=!0,this._rangeType="to",O=!0}O&&this._drawMonth(this._activeMonth)};this.setInsensitiveRange=function(N,M){if(N!=null&&M!=null){if(N instanceof Date||(N=this._strToDate(N)),M instanceof Date||(M=this._strToDate(M)),!(N.getTime()>M.getTime())){this._rangeFrom=(new Date(N.getFullYear(),N.getMonth(),N.getDate(),0,0,0,0)).getTime(),this._rangeTo=(new Date(M.getFullYear(),M.getMonth(),M.getDate(),0,0,0,0)).getTime(),this._rangeActive=!0,this._rangeType="out",this._drawMonth(this._activeMonth)}}else{N!=null&&M==null?this.setSensitiveRange(null,N,!0):N==null&&M!=null&&this.setSensitiveRange(M,null,!0)}};this.disableDays=function(N,M){if(N=="week"){typeof M!="object"&&typeof M.length=="undefined"&&(M=[M]);if(!this._rangeWeekData){this._rangeWeekData={}}for(var Q in this._rangeWeekData){this._rangeWeekData[Q]=!1,delete this._rangeWeekData[Q]}for(var P=0;P<M.length;P++){this._rangeWeekData[M[P]]=!0,M[P]==7&&(this._rangeWeekData[0]=!0)}this._rangeWeek=!0}if(N=="month"){typeof M!="object"&&typeof M.length=="undefined"&&(M=[M]);if(!this._rangeMonthData){this._rangeMonthData={}}for(Q in this._rangeMonthData){this._rangeMonthData[Q]=!1,delete this._rangeMonthData[Q]}for(P=0;P<M.length;P++){this._rangeMonthData[M[P]]=!0}this._rangeMonth=!0}if(N=="year"){var O=this._extractDates(M);if(!this._rangeYearData){this._rangeYearData={}}for(Q in this._rangeYearData){this._rangeYearData[Q]=!1,delete this._rangeYearData[Q]}for(P=0;P<O.length;P++){this._rangeYearData[O[P].getMonth()+"_"+O[P].getDate()]=!0}this._rangeYear=!0}this._drawMonth(this._activeMonth)};this.enableDays=function(M){if(M=="week"){this._rangeWeek=!1}if(M=="month"){this._rangeMonth=!1}if(M=="year"){this._rangeYear=!1}this._drawMonth(this._activeMonth)};this._doOnClick=function(N){var N=N||event,M=N.target||N.srcElement;if(M._dhtmlxcalendar_uid&&M._dhtmlxcalendar_uid!=F._activeInp&&F._isVisible()&&F._activeInp){F._hide()}else{if(!M._dhtmlxcalendar_uid||!F.i[M._dhtmlxcalendar_uid]){F._isSelectorVisible()?F._hideSelector():!F._hasParent&&F._isVisible()&&F._hide()}}};this._doOnKeyDown=function(M){M=M||event;if(M.keyCode==27||M.keyCode==13){F._isSelectorVisible()?F._hideSelector():F._isVisible()&&!F._hasParent&&F._hide()}};this._doOnInpClick=function(N){var N=N||event,M=N.target||N.srcElement;M._dhtmlxcalendar_uid&&(F._nullInInput&&M.value.replace(/\s/g,"").length==0?F.setDate(null):F._updateDateStr(M.value),F._show(M._dhtmlxcalendar_uid,!0))};this._doOnInpKeyUp=function(N){var N=N||event,M=N.target||N.srcElement;N.keyCode!=13&&M._dhtmlxcalendar_uid&&(F._nullInInput&&M.value.replace(/\s/g,"").length==0?F.setDate(null):F._updateDateStr(M.value))};this._doOnUnload=function(){F.unload()};window.addEventListener?(document.body.addEventListener("click",F._doOnClick,!1),window.addEventListener("keydown",F._doOnKeyDown,!1),window.addEventListener("unload",F._doOnUnload,!1)):(document.body.attachEvent("onclick",F._doOnClick),document.body.attachEvent("onkeydown",F._doOnKeyDown),window.attachEvent("onunload",F._doOnUnload));this.attachObj=function(N){var M=this.uid();this.i[M]=N;this._attachEventsToObject(M)};this.detachObj=function(N){var M=N._dhtmlxcalendar_uid;if(this.i[M]!=null){this._detachEventsFromObject(M),this.i[M]._dhtmlxcalendar_uid=null,this.i[M]=null,delete this.i[M]}};this._attachEventsToObject=function(M){this.i[M]._dhtmlxcalendar_uid=M;window.addEventListener?(this.i[M].addEventListener("click",F._doOnInpClick,!1),this.i[M].addEventListener("keyup",F._doOnInpKeyUp,!1)):(this.i[M].attachEvent("onclick",F._doOnInpClick),this.i[M].attachEvent("onkeyup",F._doOnInpKeyUp))};this._detachEventsFromObject=function(M){window.addEventListener?(this.i[M].removeEventListener("click",F._doOnInpClick,!1),this.i[M].removeEventListener("keyup",F._doOnInpKeyUp,!1)):(this.i[M].detachEvent("onclick",F._doOnInpClick),this.i[M].detachEvent("onkeyup",F._doOnInpKeyUp))};for(var A in this.i){this._attachEventsToObject(A)}this.evs={};this.attachEvent=function(N,M){var O=this.uid();this.evs[O]={name:String(N).toLowerCase(),func:M};return O};this.detachEvent=function(M){if(this.evs[M]){this.evs[M].name=null,this.evs[M].func=null,this.evs[M]=null,delete this.evs[M]}};this.callEvent=function(N,M){var S=!0,Q=String(N).toLowerCase(),M=M||[],P;for(P in this.evs){if(this.evs[P].name==Q){var O=this.evs[P].func.apply(this,M),S=S&&O}}return S};this.checkEvent=function(N){var M=!1,P=String(N).toLowerCase(),O;for(O in this.evs){M=M||this.evs[O].name==P}return M};this.unload=function(){this.uidd=this.uid=this._lastHover=this._dateFormatRE=this._dateFormat=this._activeMonth=this._activeInp=this._activeDateCell=this._activeDate=null;window.addEventListener?(document.body.removeEventListener("click",F._doOnClick,!1),window.removeEventListener("keydown",F._doOnKeyDown,!1),window.removeEventListener("unload",F._doOnUnload,!1)):(document.body.detachEvent("onclick",F._doOnClick),document.body.detachEvent("onkeydown",F._doOnKeyDown),window.detachEvent("onunload",F._doOnKeyDown));this._doOnUnload=this._doOnKeyDown=this._doOnClick=null;for(var M in this.i){this.i[M]._dhtmlxcalendar_uid=null,window.addEventListener?(this.i[M].removeEventListener("click",F._doOnInpClick,!1),this.i[M].removeEventListener("keyup",F._doOnInpKeyUp,!1)):(this.i[M].detachEvent("onclick",F._doOnInpClick),this.i[M].detachEvent("onkeyup",F._doOnInpKeyUp)),this.i[M]=null,delete this.i[M]}this._doOnInpKeyUp=this._doOnInpClick=this.i=null;for(M in this.evs){this.detachEvent(M)}this.callEvent=this.checkEvent=this.detachEvent=this.attachEvent=this.evs=null;this.contMonth.onselectstart=null;this.contMonth.firstChild.firstChild.onclick=null;this.contMonth.firstChild.firstChild.firstChild.onmouseover=null;this.contMonth.firstChild.firstChild.firstChild.onmouseout=null;this.contMonth.firstChild.firstChild.lastChild.onmouseover=null;for(this.contMonth.firstChild.firstChild.lastChild.onmouseout=null;this.contMonth.firstChild.firstChild.childNodes.length>0;){this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild)}this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild);this.contMonth.removeChild(this.contMonth.firstChild);this.contMonth.parentNode.removeChild(this.contMonth);for(this.contMonth=null;this.contDays.firstChild.childNodes.length>0;){this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild)}this.contDays.removeChild(this.contDays.firstChild);this.contDays.parentNode.removeChild(this.contDays);this.contDays=null;this.contDates.onclick=null;this.contDates.onmouseover=null;for(this.contDates.onmouseout=null;this.contDates.childNodes.length>0;){for(;this.contDates.lastChild.childNodes.length>0;){this.contDates.lastChild.lastChild._css_date=null,this.contDates.lastChild.lastChild._css_month=null,this.contDates.lastChild.lastChild._css_weekend=null,this.contDates.lastChild.lastChild._css_hover=null,this.contDates.lastChild.lastChild._date=null,this.contDates.lastChild.lastChild._q=null,this.contDates.lastChild.lastChild._w=null,this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild)}this.contDates.removeChild(this.contDates.lastChild)}this.contDates.parentNode.removeChild(this.contDates);this.contDates=null;for(this.contTime.firstChild.firstChild.onclick=null;this.contTime.firstChild.firstChild.childNodes.length>0;){this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild)}this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild);this.contTime.removeChild(this.contTime.firstChild);this.contTime.parentNode.removeChild(this.contTime);this._lastHover=this.contTime=null;if(this.msCont){this._msActive=this.msCont.onclick=null;for(M in this._msCells){this._msCells[M]._cell=null,this._msCells[M]._month=null,this._msCells[M].parentNode.removeChild(this._msCells[M]),this._msCells[M]=null}for(this._msCells=null;this.msCont.childNodes.length>0;){this.msCont.removeChild(this.msCont.lastChild)}this.msCont.parentNode.removeChild(this.msCont);this.msCont=null}if(this.ysCont){this.ysCont.onclick=null;for(M in this._ysCells){this._ysCells[M]._cell=null,this._ysCells[M]._year=null,this._ysCells[M].parentNode.removeChild(this._ysCells[M]),this._ysCells[M]=null}for(this._ysCells=null;this.ysCont.childNodes.length>0;){this.ysCont.removeChild(this.ysCont.lastChild)}this.ysCont.parentNode.removeChild(this.ysCont);this.ysCont=null}if(this.hsCont){this._hsActive=this.hsCont.onclick=null;for(M in this._hsCells){this._hsCells[M]._cell=null,this._hsCells[M]._hours=null,this._hsCells[M].parentNode.removeChild(this._hsCells[M]),this._hsCells[M]=null}for(this._hsCells=null;this.hsCont.childNodes.length>0;){this.hsCont.removeChild(this.hsCont.lastChild)}this.hsCont.parentNode.removeChild(this.hsCont);this.hsCont=null}if(this.rsCont){this._rsActive=this.rsCont.onclick=null;for(M in this._rsCells){this._rsCells[M]._cell=null,this._rsCells[M]._minutes=null,this._rsCells[M].parentNode.removeChild(this._rsCells[M]),this._rsCells[M]=null}for(this._rsCells=null;this.rsCont.childNodes.length>0;){this.rsCont.removeChild(this.rsCont.lastChild)}this.rsCont.parentNode.removeChild(this.rsCont);this.rsCont=null}if(this._selCover){this._selCover.parentNode.removeChild(this._selCover),this._selCover=null}if(this._sel){for(M in this._sel._ta){this._sel._ta[M]=null}this._sel._ta=null;this._sel._t=null;this._sel.onmouseover=null;for(this._sel.onmouseout=null;this._sel.firstChild.firstChild.firstChild.childNodes.length>0;){this._sel.firstChild.firstChild.firstChild.lastChild.onclick=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover=null,this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout=null,this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild)}this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild);for(this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);this._sel.childNodes.length>0;){this._sel.removeChild(this._sel.lastChild)}this._sel.parentNode.removeChild(this._sel);this._sel=null}this.base.onclick=null;this.base.parentNode.removeChild(this.base);this.unload=this.showTime=this.show=this.setDateFormat=this.setDate=this.hideTime=this.hide=this._updateYearsList=this._updateVisibleMinutes=this._updateVisibleHours=this._updateDateStr=this._updateCellStyle=this._updateActiveYear=this._updateActiveMonth=this._updateActiveMinutes=this._updateActiveHours=this._strToDate=this._showSelector=this._show=this._scrollYears=this._posGetOffsetSum=this._posGetOffsetRect=this._posGetOffset=this._isVisible=this._isSelectorVisible=this._initSelector=this._hideSelector=this._hide=this._getTop=this._getLeft=this._fixLength=this._drawMonth=this._doOnSelectorShow=this._doOnSelectorChange=this._clearSelHover=this._clearDayHover=this.base=null;for(M in this){delete this[M]}M=F=null};this.setDate(this._activeDate);return this}dhtmlXCalendarObject.prototype.setYearsRange=function(){};dhtmlXCalendarObject.prototype.lang="en";dhtmlXCalendarObject.prototype.langData={en:{dateformat:"%Y-%m-%d",monthesFNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),monthesSNames:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),daysFNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),daysSNames:"Su,Mo,Tu,We,Th,Fr,Sa".split(","),weekstart:1}};dhtmlXCalendarObject.prototype.enableIframe=function(A){if(A==!0){if(!this._ifr){this._ifr=document.createElement("IFRAME"),this._ifr.frameBorder=0,this._ifr.border=0,this._ifr.setAttribute("src","javascript:false;"),this._ifr.className="dhtmlxcalendar_ifr",this._ifr.onload=function(){this.onload=null;this.contentWindow.document.open("text/html","replace");this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")},this.base.parentNode.insertBefore(this._ifr,this.base),this._ifrSize()}}else{if(this._ifr){this._ifr.parentNode.removeChild(this._ifr),this._ifr=null}}};dhtmlXCalendarObject.prototype._ifrSize=function(){if(this._ifr){this._ifr.style.left=this.base.style.left,this._ifr.style.top=this.base.style.top,this._ifr.style.width=this.base.offsetWidth+"px",this._ifr.style.height=this.base.offsetHeight+"px"}};dhtmlxCalendarObject=dhtmlXCalendarObject;function dhtmlXAccordionItem(){}function dhtmlXAccordion(C,E){if(window.dhtmlXContainer){var A=this;this.skin=E!=null?E:"dhx_skyblue";if(C==document.body){this._isAccFS=!0;document.body.className+=" dhxacc_fullscreened";var D=document.createElement("DIV");D.className="dhxcont_global_layout_area";C.appendChild(D);this.cont=new dhtmlXContainer(C);this.cont.setContent(D);C.adjustContent(C,0);this.base=document.createElement("DIV");this.base.className="dhx_acc_base_"+this.skin;this.base.style.overflow="hidden";this.base.style.position="absolute";this._adjustToFullScreen=function(){this.base.style.left="2px";this.base.style.top="2px";this.base.style.width=parseInt(D.childNodes[0].style.width)-4+"px";this.base.style.height=parseInt(D.childNodes[0].style.height)-4+"px"};this._adjustToFullScreen();D.childNodes[0].appendChild(this.base);this._resizeTM=null;this._resizeTMTime=400;this._doOnResize=function(){window.clearTimeout(A._resizeTM);A._resizeTM=window.setTimeout(function(){A._adjustAccordion()},A._resizeTMTime)};this._adjustAccordion=function(){document.body.adjustContent(document.body,0);this._adjustToFullScreen();this.setSizes()};dhtmlxEvent(window,"resize",this._doOnResize)}else{this.base=typeof C=="string"?document.getElementById(C):C,this.base.className="dhx_acc_base_"+this.skin,this.base.innerHTML=""}this.w=this.base.offsetWidth;this.h=this.base.offsetHeight;this.skinParams={dhx_blue:{cell_height:24,cell_space:1,content_offset:1},dhx_skyblue:{cell_height:27,cell_space:-1,content_offset:-1},dhx_black:{cell_height:24,cell_space:1,content_offset:1},dhx_web:{cell_height:26,cell_space:9,content_offset:0,cell_pading_max:1,cell_pading_min:0}};this.sk=this.skinParams[this.skin];this.setSkinParameters=function(H,F){isNaN(H)||(this.sk.cell_space=H);isNaN(F)||(this.sk.content_offset=F);this._reopenItem()};this.setSkin=function(H){if(this.skinParams[H]){this.skin=H;this.sk=this.skinParams[this.skin];this.base.className="dhx_acc_base_"+this.skin+(this._r?" dhx_acc_rtl":"");for(var F in this.idPull){this.idPull[F].skin=this.skin}this._reopenItem()}};this.idPull={};this.opened=null;this.cells=function(F){return this.idPull[F]==null?null:this.idPull[F]};this.itemH=90;this.multiMode=!1;this.enableMultiMode=function(){var H=0,F;for(F in this.idPull){H++}if(H==0){this.userOffset||(this.skinParams.dhx_skyblue.cell_space=3),this.multiMode=!0}};this.userOffset=!1;this.setOffset=function(H,F){this.userOffset=!0;isNaN(H)||(this.skinParams[this.skin].cell_space=H);isNaN(F)||(this.skinParams[this.skin].content_offset=F);this.setSizes()};this.imagePath="";this.setIconsPath=function(F){this.imagePath=F};this.addItem=function(F,L){var K=document.createElement("DIV");K.className="dhx_acc_item";K.dir="ltr";K._isAcc=!0;K.skin=this.skin;this.base.appendChild(K);if(this.multiMode){K.h=this.itemH}var J=document.createElement("DIV");J._idd=F;J.className="dhx_acc_item_label";J.innerHTML="<span>"+L+"</span><div class='dhx_acc_item_label_btmbrd'>&nbsp;</div><div class='dhx_acc_item_arrow'></div><div class='dhx_acc_hdr_line_l'></div><div class='dhx_acc_hdr_line_r'></div>";J.onselectstart=function(M){M=M||event;M.returnValue=!1};J.onclick=function(){if(A.multiMode||!A.idPull[this._idd]._isActive){A.multiMode?A.idPull[this._idd]._isActive?A.checkEvent("onBeforeActive")?A.callEvent("onBeforeActive",[this._idd,"close"])&&A.closeItem(this._idd,"dhx_accord_outer_event"):A.closeItem(this._idd,"dhx_accord_outer_event"):A.checkEvent("onBeforeActive")?A.callEvent("onBeforeActive",[this._idd,"open"])&&A.openItem(this._idd,"dhx_accord_outer_event"):A.openItem(this._idd,"dhx_accord_outer_event"):A.checkEvent("onBeforeActive")?A.callEvent("onBeforeActive",[this._idd,"open"])&&A.openItem(this._idd,"dhx_accord_outer_event"):A.openItem(this._idd,"dhx_accord_outer_event")}};J.onmouseover=function(){this.className="dhx_acc_item_label dhx_acc_item_lavel_hover"};J.onmouseout=function(){this.className="dhx_acc_item_label"};K.appendChild(J);var I=document.createElement("DIV");I.className="dhxcont_global_content_area";K.appendChild(I);var H=new dhtmlXContainer(K);H.setContent(I);K.adjustContent(K,this.sk.cell_height+this.sk.content_offset);K._id=F;this.idPull[F]=K;K.getId=function(){return this._id};K.setText=function(M){A.setText(this._id,M)};K.getText=function(){return A.getText(this._id)};K.open=function(){A.openItem(this._id)};K.isOpened=function(){return A.isActive(this._id)};K.close=function(){A.closeItem(this._id)};K.setIcon=function(M){A.setIcon(this._id,M)};K.clearIcon=function(){A.clearIcon(this._id)};K.dock=function(){A.dockItem(this._id)};K.undock=function(){A.undockItem(this._id)};K.show=function(){A.showItem(this._id)};K.hide=function(){A.hideItem(this._id)};K.setHeight=function(M){A.setItemHeight(this._id,M)};K.moveOnTop=function(){A.moveOnTop(this._id)};K._doOnAttachMenu=function(){A._reopenItem()};K._doOnAttachToolbar=function(){A._reopenItem()};K._doOnAttachStatusBar=function(){A._reopenItem()};K._doOnFrameContentLoaded=function(){A.callEvent("onContentLoaded",[this])};this.openItem(F);this.multiMode||this._defineLastItem();return K};this.openItem=function(H,F,K){if(!this._openBuzy){if(this._enableOpenEffect&&!K){(!this.multiMode||!this.idPull[H]._isActive)&&this._openWithEffect(H,null,null,null,null,F)}else{if(this.multiMode){for(var J in this.idPull){if(this.idPull[J]._isActive||J==H){this.idPull[J].style.height=this.idPull[J].h+"px",this.idPull[J].childNodes[1].style.display="",this.skin=="dhx_web"&&this.idPull[J]._setPadding(this.skinParams[this.skin].cell_pading_max,"dhxcont_acc_dhx_web"),this.idPull[J].adjustContent(this.idPull[J],this.sk.cell_height+this.sk.content_offset,null,null,this.idPull[J]==this._lastVisible()&&this.skin!="dhx_web"?0:this.sk.cell_space),this.idPull[J].updateNestedObjects(),this.idPull[J]._isActive=!0,this._updateArrows(),F=="dhx_accord_outer_event"&&J==H&&this.callEvent("onActive",[H,!0])}}}else{if(!H||!this.idPull[H]._isActive||K){var I=0;for(J in this.idPull){if(this.idPull[J].style.height=this.sk.cell_height+(this.idPull[J]!=this._lastVisible()&&J!=H?this.sk.cell_space:0)+"px",J!=H){this.idPull[J].childNodes[1].style.display="none",this.skin=="dhx_web"&&this.idPull[J]._setPadding(this.skinParams[this.skin].cell_pading_min,""),this.idPull[J]._isActive=!1,I+=this.idPull[J].offsetHeight}}I=this.base.offsetHeight-I;if(H){this.idPull[H].style.height=I+"px",this.idPull[H].childNodes[1].style.display="",this.skin=="dhx_web"&&this.idPull[H]._setPadding(this.skinParams[this.skin].cell_pading_max,"dhxcont_acc_dhx_web"),this.idPull[H].adjustContent(this.idPull[H],this.sk.cell_height+this.sk.content_offset,null,null,this.idPull[H]==this._lastVisible()?0:this.sk.cell_space),this.idPull[H].updateNestedObjects(),this.idPull[H]._isActive=!0,F=="dhx_accord_outer_event"&&this.callEvent("onActive",[H,!0])}this._updateArrows()}}}}};this._lastVisible=function(){for(var H=null,F=this.base.childNodes.length-1;F>=0;F--){!this.base.childNodes[F]._isHidden&&!H&&(H=this.base.childNodes[F])}return H};this.closeItem=function(H,F){if(this.idPull[H]!=null&&this.idPull[H]._isActive&&!this._openBuzy){this._enableOpenEffect?this._openWithEffect(this.multiMode?H:null,null,null,null,null,F):(this.idPull[H].style.height=this.sk.cell_height+(this.idPull[H]!=this._lastVisible()?this.sk.cell_space:0)+"px",this.idPull[H].childNodes[1].style.display="none",this.skin=="dhx_web"&&this.idPull[H]._setPadding(this.skinParams[this.skin].cell_pading_min,""),this.idPull[H]._isActive=!1,F=="dhx_accord_outer_event"&&this.callEvent("onActive",[H,!1]),this._updateArrows())}};this._updateArrows=function(){for(var H in this.idPull){for(var F=this.idPull[H].childNodes[0],J=null,I=0;I<F.childNodes.length;I++){String(F.childNodes[I].className).search("dhx_acc_item_arrow")!=-1&&(J=F.childNodes[I])}if(J!=null){J.className="dhx_acc_item_arrow "+(this.idPull[H]._isActive?"item_opened":"item_closed"),J=null}}};this.setText=function(F,L,K){if(A.idPull[F]!=null){for(var J=A.idPull[F].childNodes[0],I=null,H=0;H<J.childNodes.length;H++){J.childNodes[H].tagName!=null&&String(J.childNodes[H].tagName).toLowerCase()=="span"&&(I=J.childNodes[H])}isNaN(K)?I.innerHTML=L:(I.style.paddingLeft=K+"px",I.style.paddingRight=K+"px")}};this.getText=function(F){if(A.idPull[F]!=null){for(var J=A.idPull[F].childNodes[0],I=null,H=0;H<J.childNodes.length;H++){J.childNodes[H].tagName!=null&&String(J.childNodes[H].tagName).toLowerCase()=="span"&&(I=J.childNodes[H])}return I.innerHTML}};this._initWindows=function(H){if(window.dhtmlXWindows){if(!this.dhxWins&&(this.dhxWins=new dhtmlXWindows,this.dhxWins.setSkin(this.skin),this.dhxWins.setImagePath(this.imagePath),this.dhxWinsIdPrefix="",!H)){return }var F=this.dhxWinsIdPrefix+H;if(this.dhxWins.window(F)){this.dhxWins.window(F).show()}else{var J=this,I=this.dhxWins.createWindow(F,20,20,320,200);I.setText(this.getText(H));I.button("close").hide();I.attachEvent("onClose",function(K){K.hide()});I.addUserButton("dock",99,this.dhxWins.i18n.dock,"dock");I.button("dock").attachEvent("onClick",function(){J.cells(H).dock()})}}};this.dockWindow=function(F){if(this.idPull[F]._isUnDocked&&this.dhxWins&&this.dhxWins.window(this.dhxWinsIdPrefix+F)){this.dhxWins.window(this.dhxWinsIdPrefix+F).moveContentTo(this.idPull[F]),this.dhxWins.window(this.dhxWinsIdPrefix+F).close(),this.idPull[F]._isUnDocked=!1,this.showItem(F),this.callEvent("onDock",[F])}};this.undockWindow=function(F){if(!this.idPull[F]._isUnDocked){this._initWindows(F),this.idPull[F].moveContentTo(this.dhxWins.window(this.dhxWinsIdPrefix+F)),this.idPull[F]._isUnDocked=!0,this.hideItem(F),this.callEvent("onUnDock",[F])}};this.setSizes=function(){this._reopenItem()};this.showItem=function(F){if(this.idPull[F]!=null&&this.idPull[F]._isHidden){this.idPull[F]._isUnDocked?this.dockItem(F):(this.idPull[F].className="dhx_acc_item",this.idPull[F]._isHidden=!1,this._defineLastItem(),this._reopenItem())}};this.hideItem=function(F){if(this.idPull[F]!=null&&!this.idPull[F]._isHidden){this.closeItem(F),this.idPull[F].className="dhx_acc_item_hidden",this.idPull[F]._isHidden=!0,this._defineLastItem(),this._reopenItem()}};this._reopenItem=function(){var H=null,F;for(F in this.idPull){this.idPull[F]._isActive&&!this.idPull[F]._isHidden&&(H=F)}this.openItem(H,null,!0)};this.forEachItem=function(H){for(var F in this.idPull){H(this.idPull[F])}};this._enableOpenEffect=!1;this._openStep=10;this._openStepIncrement=5;this._openStepTimeout=10;this._openBuzy=!1;this.setEffect=function(F){this._enableOpenEffect=F==!0?!0:!1};this._openWithEffect=function(T,S,Q,P,O,N){if(this.multiMode){if(!O){this._openBuzy=!0,O=this._openStep,this.idPull[T]._isActive?(S=T,T=null,Q=this.sk.cell_height+(this.idPull[S]!=this._lastVisible()?this.sk.cell_space:0),this.idPull[S].childNodes[1].style.display=""):(P=this.idPull[T].h,this.idPull[T].childNodes[1].style.display="")}var M=!1;if(T){var L=parseInt(this.idPull[T].style.height)+O;L>P&&(L=P,M=!0);this.idPull[T].style.height=L+"px"}if(S){L=parseInt(this.idPull[S].style.height)-O,L<Q&&(L=Q,M=!0),this.idPull[S].style.height=L+"px"}O+=this._openStepIncrement;if(M){if(T){this.idPull[T].adjustContent(this.idPull[T],this.sk.cell_height+this.sk.content_offset,null,null,this.idPull[T]==this._lastVisible()?0:this.sk.cell_space),this.idPull[T].updateNestedObjects(),this.idPull[T]._isActive=!0}if(S){this.idPull[S].childNodes[1].style.display="none",this.idPull[S]._isActive=!1}this._updateArrows();this._openBuzy=!1;T&&N=="dhx_accord_outer_event"&&this.callEvent("onActive",[T,!0]);S&&N=="dhx_accord_outer_event"&&this.callEvent("onActive",[S,!1])}else{var K=this;window.setTimeout(function(){K._openWithEffect(T,S,Q,P,O,N)},this._openStepTimeout)}}else{if(!O&&(this._openBuzy=!0,O=this._openStep,T)){this.idPull[T].childNodes[1].style.display=""}if(!S||!Q||!P){var P=Q=0,I;for(I in this.idPull){var J=this.sk.cell_height+(this.idPull[I]!=this._lastVisible()&&I!=T?this.sk.cell_space:0);this.idPull[I]._isActive&&T!=I&&(S=I,Q=J);I!=T&&(P+=J)}P=this.base.offsetHeight-P}M=!1;if(T){var H=parseInt(this.idPull[T].style.height)+O;H>P&&(M=!0)}if(S){var F=parseInt(this.idPull[S].style.height)-O;F<Q&&(M=!0)}O+=this._openStepIncrement;M&&(H=P,F=Q);if(S){this.idPull[S].style.height=F+"px"}if(T){this.idPull[T].style.height=H+"px"}if(M){if(S){this.idPull[S].childNodes[1].style.display="none",this.idPull[S]._isActive=!1}if(T){this.idPull[T].adjustContent(this.idPull[T],this.sk.cell_height+this.sk.content_offset,null,null,this.idPull[T]==this._lastVisible()?0:this.sk.cell_space),this.idPull[T].updateNestedObjects(),this.idPull[T]._isActive=!0}this._updateArrows();this._openBuzy=!1;N=="dhx_accord_outer_event"&&T&&this.callEvent("onActive",[T,!0])}else{K=this,window.setTimeout(function(){K._openWithEffect(T,S,Q,P,O,N)},this._openStepTimeout)}}};this.setActive=function(F){this.openItem(F)};this.isActive=function(F){return this.idPull[F]._isActive===!0?!0:!1};this.dockItem=function(F){this.dockWindow(F)};this.undockItem=function(F){this.undockWindow(F)};this.setItemHeight=function(H,F){if(this.multiMode&&!isNaN(F)){this.idPull[H].h=F,this._reopenItem()}};this.setIcon=function(H,F){if(this.idPull[H]!=null){for(var K=this.idPull[H].childNodes[0],J=null,I=0;I<K.childNodes.length;I++){K.childNodes[I].className=="dhx_acc_item_icon"&&(J=K.childNodes[I])}if(J==null){J=document.createElement("IMG"),J.className="dhx_acc_item_icon",K.insertBefore(J,K.childNodes[0]),this.setText(H,null,20)}J.src=this.imagePath+F}};this.clearIcon=function(H){if(this.idPull[H]!=null){for(var F=this.idPull[H].childNodes[0],J=null,I=0;I<F.childNodes.length;I++){F.childNodes[I].className=="dhx_acc_item_icon"&&(J=F.childNodes[I])}J!=null&&(F.removeChild(J),J=null,this.setText(H,null,0))}};this.moveOnTop=function(F){this.idPull[F]&&!(this.base.childNodes.length<=1)&&(this.base.insertBefore(this.idPull[F],this.base.childNodes[0]),this.setSizes())};this._defineLastItem=function(){if(!this.multiMode){for(var H=!1,F=this.base.childNodes.length-1;F>=0;F--){if(this.base.childNodes[F].className.search("last_item")>=0){if(this.base.childNodes[F]._isHidden||H){this.base.childNodes[F].className=String(this.base.childNodes[F].className).replace(/last_item/gi,"")}}else{!this.base.childNodes[F]._isHidden&&!H&&(this.base.childNodes[F].className+=" last_item",H=!0)}}}};this.removeItem=function(H){var F=this.idPull[H],J=F.childNodes[0];J.onclick=null;J.onmouseover=null;J.onmouseout=null;J.onselectstart=null;J._idd=null;J.className="";for(F._dhxContDestruct();J.childNodes.length>0;){J.removeChild(J.childNodes[0])}J.parentNode&&J.parentNode.removeChild(J);for(J=null;F.childNodes.length>0;){F.removeChild(F.childNodes[0])}F._dhxContDestruct=null;F._doOnAttachMenu=null;F._doOnAttachToolbar=null;F._doOnAttachStatusBar=null;F.clearIcon=null;F.close=null;F.dock=null;F.getId=null;F.getText=null;F.hide=null;F.isOpened=null;F.open=null;F.setHeight=null;F.setIcon=null;F.setText=null;F.show=null;F.undock=null;F.parentNode&&F.parentNode.removeChild(F);F=null;this.idPull[H]=null;try{delete this.idPull[H]}catch(I){}};this.unload=function(){for(var H in this.skinParams){this.skinParams[H]=null;try{delete this.skinParams[H]}catch(F){}}this.skinParams=null;for(H in this.idPull){this.removeItem(H)}this.userOffset=this.unload=this.undockWindowunload=this.undockWindow=this.undockItem=this.w=this.skin=this.showItem=this.setText=this.setSkinParameters=this.setSkin=this.setSizes=this.setOffset=this.setItemHeight=this.setIconsPath=this.setIcon=this.setEffect=this.setActive=this.removeItem=this.openItem=this.multiMode=this.itemH=this.isActive=this.imagePath=this.hideItem=this.h=this.getText=this.forEachItem=this.eventCatcher=this.enableMultiMode=this.dockWindow=this.dockItem=this.detachEvent=this.closeItem=this.clearIcon=this.checkEvent=this.cells=this.callEvent=this.attachEvent=this.addItem=this._updateArrows=this._reopenItem=this._lastVisible=this._initWindows=this.sk=this.idPull=null;if(this._isAccFS==!0){_isIE?window.detachEvent("onresize",this._doOnResize):window.removeEventListener("resize",this._doOnResize,!1),this._resizeTMTime=this._resizeTM=this._adjustToFullScreen=this._adjustAccordion=this._doOnResize=this._isAccFS=null,document.body.className=String(document.body.className).replace("dhxacc_fullscreened",""),this.cont.obj._dhxContDestruct(),this.cont.dhxcont.parentNode&&this.cont.dhxcont.parentNode.removeChild(this.cont.dhxcont),this.cont.dhxcont=null,this.cont=this.cont.setContent=null}if(this.dhxWins){this.dhxWins.unload(),this.dhxWins=null}this.base.className="";this.base=null;for(H in this){try{delete this[H]}catch(I){}}};this._initWindows();dhtmlxEventable(this);return this}else{alert(this.i18n.dhxcontalert)}}dhtmlXAccordion.prototype.i18n={dhxcontalert:"dhtmlxcontainer.js is missed on the page"};(function(){dhtmlx.extend_api("dhtmlXAccordion",{_init:function(A){return[A.parent,A.skin]},icon_path:"setIconsPath",items:"_items",effect:"setEffect",multi_mode:"enableMultiMode"},{_items:function(C){for(var H=[],A=[],F=0;F<C.length;F++){var E=C[F];this.addItem(E.id,E.text);E.img&&this.cells(E.id).setIcon(E.img);E.height&&this.cells(E.id).setHeight(E.height);if(E.open===!0){H[H.length]=E.id}if(E.open===!1){A[A.length]=E.id}}for(var D=0;D<H.length;D++){this.cells(H[D]).open()}for(D=0;D<A.length;D++){this.cells(A[D]).close()}}})})();function dataProcessor(A){this.serverProcessor=A;this.action_param="!nativeeditor_status";this.object=null;this.updatedRows=[];this.autoUpdate=!0;this.updateMode="cell";this._tMode="GET";this.post_delim="_";this._waitMode=0;this._in_progress={};this._invalid={};this.mandatoryFields=[];this.messages=[];this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",clear:"font-weight:normal;text-decoration:none;"};this.enableUTFencoding(!0);dhtmlxEventable(this);return this}dataProcessor.prototype={setTransactionMode:function(A,C){this._tMode=A;this._tSend=C},escape:function(A){return this._utf?encodeURIComponent(A):escape(A)},enableUTFencoding:function(A){this._utf=convertStringToBoolean(A)},setDataColumns:function(A){this._columns=typeof A=="string"?A.split(","):A},getSyncState:function(){return !this.updatedRows.length},enableDataNames:function(A){this._endnm=convertStringToBoolean(A)},enablePartialDataSend:function(A){this._changed=convertStringToBoolean(A)},setUpdateMode:function(A,C){this.autoUpdate=A=="cell";this.updateMode=A;this.dnd=C},ignore:function(A,C){this._silent_mode=!0;A.call(C||window);this._silent_mode=!1},setUpdated:function(C,F,A){if(!this._silent_mode){var E=this.findRow(C),A=A||"updated",D=this.obj.getUserData(C,this.action_param);D&&A=="updated"&&(A=D);F?(this.set_invalid(C,!1),this.updatedRows[E]=C,this.obj.setUserData(C,this.action_param,A),this._in_progress[C]&&(this._in_progress[C]="wait")):this.is_invalid(C)||(this.updatedRows.splice(E,1),this.obj.setUserData(C,this.action_param,""));F||this._clearUpdateFlag(C);this.markRow(C,F,A);F&&this.autoUpdate&&this.sendData(C)}},_clearUpdateFlag:function(){},markRow:function(C,H,A){var F="",E=this.is_invalid(C);E&&(F=this.styles[E],H=!0);if(this.callEvent("onRowMark",[C,H,A,E])&&(F=this.styles[H?A:"clear"]+F,this.obj[this._methods[0]](C,F),E&&E.details)){F+=this.styles[E+"_cell"];for(var D=0;D<E.details.length;D++){if(E.details[D]){this.obj[this._methods[1]](C,D,F)}}}},getState:function(A){return this.obj.getUserData(A,this.action_param)},is_invalid:function(A){return this._invalid[A]},set_invalid:function(C,D,A){A&&(D={value:D,details:A,toString:function(){return this.value.toString()}});this._invalid[C]=D},checkBeforeUpdate:function(){return !0},sendData:function(A){if(!this._waitMode||!(this.obj.mytype=="tree"||this.obj._h2)){this.obj.editStop&&this.obj.editStop();if(typeof A=="undefined"||this._tSend){return this.sendAllData()}if(this._in_progress[A]){return !1}this.messages=[];if(!this.checkBeforeUpdate(A)&&this.callEvent("onValidationError",[A,this.messages])){return !1}this._beforeSendData(this._getRowData(A),A)}},_beforeSendData:function(A,C){if(!this.callEvent("onBeforeUpdate",[C,this.getState(C),A])){return !1}this._sendData(A,C)},serialize:function(C,F){if(typeof C=="string"){return C}if(typeof F!="undefined"){return this.serialize_one(C,"")}else{var A=[],E=[],D;for(D in C){C.hasOwnProperty(D)&&(A.push(this.serialize_one(C[D],D+this.post_delim)),E.push(D))}A.push("ids="+this.escape(E.join(",")));return A.join("&")}},serialize_one:function(C,E){if(typeof C=="string"){return C}var A=[],D;for(D in C){C.hasOwnProperty(D)&&A.push(this.escape((E||"")+D)+"="+this.escape(C[D]))}return A.join("&")},_sendData:function(C,E){if(C){if(!this.callEvent("onBeforeDataSending",E?[E,this.getState(E),C]:[null,null,C])){return !1}E&&(this._in_progress[E]=(new Date).valueOf());var A=new dtmlXMLLoaderObject(this.afterUpdate,this,!0),D=this.serverProcessor+(this._user?getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");this._tMode!="POST"?A.loadXML(D+(D.indexOf("?")!=-1?"&":"?")+this.serialize(C,E)):A.loadXML(D,!0,this.serialize(C,E));this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var A=!0,C=0;C<this.updatedRows.length;C++){A&=this.checkBeforeUpdate(this.updatedRows[C])}if(!A&&!this.callEvent("onValidationError",["",this.messages])){return !1}if(this._tSend){this._sendData(this._getAllData())}else{for(C=0;C<this.updatedRows.length;C++){if(!this._in_progress[this.updatedRows[C]]&&!this.is_invalid(this.updatedRows[C])&&(this._beforeSendData(this._getRowData(this.updatedRows[C]),this.updatedRows[C]),this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2))){break}}}}},_getAllData:function(){for(var C={},E=!1,A=0;A<this.updatedRows.length;A++){var D=this.updatedRows[A];!this._in_progress[D]&&!this.is_invalid(D)&&this.callEvent("onBeforeUpdate",[D,this.getState(D)])&&(C[D]=this._getRowData(D,D+this.post_delim),E=!0,this._in_progress[D]=(new Date).valueOf())}return E?C:null},setVerificator:function(A,C){this.mandatoryFields[A]=C||function(D){return D!=""}},clearVerificator:function(A){this.mandatoryFields[A]=!1},findRow:function(A){for(var C=0,C=0;C<this.updatedRows.length;C++){if(A==this.updatedRows[C]){break}}return C},defineAction:function(A,C){if(!this._uActions){this._uActions=[]}this._uActions[A]=C},afterUpdateCallback:function(C,I,A,H){var F=C,D=A!="error"&&A!="invalid";D||this.set_invalid(C,A);if(this._uActions&&this._uActions[A]&&!this._uActions[A](H)){return delete this._in_progress[F]}this._in_progress[F]!="wait"&&this.setUpdated(C,!1);var E=C;switch(A){case"inserted":case"insert":I!=C&&(this.obj[this._methods[2]](C,I),C=I);break;case"delete":case"deleted":return this.obj.setUserData(C,this.action_param,"true_deleted"),this.obj[this._methods[3]](C),delete this._in_progress[F],this.callEvent("onAfterUpdate",[C,A,I,H])}this._in_progress[F]!="wait"?(D&&this.obj.setUserData(C,this.action_param,""),delete this._in_progress[F]):(delete this._in_progress[F],this.setUpdated(I,!0,this.obj.getUserData(C,this.action_param)));this.callEvent("onAfterUpdate",[C,A,I,H])},afterUpdate:function(M,K,L,J,I){I.getXMLTopNode("data");if(I.xmlDoc.responseXML){for(var E=I.doXPath("//data/action"),F=0;F<E.length;F++){var H=E[F],D=H.getAttribute("type"),C=H.getAttribute("sid"),A=H.getAttribute("tid");M.afterUpdateCallback(C,A,D,H)}M.finalizeUpdate()}},finalizeUpdate:function(){this._waitMode&&this._waitMode--;(this.obj.mytype=="tree"||this.obj._h2)&&this.updatedRows.length&&this.sendData();this.callEvent("onAfterUpdateFinish",[]);this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(A){this.obj=A;this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(A){this.attachEvent("onAfterUpdate",A)},enableDebug:function(){},setOnBeforeUpdateHandler:function(A){this.attachEvent("onBeforeDataSending",A)},setAutoUpdate:function(C,D){C=C||2000;this._user=D||(new Date).valueOf();this._need_update=!1;this._loader=null;this._update_busy=!1;this.attachEvent("onAfterUpdate",function(F,E,I,H){this.afterAutoUpdate(F,E,I,H)});this.attachEvent("onFullSync",function(){this.fullSync()});var A=this;window.setInterval(function(){A.loadUpdate()},C)},afterAutoUpdate:function(A,C){return C=="collision"?(this._need_update=!0,!1):!0},fullSync:function(){if(this._need_update==!0){this._need_update=!1,this.loadUpdate()}return !0},getUpdates:function(A,C){if(this._update_busy){return !1}else{this._update_busy=!0}this._loader=this._loader||new dtmlXMLLoaderObject(!0);this._loader.async=!0;this._loader.waitCall=C;this._loader.loadXML(A)},_v:function(A){return A.firstChild?A.firstChild.nodeValue:""},_a:function(C){for(var D=[],A=0;A<C.length;A++){D[A]=this._v(C[A])}return D},loadUpdate:function(){var C=this,D=this.obj.getUserData(0,"version"),A=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+D].join("&"),A=A.replace("editing=true&","");this.getUpdates(A,function(){var E=C._loader.doXPath("//userdata");C.obj.setUserData(0,"version",C._v(E[0]));var K=C._loader.doXPath("//update");if(K.length){C._silent_mode=!0;for(var H=0;H<K.length;H++){var I=K[H].getAttribute("status"),J=K[H].getAttribute("id"),F=K[H].getAttribute("parent");switch(I){case"inserted":C.callEvent("insertCallback",[K[H],J,F]);break;case"updated":C.callEvent("updateCallback",[K[H],J,F]);break;case"deleted":C.callEvent("deleteCallback",[K[H],J,F])}}C._silent_mode=!1}C._update_busy=!1;C=null})}};dhtmlx.skin="dhx_skyblue";